/*
 * This file is generated by Entity Class Compiler, (c) CroTeam 1997-98
 */

#line 2 "C:/MyMod/Sources/EntitiesMP/Player.es"


#include "StdH.h"
#include "GameMP/SEColors.h"

#include <Engine/Build.h>
#include <Engine/Network/Network.h>
#include <locale.h>

#include "ModelsMP/Player/SeriousSam/Player.h"
#include "ModelsMP/Player/SeriousSam/Body.h"
#include "ModelsMP/Player/SeriousSam/Head.h"

#include "EntitiesMP/PlayerMarker.h"
#include "EntitiesMP/PlayerWeapons.h"
#include "EntitiesMP/PlayerAnimator.h"
#include "EntitiesMP/PlayerView.h"
#include "EntitiesMP/MovingBrush.h"
#include "EntitiesMP/Switch.h"
#include "EntitiesMP/MessageHolder.h"
#include "EntitiesMP/Camera.h"
#include "EntitiesMP/WorldLink.h"
#include "EntitiesMP/HealthItem.h"
#include "EntitiesMP/ArmorItem.h"
#include "EntitiesMP/WeaponItem.h"
#include "EntitiesMP/AmmoItem.h"
#include "EntitiesMP/PowerUpItem.h"
#include "EntitiesMP/MessageItem.h"
#include "EntitiesMP/AmmoPack.h"
#include "EntitiesMP/KeyItem.h"
#include "EntitiesMP/MusicHolder.h"
#include "EntitiesMP/EnemyBase.h"
#include "EntitiesMP/PlayerActionMarker.h"
#include "EntitiesMP/BasicEffects.h"
#include "EntitiesMP/BackgroundViewer.h"
#include "EntitiesMP/WorldSettingsController.h"
#include "EntitiesMP/ScrollHolder.h"
#include "EntitiesMP/TextFXHolder.h"
#include "EntitiesMP/SeriousBomb.h"
#include "EntitiesMP/CreditsHolder.h"
#include "EntitiesMP/HudPicHolder.h"

extern void JumpFromBouncer(CEntity *penToBounce, CEntity *penBouncer);
// from game
#define GRV_SHOWEXTRAS  (1L<<0)   // add extra stuff like console, weapon, pause

#define GENDER_MALE     0
#define GENDER_FEMALE   1
#define GENDEROFFSET    100   // sound components for genders are offset by this value


#include <EntitiesMP/Player.h>
#include <EntitiesMP/Player_tables.h>
CEntityEvent *ECameraStart::MakeCopy(void) { CEntityEvent *peeCopy = new ECameraStart(*this); return peeCopy;}
ECameraStart::ECameraStart() : CEntityEvent(EVENTCODE_ECameraStart) {;
 ClearToDefault(penCamera);
};
CEntityEvent *ECameraStop::MakeCopy(void) { CEntityEvent *peeCopy = new ECameraStop(*this); return peeCopy;}
ECameraStop::ECameraStop() : CEntityEvent(EVENTCODE_ECameraStop) {;
 ClearToDefault(penCamera);
};
CEntityEvent *ERebirth::MakeCopy(void) { CEntityEvent *peeCopy = new ERebirth(*this); return peeCopy;}
ERebirth::ERebirth() : CEntityEvent(EVENTCODE_ERebirth) {;
};
CEntityEvent *EDisconnected::MakeCopy(void) { CEntityEvent *peeCopy = new EDisconnected(*this); return peeCopy;}
EDisconnected::EDisconnected() : CEntityEvent(EVENTCODE_EDisconnected) {;
};
CEntityEvent *EAutoAction::MakeCopy(void) { CEntityEvent *peeCopy = new EAutoAction(*this); return peeCopy;}
EAutoAction::EAutoAction() : CEntityEvent(EVENTCODE_EAutoAction) {;
 ClearToDefault(penFirstMarker);
};
#line 93 "C:/MyMod/Sources/EntitiesMP/Player.es"

extern void DrawHUD( const CPlayer *penPlayerCurrent, CDrawPort *pdpCurrent, BOOL bSnooping, const CPlayer *penPlayerOwner);
extern void InitHUD(void);
extern void EndHUD(void);

static CTimerValue _tvProbingLast;

// used to render certain entities only for certain players (like picked items, etc.)
extern ULONG _ulPlayerRenderingMask = 0;

// temporary BOOL used to discard calculating of 3rd view when calculating absolute view placement
BOOL _bDiscard3rdView=FALSE;

#define NAME name

const FLOAT _fBlowUpAmmount = 70.0f;

// computer message adding flags
#define CMF_READ       (1L<<0)
#define CMF_ANALYZE    (1L<<1)

struct MarkerDistance {
public:
  FLOAT md_fMinD;
  CPlayerMarker *md_ppm;
  void Clear(void);
};

// export current player projection
CAnyProjection3D prPlayerProjection;


int qsort_CompareMarkerDistance(const void *pv0, const void *pv1)
{
  MarkerDistance &md0 = *(MarkerDistance*)pv0;
  MarkerDistance &md1 = *(MarkerDistance*)pv1;
  if(      md0.md_fMinD<md1.md_fMinD) return +1;
  else if( md0.md_fMinD>md1.md_fMinD) return -1;
  else                                return  0;
}

static inline FLOAT IntensityAtDistance( FLOAT fFallOff, FLOAT fHotSpot, FLOAT fDistance)
{
  // intensity is zero if further than fall-off range
  if( fDistance>fFallOff) return 0.0f;
  // intensity is maximum if closer than hot-spot range
  if( fDistance<fHotSpot) return 1.0f;
  // interpolate if between fall-off and hot-spot range
  return (fFallOff-fDistance)/(fFallOff-fHotSpot);
}

static CTString MakeEmptyString(INDEX ctLen, char ch=' ')
{
  char ach[2];
  ach[0] = ch;
  ach[1] = 0;
  CTString strSpaces;
  for (INDEX i=0; i<ctLen; i++) {
    strSpaces+=ach;
  }
  return strSpaces;
}

// take a two line string and align into one line of minimum given length
static _ctAlignWidth = 20;
static CTString AlignString(const CTString &strOrg)
{
  // split into two lines
  CTString strL = strOrg;
  strL.OnlyFirstLine();
  CTString strR = strOrg;
  strR.RemovePrefix(strL);
  strR.DeleteChar(0);
  
  // get their lengths
  INDEX iLenL = strL.LengthNaked();
  INDEX iLenR = strR.LengthNaked();

  // find number of spaces to insert
  INDEX ctSpaces = _ctAlignWidth-(iLenL+iLenR);
  if (ctSpaces<1) {
    ctSpaces=1;
  }

  // make aligned string
  return strL+MakeEmptyString(ctSpaces)+strR;
}

static CTString CenterString(const CTString &str)
{
  INDEX ctSpaces = (_ctAlignWidth-str.LengthNaked())/2;
  if (ctSpaces<0) {
    ctSpaces=0;
  }
  return MakeEmptyString(ctSpaces)+str;
}

static CTString PadStringRight(const CTString &str, INDEX iLen)
{
  INDEX ctSpaces = iLen-str.LengthNaked();
  if (ctSpaces<0) {
    ctSpaces=0;
  }
  return str+MakeEmptyString(ctSpaces);
}

static CTString PadStringLeft(const CTString &str, INDEX iLen)
{
  INDEX ctSpaces = iLen-str.LengthNaked();
  if (ctSpaces<0) {
    ctSpaces=0;
  }
  return MakeEmptyString(ctSpaces)+str;
}

static void KillAllEnemies(CEntity *penKiller)
{
  // for each entity in the world
  {FOREACHINDYNAMICCONTAINER(penKiller->GetWorld()->wo_cenEntities, CEntity, iten) {
    CEntity *pen = iten;
    if (IsDerivedFromClass(pen, "Enemy Base") && !IsOfClass(pen, "Devil")) {
      CEnemyBase *penEnemy = (CEnemyBase *)pen;
      if (penEnemy->m_penEnemy==NULL) {
        continue;
      }
      penKiller->InflictDirectDamage(pen, penKiller, DMT_BULLET, 
        penEnemy->GetHealth()+1, pen->GetPlacement().pl_PositionVector, FLOAT3D(0,1,0));
    }
  }}
}


#define HEADING_MAX      45.0f
#define PITCH_MAX        90.0f
#define BANKING_MAX      45.0f

// player flags
#define PLF_INITIALIZED           (1UL<<0)   // set when player entity is ready to function
#define PLF_VIEWROTATIONCHANGED   (1UL<<1)   // for adjusting view rotation separately from legs
#define PLF_JUMPALLOWED           (1UL<<2)   // if jumping is allowed
#define PLF_SYNCWEAPON            (1UL<<3)   // weapon model needs to be synchronized before rendering
#define PLF_AUTOMOVEMENTS         (1UL<<4)   // complete automatic control of movements
#define PLF_DONTRENDER            (1UL<<5)   // don't render view (used at end of level)
#define PLF_CHANGINGLEVEL         (1UL<<6)   // mark that we next are to appear at start of new level
#define PLF_APPLIEDACTION         (1UL<<7)   // used to detect when player is not connected
#define PLF_NOTCONNECTED          (1UL<<8)   // set if the player is not connected
#define PLF_LEVELSTARTED          (1UL<<9)   // marks that level start time was recorded
#define PLF_ISZOOMING             (1UL<<10)  // marks that player is zoomed in with the sniper
#define PLF_RESPAWNINPLACE        (1UL<<11)  // don't move to marker when respawning (for current death only)

// defines representing flags used to fill player buttoned actions
#define PLACT_FIRE                (1L<<0)
#define PLACT_RELOAD              (1L<<1)
#define PLACT_WEAPON_NEXT         (1L<<2)
#define PLACT_WEAPON_PREV         (1L<<3)
#define PLACT_WEAPON_FLIP         (1L<<4)
#define PLACT_USE                 (1L<<5)
#define PLACT_COMPUTER            (1L<<6)
#define PLACT_3RD_PERSON_VIEW     (1L<<7)
#define PLACT_CENTER_VIEW         (1L<<8)
#define PLACT_USE_HELD            (1L<<9)
#define PLACT_SNIPER_ZOOMIN       (1L<<10)
#define PLACT_SNIPER_ZOOMOUT      (1L<<11)
#define PLACT_SNIPER_USE          (1L<<12)
#define PLACT_FIREBOMB            (1L<<13)
#define PLACT_SELECT_WEAPON_SHIFT (14)
#define PLACT_SELECT_WEAPON_MASK  (0x1FL<<PLACT_SELECT_WEAPON_SHIFT)
                                     
#define MAX_WEAPONS 30

#define PICKEDREPORT_TIME   (2.0f)  // how long (picked-up) message stays on screen

// is player spying another player
//extern TIME _tmSnoopingStarted;
//extern CEntity *_penTargeting;


struct PlayerControls {
  FLOAT3D aRotation;
  FLOAT3D aViewRotation;
  FLOAT3D vTranslation;

  BOOL bMoveForward;
  BOOL bMoveBackward;
  BOOL bMoveLeft;
  BOOL bMoveRight;
  BOOL bMoveUp;
  BOOL bMoveDown;

  BOOL bTurnLeft;
  BOOL bTurnRight;
  BOOL bTurnUp;
  BOOL bTurnDown;
  BOOL bTurnBankingLeft;
  BOOL bTurnBankingRight;
  BOOL bCenterView;

  BOOL bLookLeft;
  BOOL bLookRight;
  BOOL bLookUp;
  BOOL bLookDown;
  BOOL bLookBankingLeft;
  BOOL bLookBankingRight;

  BOOL bSelectWeapon[MAX_WEAPONS+1];
  BOOL bWeaponNext;
  BOOL bWeaponPrev;
  BOOL bWeaponFlip;
  
  BOOL bWalk;
  BOOL bStrafe;
  BOOL bFire;
  BOOL bReload;
  BOOL bUse;
  BOOL bComputer;
  BOOL bUseOrComputer;
  BOOL bUseOrComputerLast;  // for internal use
  BOOL b3rdPersonView;

  BOOL bSniperZoomIn;
  BOOL bSniperZoomOut;
  BOOL bFireBomb;
};

static struct PlayerControls pctlCurrent;

// cheats
static INDEX cht_iGoToMarker = -1;
static INDEX cht_bKillAll    = FALSE;
static INDEX cht_bGiveAll    = FALSE;
static INDEX cht_bOpen       = FALSE;
static INDEX cht_bAllMessages= FALSE;
static INDEX cht_bRefresh    = FALSE;
extern INDEX cht_bGod        = FALSE;
extern INDEX cht_bFly        = FALSE;
extern INDEX cht_bGhost      = FALSE;
extern INDEX cht_bInvisible  = FALSE;
extern FLOAT cht_fTranslationMultiplier = 1.0f;
extern INDEX cht_bEnable     = 0;   

// interface control
static INDEX hud_bShowAll	    = TRUE; // used internaly in menu/console
extern INDEX hud_bShowWeapon  = TRUE;
extern INDEX hud_bShowMessages = TRUE;
extern INDEX hud_bShowInfo    = TRUE;
extern INDEX hud_bShowLatency = FALSE;
extern INDEX hud_iShowPlayers = -1;   // auto
extern INDEX hud_iSortPlayers = -1;   // auto
extern FLOAT hud_fOpacity     = 0.9f;
extern FLOAT hud_fScaling     = 1.0f;
extern FLOAT hud_tmWeaponsOnScreen = 3.0f;
extern FLOAT hud_tmLatencySnapshot = 1.0f;
extern INDEX hud_bShowMatchInfo = TRUE;

extern FLOAT plr_fBreathingStrength = 0.0f;
extern FLOAT plr_tmSnoopingTime;
extern INDEX cht_bKillFinalBoss = FALSE;
INDEX cht_bDebugFinalBoss = FALSE;
INDEX cht_bDumpFinalBossData = FALSE;
INDEX cht_bDebugFinalBossAnimations = FALSE;
INDEX cht_bDumpPlayerShading = FALSE;

extern FLOAT wpn_fRecoilSpeed[17]   = {0};
extern FLOAT wpn_fRecoilLimit[17]   = {0};
extern FLOAT wpn_fRecoilDampUp[17]  = {0};
extern FLOAT wpn_fRecoilDampDn[17]  = {0};
extern FLOAT wpn_fRecoilOffset[17]  = {0};
extern FLOAT wpn_fRecoilFactorP[17] = {0};
extern FLOAT wpn_fRecoilFactorZ[17] = {0};

// misc
static FLOAT plr_fAcceleration  = 100.0f;
static FLOAT plr_fDeceleration  = 60.0f;
static FLOAT plr_fSpeedForward  = 10.0f;
static FLOAT plr_fSpeedBackward = 10.0f;
static FLOAT plr_fSpeedSide     = 10.0f;
static FLOAT plr_fSpeedUp       = 11.0f;
static FLOAT plr_fViewHeightStand  = 1.9f;
static FLOAT plr_fViewHeightCrouch = 0.7f;
static FLOAT plr_fViewHeightSwim   = 0.4f;
static FLOAT plr_fViewHeightDive   = 0.0f;
extern FLOAT plr_fViewDampFactor        = 0.4f;
extern FLOAT plr_fViewDampLimitGroundUp = 0.1f;
extern FLOAT plr_fViewDampLimitGroundDn = 0.4f;
extern FLOAT plr_fViewDampLimitWater    = 0.1f;
static FLOAT plr_fFrontClipDistance = 0.25f;
static FLOAT plr_fFOV = 90.0f;
static FLOAT net_tmLatencyAvg;
extern INDEX plr_bRenderPicked = FALSE;
extern INDEX plr_bRenderPickedParticles = FALSE;
extern INDEX plr_bOnlySam = FALSE;
extern INDEX ent_bReportBrokenChains = FALSE;
extern FLOAT ent_tmMentalIn   = 0.5f;
extern FLOAT ent_tmMentalOut  = 0.75f;
extern FLOAT ent_tmMentalFade = 0.5f;

extern FLOAT gfx_fEnvParticlesDensity = 1.0f;
extern FLOAT gfx_fEnvParticlesRange = 1.0f;

// prediction control vars
extern FLOAT cli_fPredictPlayersRange = 0.0f;
extern FLOAT cli_fPredictItemsRange = 3.0f;
extern FLOAT cli_tmPredictFoe = 10.0f;
extern FLOAT cli_tmPredictAlly = 10.0f;
extern FLOAT cli_tmPredictEnemy  = 10.0f;

static FLOAT plr_fSwimSoundDelay = 0.8f;
static FLOAT plr_fDiveSoundDelay = 1.6f;
static FLOAT plr_fWalkSoundDelay = 0.5f;
static FLOAT plr_fRunSoundDelay  = 0.3f;

static FLOAT ctl_tmComputerDoubleClick = 0.5f; // double click delay for calling computer
static FLOAT _tmLastUseOrCompPressed = -10.0f;  // for computer doubleclick

// speeds for button rotation
static FLOAT ctl_fButtonRotationSpeedH = 300.0f;
static FLOAT ctl_fButtonRotationSpeedP = 150.0f;
static FLOAT ctl_fButtonRotationSpeedB = 150.0f;
// modifier for axis strafing
static FLOAT ctl_fAxisStrafingModifier = 1.0f;

// !=NULL if some player wants to call computer
DECL_DLL extern class CPlayer *cmp_ppenPlayer = NULL;
// !=NULL for rendering computer on secondary display in dualhead
DECL_DLL extern class CPlayer *cmp_ppenDHPlayer = NULL;
// set to update current message in background mode (for dualhead)
DECL_DLL extern BOOL cmp_bUpdateInBackground = FALSE;
// set for initial calling computer without rendering game
DECL_DLL extern BOOL cmp_bInitialStart = FALSE;

// game sets this for player hud and statistics and hiscore sound playing
DECL_DLL extern INDEX plr_iHiScore = 0.0f;

// these define address and size of player controls structure
DECL_DLL extern void *ctl_pvPlayerControls = &pctlCurrent;
DECL_DLL extern const SLONG ctl_slPlayerControlsSize = sizeof(pctlCurrent);

// called to compose action packet from current controls
DECL_DLL void ctl_ComposeActionPacket(const CPlayerCharacter &pc, CPlayerAction &paAction, BOOL bPreScan)
{
  // allow double axis controls
  paAction.pa_aRotation += paAction.pa_aViewRotation;

  CPlayerSettings *pps = (CPlayerSettings *)pc.pc_aubAppearance;
//  CPrintF("compose: prescan %d, x:%g\n", bPreScan, paAction.pa_aRotation(1));
  // if strafing
  if (pctlCurrent.bStrafe) {
    // move rotation left/right into translation left/right
    paAction.pa_vTranslation(1) = -paAction.pa_aRotation(1)*ctl_fAxisStrafingModifier;
    paAction.pa_aRotation(1) = 0;
  }
  // if centering view
  if (pctlCurrent.bCenterView) {
    // don't allow moving view up/down
    paAction.pa_aRotation(2) = 0;
  }

  // multiply axis actions with speed
  paAction.pa_vTranslation(1) *= plr_fSpeedSide;
  paAction.pa_vTranslation(2) *= plr_fSpeedUp;
  if (paAction.pa_vTranslation(3)<0) {
    paAction.pa_vTranslation(3) *= plr_fSpeedForward;
  } else {
    paAction.pa_vTranslation(3) *= plr_fSpeedBackward;
  }

  // find local player, if any
  CPlayer *penThis = NULL;
  INDEX ctPlayers = CEntity::GetMaxPlayers();
  for (INDEX iPlayer = 0; iPlayer<ctPlayers; iPlayer++) {
    CPlayer *pen=(CPlayer *)CEntity::GetPlayerEntity(iPlayer);
    if (pen!=NULL && pen->en_pcCharacter==pc) {
      penThis = pen;
      break;
    }
  }
  // if not found
  if (penThis==NULL) {
    // do nothing
    return;
  }
  // accumulate local rotation
  penThis->m_aLocalRotation    +=paAction.pa_aRotation;
  penThis->m_aLocalViewRotation+=paAction.pa_aViewRotation;
  penThis->m_vLocalTranslation +=paAction.pa_vTranslation;

  // if prescanning
  if (bPreScan) {
    // no button checking
    return;
  }

  // add button movement/rotation/look actions to the axis actions
  if(pctlCurrent.bMoveForward  ) paAction.pa_vTranslation(3) -= plr_fSpeedForward;
  if(pctlCurrent.bMoveBackward ) paAction.pa_vTranslation(3) += plr_fSpeedBackward;
  if(pctlCurrent.bMoveLeft  || pctlCurrent.bStrafe&&pctlCurrent.bTurnLeft) paAction.pa_vTranslation(1) -= plr_fSpeedSide;
  if(pctlCurrent.bMoveRight || pctlCurrent.bStrafe&&pctlCurrent.bTurnRight) paAction.pa_vTranslation(1) += plr_fSpeedSide;
  if(pctlCurrent.bMoveUp       ) paAction.pa_vTranslation(2) += plr_fSpeedUp;
  if(pctlCurrent.bMoveDown     ) paAction.pa_vTranslation(2) -= plr_fSpeedUp;

  const FLOAT fQuantum = _pTimer->TickQuantum;
  if(pctlCurrent.bTurnLeft  && !pctlCurrent.bStrafe) penThis->m_aLocalRotation(1) += ctl_fButtonRotationSpeedH*fQuantum;
  if(pctlCurrent.bTurnRight && !pctlCurrent.bStrafe) penThis->m_aLocalRotation(1) -= ctl_fButtonRotationSpeedH*fQuantum;
  if(pctlCurrent.bTurnUp           ) penThis->m_aLocalRotation(2) += ctl_fButtonRotationSpeedP*fQuantum;
  if(pctlCurrent.bTurnDown         ) penThis->m_aLocalRotation(2) -= ctl_fButtonRotationSpeedP*fQuantum;
  if(pctlCurrent.bTurnBankingLeft  ) penThis->m_aLocalRotation(3) += ctl_fButtonRotationSpeedB*fQuantum;
  if(pctlCurrent.bTurnBankingRight ) penThis->m_aLocalRotation(3) -= ctl_fButtonRotationSpeedB*fQuantum;

  if(pctlCurrent.bLookLeft         ) penThis->m_aLocalViewRotation(1) += ctl_fButtonRotationSpeedH*fQuantum;
  if(pctlCurrent.bLookRight        ) penThis->m_aLocalViewRotation(1) -= ctl_fButtonRotationSpeedH*fQuantum;
  if(pctlCurrent.bLookUp           ) penThis->m_aLocalViewRotation(2) += ctl_fButtonRotationSpeedP*fQuantum;
  if(pctlCurrent.bLookDown         ) penThis->m_aLocalViewRotation(2) -= ctl_fButtonRotationSpeedP*fQuantum;
  if(pctlCurrent.bLookBankingLeft  ) penThis->m_aLocalViewRotation(3) += ctl_fButtonRotationSpeedB*fQuantum;
  if(pctlCurrent.bLookBankingRight ) penThis->m_aLocalViewRotation(3) -= ctl_fButtonRotationSpeedB*fQuantum;

  // use current accumulated rotation
  paAction.pa_aRotation     = penThis->m_aLocalRotation;
  paAction.pa_aViewRotation = penThis->m_aLocalViewRotation;
  //paAction.pa_vTranslation  = penThis->m_vLocalTranslation;

  // if walking
  if(pctlCurrent.bWalk) {
    // make forward/backward and sidestep speeds slower
    paAction.pa_vTranslation(3) /= 2.0f;
    paAction.pa_vTranslation(1) /= 2.0f;
  }
  
  // reset all button actions
  paAction.pa_ulButtons = 0;

  // set weapon selection bits
  for(INDEX i=1; i<MAX_WEAPONS; i++) {
    if(pctlCurrent.bSelectWeapon[i]) {
      paAction.pa_ulButtons = i<<PLACT_SELECT_WEAPON_SHIFT;
      break;
    }
  }
  // set button pressed flags
  if(pctlCurrent.bWeaponNext) paAction.pa_ulButtons |= PLACT_WEAPON_NEXT;
  if(pctlCurrent.bWeaponPrev) paAction.pa_ulButtons |= PLACT_WEAPON_PREV;
  if(pctlCurrent.bWeaponFlip) paAction.pa_ulButtons |= PLACT_WEAPON_FLIP;
  if(pctlCurrent.bFire)       paAction.pa_ulButtons |= PLACT_FIRE;
  if(pctlCurrent.bReload)     paAction.pa_ulButtons |= PLACT_RELOAD;
  if(pctlCurrent.bUse)        paAction.pa_ulButtons |= PLACT_USE|PLACT_USE_HELD|PLACT_SNIPER_USE;
  if(pctlCurrent.bComputer)      paAction.pa_ulButtons |= PLACT_COMPUTER;
  if(pctlCurrent.b3rdPersonView) paAction.pa_ulButtons |= PLACT_3RD_PERSON_VIEW;
  if(pctlCurrent.bCenterView)    paAction.pa_ulButtons |= PLACT_CENTER_VIEW;
  // is 'use' being held?
  if(pctlCurrent.bUseOrComputer) paAction.pa_ulButtons |= PLACT_USE_HELD|PLACT_SNIPER_USE;
  if(pctlCurrent.bSniperZoomIn)  paAction.pa_ulButtons |= PLACT_SNIPER_ZOOMIN;
  if(pctlCurrent.bSniperZoomOut) paAction.pa_ulButtons |= PLACT_SNIPER_ZOOMOUT;
  if(pctlCurrent.bFireBomb)      paAction.pa_ulButtons |= PLACT_FIREBOMB;

  // if userorcomp just pressed
  if(pctlCurrent.bUseOrComputer && !pctlCurrent.bUseOrComputerLast) {
    // if double-click is off
    if (ctl_tmComputerDoubleClick==0 || (pps->ps_ulFlags&PSF_COMPSINGLECLICK)) {
      // press both
      paAction.pa_ulButtons |= PLACT_USE|PLACT_COMPUTER;
    // if double-click is on
    } else {
      // if double click
      if (_pTimer->GetRealTimeTick()<=_tmLastUseOrCompPressed+ctl_tmComputerDoubleClick) {
        // computer pressed
        paAction.pa_ulButtons |= PLACT_COMPUTER;
      // if single click
      } else {
        // use pressed
        paAction.pa_ulButtons |= PLACT_USE;
      }
    }
    _tmLastUseOrCompPressed = _pTimer->GetRealTimeTick();
  }
  // remember old userorcomp pressed state
  pctlCurrent.bUseOrComputerLast = pctlCurrent.bUseOrComputer;
};

void CPlayer_Precache(void)
{
  CDLLEntityClass *pdec = &CPlayer_DLLClass;

  // precache view
  extern void CPlayerView_Precache(void);
  CPlayerView_Precache();

  // precache all player sounds
  pdec->PrecacheSound(SOUND_WATER_ENTER        );
  pdec->PrecacheSound(SOUND_WATER_LEAVE        );
  pdec->PrecacheSound(SOUND_WALK_L             );
  pdec->PrecacheSound(SOUND_WALK_R             );
  pdec->PrecacheSound(SOUND_WALK_SAND_L        );
  pdec->PrecacheSound(SOUND_WALK_SAND_R        );
  pdec->PrecacheSound(SOUND_SWIM_L             );
  pdec->PrecacheSound(SOUND_SWIM_R             );
  pdec->PrecacheSound(SOUND_DIVE_L             );
  pdec->PrecacheSound(SOUND_DIVE_R             );
  pdec->PrecacheSound(SOUND_DIVEIN             );
  pdec->PrecacheSound(SOUND_DIVEOUT            );
  pdec->PrecacheSound(SOUND_DROWN              );
  pdec->PrecacheSound(SOUND_INHALE0            );
  pdec->PrecacheSound(SOUND_JUMP               );
  pdec->PrecacheSound(SOUND_LAND               );
  pdec->PrecacheSound(SOUND_WOUNDWEAK          );
  pdec->PrecacheSound(SOUND_WOUNDMEDIUM        );
  pdec->PrecacheSound(SOUND_WOUNDSTRONG        );
  pdec->PrecacheSound(SOUND_WOUNDWATER         );
  pdec->PrecacheSound(SOUND_DEATH              );
  pdec->PrecacheSound(SOUND_DEATHWATER         );
  pdec->PrecacheSound(SOUND_WATERAMBIENT       );
  pdec->PrecacheSound(SOUND_WATERBUBBLES       );
  pdec->PrecacheSound(SOUND_WATERWALK_L        );
  pdec->PrecacheSound(SOUND_WATERWALK_R        );
  pdec->PrecacheSound(SOUND_INHALE1            );
  pdec->PrecacheSound(SOUND_INHALE2            );
  pdec->PrecacheSound(SOUND_INFO               );
  pdec->PrecacheSound(SOUND_WALK_GRASS_L       );
  pdec->PrecacheSound(SOUND_WALK_GRASS_R       );
  pdec->PrecacheSound(SOUND_WALK_WOOD_L        );
  pdec->PrecacheSound(SOUND_WALK_WOOD_R        );
  pdec->PrecacheSound(SOUND_WALK_SNOW_L        );
  pdec->PrecacheSound(SOUND_WALK_SNOW_R        );
//pdec->PrecacheSound(SOUND_HIGHSCORE          );
  pdec->PrecacheSound(SOUND_SNIPER_ZOOM        );
  pdec->PrecacheSound(SOUND_SNIPER_QZOOM       );
  pdec->PrecacheSound(SOUND_SILENCE            );
  pdec->PrecacheSound(SOUND_POWERUP_BEEP       );

  pdec->PrecacheSound(SOUND_F_WATER_ENTER        );
  pdec->PrecacheSound(SOUND_F_WATER_LEAVE        );
  pdec->PrecacheSound(SOUND_F_WALK_L             );
  pdec->PrecacheSound(SOUND_F_WALK_R             );
  pdec->PrecacheSound(SOUND_F_WALK_SAND_L        );
  pdec->PrecacheSound(SOUND_F_WALK_SAND_R        );
  pdec->PrecacheSound(SOUND_F_SWIM_L             );
  pdec->PrecacheSound(SOUND_F_SWIM_R             );
  pdec->PrecacheSound(SOUND_F_DIVE_L             );
  pdec->PrecacheSound(SOUND_F_DIVE_R             );
  pdec->PrecacheSound(SOUND_F_DIVEIN             );
  pdec->PrecacheSound(SOUND_F_DIVEOUT            );
  pdec->PrecacheSound(SOUND_F_DROWN              );
  pdec->PrecacheSound(SOUND_F_INHALE0            );
  pdec->PrecacheSound(SOUND_F_JUMP               );
  pdec->PrecacheSound(SOUND_F_LAND               );
  pdec->PrecacheSound(SOUND_F_WOUNDWEAK          );
  pdec->PrecacheSound(SOUND_F_WOUNDMEDIUM        );
  pdec->PrecacheSound(SOUND_F_WOUNDSTRONG        );
  pdec->PrecacheSound(SOUND_F_WOUNDWATER         );
  pdec->PrecacheSound(SOUND_F_DEATH              );
  pdec->PrecacheSound(SOUND_F_DEATHWATER         );
  pdec->PrecacheSound(SOUND_F_WATERWALK_L        );
  pdec->PrecacheSound(SOUND_F_WATERWALK_R        );
  pdec->PrecacheSound(SOUND_F_INHALE1            );
  pdec->PrecacheSound(SOUND_F_INHALE2            );
  pdec->PrecacheSound(SOUND_F_WALK_GRASS_L       );
  pdec->PrecacheSound(SOUND_F_WALK_GRASS_R       );
  pdec->PrecacheSound(SOUND_F_WALK_WOOD_L        );
  pdec->PrecacheSound(SOUND_F_WALK_WOOD_R        );
  pdec->PrecacheSound(SOUND_F_WALK_SNOW_L        );
  pdec->PrecacheSound(SOUND_F_WALK_SNOW_R        );
//pdec->PrecacheSound(SOUND_F_HIGHSCORE          );
  pdec->PrecacheSound(SOUND_BLOWUP               );

  pdec->PrecacheClass(CLASS_BASIC_EFFECT, BET_TELEPORT);
  pdec->PrecacheClass(CLASS_SERIOUSBOMB);

  pdec->PrecacheModel(MODEL_FLESH);
  pdec->PrecacheModel(MODEL_FLESH_APPLE);
  pdec->PrecacheModel(MODEL_FLESH_BANANA);
  pdec->PrecacheModel(MODEL_FLESH_BURGER);
  pdec->PrecacheTexture(TEXTURE_FLESH_RED);
  pdec->PrecacheTexture(TEXTURE_FLESH_GREEN);
  pdec->PrecacheTexture(TEXTURE_FLESH_APPLE); 
  pdec->PrecacheTexture(TEXTURE_FLESH_BANANA);
  pdec->PrecacheTexture(TEXTURE_FLESH_BURGER);
  pdec->PrecacheTexture(TEXTURE_FLESH_LOLLY); 
  pdec->PrecacheTexture(TEXTURE_FLESH_ORANGE); 

  pdec->PrecacheClass(CLASS_BASIC_EFFECT, BET_BLOODSPILL);
  pdec->PrecacheClass(CLASS_BASIC_EFFECT, BET_BLOODSTAIN);
  pdec->PrecacheClass(CLASS_BASIC_EFFECT, BET_BLOODSTAINGROW);
  pdec->PrecacheClass(CLASS_BASIC_EFFECT, BET_BLOODEXPLODE);
}

void CPlayer_OnInitClass(void)
{
  // clear current player controls
  memset(&pctlCurrent, 0, sizeof(pctlCurrent));
  // declare player control variables
  _pShell->DeclareSymbol("user INDEX ctl_bMoveForward;",  &pctlCurrent.bMoveForward);
  _pShell->DeclareSymbol("user INDEX ctl_bMoveBackward;", &pctlCurrent.bMoveBackward);
  _pShell->DeclareSymbol("user INDEX ctl_bMoveLeft;",     &pctlCurrent.bMoveLeft);
  _pShell->DeclareSymbol("user INDEX ctl_bMoveRight;",    &pctlCurrent.bMoveRight);
  _pShell->DeclareSymbol("user INDEX ctl_bMoveUp;",       &pctlCurrent.bMoveUp);
  _pShell->DeclareSymbol("user INDEX ctl_bMoveDown;",     &pctlCurrent.bMoveDown);
  _pShell->DeclareSymbol("user INDEX ctl_bTurnLeft;",         &pctlCurrent.bTurnLeft);
  _pShell->DeclareSymbol("user INDEX ctl_bTurnRight;",        &pctlCurrent.bTurnRight);
  _pShell->DeclareSymbol("user INDEX ctl_bTurnUp;",           &pctlCurrent.bTurnUp);
  _pShell->DeclareSymbol("user INDEX ctl_bTurnDown;",         &pctlCurrent.bTurnDown);
  _pShell->DeclareSymbol("user INDEX ctl_bTurnBankingLeft;",  &pctlCurrent.bTurnBankingLeft);
  _pShell->DeclareSymbol("user INDEX ctl_bTurnBankingRight;", &pctlCurrent.bTurnBankingRight);
  _pShell->DeclareSymbol("user INDEX ctl_bCenterView;",       &pctlCurrent.bCenterView);
  _pShell->DeclareSymbol("user INDEX ctl_bLookLeft;",         &pctlCurrent.bLookLeft);
  _pShell->DeclareSymbol("user INDEX ctl_bLookRight;",        &pctlCurrent.bLookRight);
  _pShell->DeclareSymbol("user INDEX ctl_bLookUp;",           &pctlCurrent.bLookUp);
  _pShell->DeclareSymbol("user INDEX ctl_bLookDown;",         &pctlCurrent.bLookDown);
  _pShell->DeclareSymbol("user INDEX ctl_bLookBankingLeft;",  &pctlCurrent.bLookBankingLeft);
  _pShell->DeclareSymbol("user INDEX ctl_bLookBankingRight;", &pctlCurrent.bLookBankingRight );
  _pShell->DeclareSymbol("user INDEX ctl_bWalk;",           &pctlCurrent.bWalk);
  _pShell->DeclareSymbol("user INDEX ctl_bStrafe;",         &pctlCurrent.bStrafe);
  _pShell->DeclareSymbol("user INDEX ctl_bFire;",           &pctlCurrent.bFire);
  _pShell->DeclareSymbol("user INDEX ctl_bReload;",         &pctlCurrent.bReload);
  _pShell->DeclareSymbol("user INDEX ctl_bUse;",            &pctlCurrent.bUse);
  _pShell->DeclareSymbol("user INDEX ctl_bComputer;",       &pctlCurrent.bComputer);
  _pShell->DeclareSymbol("user INDEX ctl_bUseOrComputer;",  &pctlCurrent.bUseOrComputer);
  _pShell->DeclareSymbol("user INDEX ctl_b3rdPersonView;",  &pctlCurrent.b3rdPersonView);
  _pShell->DeclareSymbol("user INDEX ctl_bWeaponNext;",         &pctlCurrent.bWeaponNext);
  _pShell->DeclareSymbol("user INDEX ctl_bWeaponPrev;",         &pctlCurrent.bWeaponPrev);
  _pShell->DeclareSymbol("user INDEX ctl_bWeaponFlip;",         &pctlCurrent.bWeaponFlip);
  _pShell->DeclareSymbol("user INDEX ctl_bSelectWeapon[30+1];", &pctlCurrent.bSelectWeapon);
  _pShell->DeclareSymbol("persistent user FLOAT ctl_tmComputerDoubleClick;", &ctl_tmComputerDoubleClick);
  _pShell->DeclareSymbol("persistent user FLOAT ctl_fButtonRotationSpeedH;", &ctl_fButtonRotationSpeedH);
  _pShell->DeclareSymbol("persistent user FLOAT ctl_fButtonRotationSpeedP;", &ctl_fButtonRotationSpeedP);
  _pShell->DeclareSymbol("persistent user FLOAT ctl_fButtonRotationSpeedB;", &ctl_fButtonRotationSpeedB);
  _pShell->DeclareSymbol("persistent user FLOAT ctl_fAxisStrafingModifier;", &ctl_fAxisStrafingModifier);
  //new
  _pShell->DeclareSymbol("user INDEX ctl_bSniperZoomIn;",         &pctlCurrent.bSniperZoomIn);
  _pShell->DeclareSymbol("user INDEX ctl_bSniperZoomOut;",        &pctlCurrent.bSniperZoomOut);
  _pShell->DeclareSymbol("user INDEX ctl_bFireBomb;",             &pctlCurrent.bFireBomb);

  _pShell->DeclareSymbol("user FLOAT plr_fSwimSoundDelay;", &plr_fSwimSoundDelay);
  _pShell->DeclareSymbol("user FLOAT plr_fDiveSoundDelay;", &plr_fDiveSoundDelay);
  _pShell->DeclareSymbol("user FLOAT plr_fWalkSoundDelay;", &plr_fWalkSoundDelay);
  _pShell->DeclareSymbol("user FLOAT plr_fRunSoundDelay;",  &plr_fRunSoundDelay);

  _pShell->DeclareSymbol("persistent user FLOAT cli_fPredictPlayersRange;",&cli_fPredictPlayersRange);
  _pShell->DeclareSymbol("persistent user FLOAT cli_fPredictItemsRange;",  &cli_fPredictItemsRange  );
  _pShell->DeclareSymbol("persistent user FLOAT cli_tmPredictFoe;",        &cli_tmPredictFoe        );
  _pShell->DeclareSymbol("persistent user FLOAT cli_tmPredictAlly;",       &cli_tmPredictAlly       );
  _pShell->DeclareSymbol("persistent user FLOAT cli_tmPredictEnemy;",      &cli_tmPredictEnemy      );

  _pShell->DeclareSymbol("     INDEX hud_bShowAll;",     &hud_bShowAll);
  _pShell->DeclareSymbol("user INDEX hud_bShowInfo;",    &hud_bShowInfo);
  _pShell->DeclareSymbol("user const FLOAT net_tmLatencyAvg;", &net_tmLatencyAvg);
  _pShell->DeclareSymbol("persistent user INDEX hud_bShowLatency;", &hud_bShowLatency);
  _pShell->DeclareSymbol("persistent user INDEX hud_iShowPlayers;", &hud_iShowPlayers);
  _pShell->DeclareSymbol("persistent user INDEX hud_iSortPlayers;", &hud_iSortPlayers);
  _pShell->DeclareSymbol("persistent user INDEX hud_bShowWeapon;",  &hud_bShowWeapon);
  _pShell->DeclareSymbol("persistent user INDEX hud_bShowMessages;",&hud_bShowMessages);
  _pShell->DeclareSymbol("persistent user FLOAT hud_fScaling;",     &hud_fScaling);
  _pShell->DeclareSymbol("persistent user FLOAT hud_fOpacity;",     &hud_fOpacity);
  _pShell->DeclareSymbol("persistent user FLOAT hud_tmWeaponsOnScreen;",  &hud_tmWeaponsOnScreen);
  _pShell->DeclareSymbol("persistent user FLOAT hud_tmLatencySnapshot;",  &hud_tmLatencySnapshot);
  _pShell->DeclareSymbol("persistent user FLOAT plr_fBreathingStrength;", &plr_fBreathingStrength);
  _pShell->DeclareSymbol("INDEX cht_bKillFinalBoss;",  &cht_bKillFinalBoss);
  _pShell->DeclareSymbol("INDEX cht_bDebugFinalBoss;", &cht_bDebugFinalBoss);
  _pShell->DeclareSymbol("INDEX cht_bDumpFinalBossData;", &cht_bDumpFinalBossData);
  _pShell->DeclareSymbol("INDEX cht_bDebugFinalBossAnimations;", &cht_bDebugFinalBossAnimations);
  _pShell->DeclareSymbol("INDEX cht_bDumpPlayerShading;", &cht_bDumpPlayerShading);
  _pShell->DeclareSymbol("persistent user INDEX hud_bShowMatchInfo;", &hud_bShowMatchInfo);

  _pShell->DeclareSymbol("persistent user FLOAT wpn_fRecoilSpeed[17];",   &wpn_fRecoilSpeed);
  _pShell->DeclareSymbol("persistent user FLOAT wpn_fRecoilLimit[17];",   &wpn_fRecoilLimit);
  _pShell->DeclareSymbol("persistent user FLOAT wpn_fRecoilDampUp[17];",  &wpn_fRecoilDampUp);
  _pShell->DeclareSymbol("persistent user FLOAT wpn_fRecoilDampDn[17];",  &wpn_fRecoilDampDn);
  _pShell->DeclareSymbol("persistent user FLOAT wpn_fRecoilOffset[17];",  &wpn_fRecoilOffset);
  _pShell->DeclareSymbol("persistent user FLOAT wpn_fRecoilFactorP[17];", &wpn_fRecoilFactorP);
  _pShell->DeclareSymbol("persistent user FLOAT wpn_fRecoilFactorZ[17];", &wpn_fRecoilFactorZ);

  // cheats
  _pShell->DeclareSymbol("user INDEX cht_bGod;",       &cht_bGod);
  _pShell->DeclareSymbol("user INDEX cht_bFly;",       &cht_bFly);
  _pShell->DeclareSymbol("user INDEX cht_bGhost;",     &cht_bGhost);
  _pShell->DeclareSymbol("user INDEX cht_bInvisible;", &cht_bInvisible);
  _pShell->DeclareSymbol("user INDEX cht_bGiveAll;",   &cht_bGiveAll);
  _pShell->DeclareSymbol("user INDEX cht_bKillAll;",   &cht_bKillAll);
  _pShell->DeclareSymbol("user INDEX cht_bOpen;",      &cht_bOpen);
  _pShell->DeclareSymbol("user INDEX cht_bAllMessages;", &cht_bAllMessages);
  _pShell->DeclareSymbol("user FLOAT cht_fTranslationMultiplier ;", &cht_fTranslationMultiplier);
  _pShell->DeclareSymbol("user INDEX cht_bRefresh;", &cht_bRefresh);
  // this one is masqueraded cheat enable variable
  _pShell->DeclareSymbol("INDEX cht_bEnable;", &cht_bEnable);

  // this cheat is always enabled
  _pShell->DeclareSymbol("user INDEX cht_iGoToMarker;", &cht_iGoToMarker);

  // player speed and view parameters, not declared except in internal build
  #if 0
    _pShell->DeclareSymbol("user FLOAT plr_fViewHeightStand;", &plr_fViewHeightStand);
    _pShell->DeclareSymbol("user FLOAT plr_fViewHeightCrouch;",&plr_fViewHeightCrouch);
    _pShell->DeclareSymbol("user FLOAT plr_fViewHeightSwim;",  &plr_fViewHeightSwim);
    _pShell->DeclareSymbol("user FLOAT plr_fViewHeightDive;",  &plr_fViewHeightDive);
    _pShell->DeclareSymbol("user FLOAT plr_fViewDampFactor;",         &plr_fViewDampFactor);
    _pShell->DeclareSymbol("user FLOAT plr_fViewDampLimitGroundUp;",  &plr_fViewDampLimitGroundUp);
    _pShell->DeclareSymbol("user FLOAT plr_fViewDampLimitGroundDn;",  &plr_fViewDampLimitGroundDn);
    _pShell->DeclareSymbol("user FLOAT plr_fViewDampLimitWater;",     &plr_fViewDampLimitWater);
    _pShell->DeclareSymbol("user FLOAT plr_fAcceleration;",  &plr_fAcceleration);
    _pShell->DeclareSymbol("user FLOAT plr_fDeceleration;",  &plr_fDeceleration);
    _pShell->DeclareSymbol("user FLOAT plr_fSpeedForward;",  &plr_fSpeedForward);
    _pShell->DeclareSymbol("user FLOAT plr_fSpeedBackward;", &plr_fSpeedBackward);
    _pShell->DeclareSymbol("user FLOAT plr_fSpeedSide;",     &plr_fSpeedSide);
    _pShell->DeclareSymbol("user FLOAT plr_fSpeedUp;",       &plr_fSpeedUp);
  #endif
  _pShell->DeclareSymbol("persistent user FLOAT plr_fFOV;", &plr_fFOV);
  _pShell->DeclareSymbol("persistent user FLOAT plr_fFrontClipDistance;", &plr_fFrontClipDistance);
  _pShell->DeclareSymbol("persistent user INDEX plr_bRenderPicked;", &plr_bRenderPicked);
  _pShell->DeclareSymbol("persistent user INDEX plr_bRenderPickedParticles;", &plr_bRenderPickedParticles);
  _pShell->DeclareSymbol("persistent user INDEX plr_bOnlySam;", &plr_bOnlySam);
  _pShell->DeclareSymbol("persistent user INDEX ent_bReportBrokenChains;", &ent_bReportBrokenChains);
  _pShell->DeclareSymbol("persistent user FLOAT ent_tmMentalIn  ;", &ent_tmMentalIn  );
  _pShell->DeclareSymbol("persistent user FLOAT ent_tmMentalOut ;", &ent_tmMentalOut );
  _pShell->DeclareSymbol("persistent user FLOAT ent_tmMentalFade;", &ent_tmMentalFade);
  _pShell->DeclareSymbol("persistent user FLOAT gfx_fEnvParticlesDensity;", &gfx_fEnvParticlesDensity);
  _pShell->DeclareSymbol("persistent user FLOAT gfx_fEnvParticlesRange;", &gfx_fEnvParticlesRange);

  // player appearance interface
  _pShell->DeclareSymbol("INDEX SetPlayerAppearance(INDEX, INDEX, INDEX, INDEX);", &SetPlayerAppearance);

  // call player weapons persistant variable initialization
  extern void CPlayerWeapons_Init(void);
  CPlayerWeapons_Init();

  // initialize HUD
  InitHUD();

  // precache
  CPlayer_Precache();
}

// clean up
void CPlayer_OnEndClass(void)
{
  EndHUD();
}

CTString GetDifficultyString(void)
{
  if (GetSP()->sp_bMental) { return TRANS("Mental"); }

  switch (GetSP()->sp_gdGameDifficulty) {
  case CSessionProperties::GD_TOURIST:  return TRANS("Tourist");
  case CSessionProperties::GD_EASY:     return TRANS("Easy");
  default:
  case CSessionProperties::GD_NORMAL:   return TRANS("Normal");
  case CSessionProperties::GD_HARD:     return TRANS("Hard");
  case CSessionProperties::GD_EXTREME:  return TRANS("Serious");
  }
}
// armor & health constants getters

FLOAT MaxArmor(void)
{
  if (GetSP()->sp_gdGameDifficulty<=CSessionProperties::GD_EASY) {
    return 300;
  } else {
    return 200;
  }
}
FLOAT TopArmor(void)
{
  if (GetSP()->sp_gdGameDifficulty<=CSessionProperties::GD_EASY) {
    return 200;
  } else {
    return 100;
  }
}
FLOAT MaxHealth(void)
{
  if (GetSP()->sp_gdGameDifficulty<=CSessionProperties::GD_EASY) {
    return 300;
  } else {
    return 200;
  }
}
FLOAT TopHealth(void)
{
  if (GetSP()->sp_gdGameDifficulty<=CSessionProperties::GD_EASY) {
    return 200;
  } else {
    return 100;
  }
}

// info structure
static EntityInfo eiPlayerGround = {
  EIBT_FLESH, 80.0f,
  0.0f, 1.7f, 0.0f,     // source (eyes)
  0.0f, 1.0f, 0.0f,     // target (body)
};
static EntityInfo eiPlayerCrouch = {
  EIBT_FLESH, 80.0f,
  0.0f, 1.2f, 0.0f,     // source (eyes)
  0.0f, 0.7f, 0.0f,     // target (body)
};
static EntityInfo eiPlayerSwim = {
  EIBT_FLESH, 40.0f,
  0.0f, 0.0f, 0.0f,     // source (eyes)
  0.0f, 0.0f, 0.0f,     // target (body)
};


// animation light specific
#define LIGHT_ANIM_MINIGUN 2
#define LIGHT_ANIM_TOMMYGUN 3
#define LIGHT_ANIM_COLT_SHOTGUN 4
#define LIGHT_ANIM_NONE 5

const char *NameForState(PlayerState pst)
{
  switch(pst) {
  case PST_STAND: return "stand";
  case PST_CROUCH: return "crouch";
  case PST_FALL: return "fall";
  case PST_SWIM: return "swim";
  case PST_DIVE: return "dive";
  default: return "???";
  };
}


// print explanation on how a player died
void PrintPlayerDeathMessage(CPlayer *ppl, const EDeath &eDeath)
{
  CTString strMyName = ppl->GetPlayerName();
  CEntity *penKiller = eDeath.eLastDamage.penInflictor;
  // if killed by a valid entity
  if (penKiller!=NULL) {
    // if killed by a player
    if (IsOfClass(penKiller, "Player")) {
      // if not self
      if (penKiller!=ppl) {
        CTString strKillerName = ((CPlayer*)penKiller)->GetPlayerName();

        if(eDeath.eLastDamage.dmtType==DMT_TELEPORT) {
          CPrintF(TRANS("%s telefragged %s\n"), strKillerName, strMyName);
        } else if(eDeath.eLastDamage.dmtType==DMT_CLOSERANGE) {
          CPrintF(TRANS("%s cut %s into pieces\n"), strKillerName, strMyName);
        } else if(eDeath.eLastDamage.dmtType==DMT_CHAINSAW) {
          CPrintF(TRANS("%s cut %s into pieces\n"), strKillerName, strMyName);
        } else if(eDeath.eLastDamage.dmtType==DMT_BULLET) {
          CPrintF(TRANS("%s poured lead into %s\n"), strKillerName, strMyName);
        } else if(eDeath.eLastDamage.dmtType==DMT_PROJECTILE || eDeath.eLastDamage.dmtType==DMT_EXPLOSION) {
          CPrintF(TRANS("%s blew %s away\n"), strKillerName, strMyName);
        } else if(eDeath.eLastDamage.dmtType==DMT_CANNONBALL) {
          CPrintF(TRANS("%s smashed %s with a cannon\n"), strKillerName, strMyName);
        } else if(eDeath.eLastDamage.dmtType==DMT_CANNONBALL_EXPLOSION) {
          CPrintF(TRANS("%s nuked %s\n"), strKillerName, strMyName);
        } else {
          CPrintF(TRANS("%s killed %s\n"), strKillerName, strMyName);
        }
      } else {
        // make message from damage type
        switch(eDeath.eLastDamage.dmtType) {
        case DMT_DROWNING:  CPrintF(TRANS("%s drowned\n"), strMyName); break;
        case DMT_BURNING:   CPrintF(TRANS("%s burst into flames\n"), strMyName); break;
        case DMT_SPIKESTAB: CPrintF(TRANS("%s fell into a spike-hole\n"), strMyName); break;
        case DMT_FREEZING:  CPrintF(TRANS("%s has frozen\n"), strMyName); break;
        case DMT_ACID:      CPrintF(TRANS("%s dissolved\n"), strMyName); break;
        case DMT_PROJECTILE:
        case DMT_EXPLOSION:
          CPrintF(TRANS("%s blew himself away\n"), strMyName); break;
        default:            CPrintF(TRANS("%s has committed suicide\n"), strMyName);
        }
      }
    // if killed by an enemy
    } else if (IsDerivedFromClass(penKiller, "Enemy Base")) {
      // check for telefrag first
      if(eDeath.eLastDamage.dmtType==DMT_TELEPORT) {
        CPrintF(TRANS("%s was telefragged\n"), strMyName);
        return;
      }
      // describe how this enemy killed player
      CPrintF("%s\n", (const char*)((CEnemyBase*)penKiller)->GetPlayerKillDescription(strMyName, eDeath));

    // if killed by some other entity
    } else {
      // make message from damage type
      switch(eDeath.eLastDamage.dmtType) {
      case DMT_SPIKESTAB: CPrintF(TRANS("%s was pierced\n"), strMyName); break;
      case DMT_BRUSH:     CPrintF(TRANS("%s was squashed\n"), strMyName); break;
      case DMT_ABYSS:     CPrintF(TRANS("%s went over the edge\n"), strMyName); break;
      case DMT_IMPACT:    CPrintF(TRANS("%s swashed\n"), strMyName); break;
      case DMT_HEAT:      CPrintF(TRANS("%s stood in the sun for too long\n"), strMyName); break;
      default:            CPrintF(TRANS("%s passed away\n"), strMyName);
      }
    }
  // if no entity pointer (shouldn't happen)
  } else {
    CPrintF(TRANS("%s is missing in action\n"), strMyName);
  }
}


void CPlayer::SetDefaultProperties(void) {
  m_strName = "<unnamed player>";
  m_ulLastButtons = 0x0;
  m_fArmor = 0.0f;
  m_strGroup = "";
  m_ulKeys = 0;
  m_fMaxHealth = 1;
  m_ulFlags = 0;
  m_penWeapons = NULL;
  m_penAnimator = NULL;
  m_penView = NULL;
  m_pen3rdPersonView = NULL;
  m_iViewState = PVT_PLAYEREYES ;
  m_iLastViewState = PVT_PLAYEREYES ;
  m_aoLightAnimation.SetData(NULL);

  m_fDamageAmmount = 0.0f;
  m_tmWoundedTime = 0.0f;
  m_tmScreamTime = 0.0f;
  m_iGender = GENDER_MALE ;
  m_pstState = PST_STAND ;
  m_fFallTime = 0.0f;
  m_fSwimTime = 0.0f;
  m_tmOutOfWater = 0.0f;
  m_tmMoveSound = 0.0f;
  m_bMoveSoundLeft = TRUE ;
  m_tmNextAmbientOnce = 0.0f;
  m_tmMouthSoundLast = 0.0f;
  m_penCamera = NULL;
  m_strCenterMessage = "";
  m_tmCenterMessageEnd = 0.0f;
  m_bPendingMessage = FALSE ;
  m_tmMessagePlay = 0.0f;
  m_tmAnalyseEnd = 0.0f;
  m_bComputerInvoked = FALSE ;
  m_tmAnimateInbox = -100.0f;
  m_penMainMusicHolder = NULL;
  m_tmLastDamage = -1.0f;
  m_fMaxDamageAmmount = 0.0f;
  m_vDamage = FLOAT3D(0 , 0 , 0);
  m_tmSpraySpawned = -1.0f;
  m_fSprayDamage = 0.0f;
  m_penSpray = NULL;
  m_soWeapon0.SetOwner(this);
m_soWeapon0.Stop_internal();
  m_soWeapon1.SetOwner(this);
m_soWeapon1.Stop_internal();
  m_soWeapon2.SetOwner(this);
m_soWeapon2.Stop_internal();
  m_soWeapon3.SetOwner(this);
m_soWeapon3.Stop_internal();
  m_soWeaponAmbient.SetOwner(this);
m_soWeaponAmbient.Stop_internal();
  m_soPowerUpBeep.SetOwner(this);
m_soPowerUpBeep.Stop_internal();
  m_soMouth.SetOwner(this);
m_soMouth.Stop_internal();
  m_soFootL.SetOwner(this);
m_soFootL.Stop_internal();
  m_soFootR.SetOwner(this);
m_soFootR.Stop_internal();
  m_soBody.SetOwner(this);
m_soBody.Stop_internal();
  m_soLocalAmbientLoop.SetOwner(this);
m_soLocalAmbientLoop.Stop_internal();
  m_soLocalAmbientOnce.SetOwner(this);
m_soLocalAmbientOnce.Stop_internal();
  m_soMessage.SetOwner(this);
m_soMessage.Stop_internal();
  m_soHighScore.SetOwner(this);
m_soHighScore.Stop_internal();
  m_soSpeech.SetOwner(this);
m_soSpeech.Stop_internal();
  m_soSniperZoom.SetOwner(this);
m_soSniperZoom.Stop_internal();
  m_iMana = 0;
  m_fManaFraction = 0.0f;
  m_iHighScore = 0;
  m_iBeatenHighScore = 0;
  m_tmLatency = 0.0f;
  m_tmLatencyLastAvg = 0.0f;
  m_tmLatencyAvgSum = 0.0f;
  m_ctLatencyAvg = 0;
  m_bEndOfLevel = FALSE ;
  m_bEndOfGame = FALSE ;
  m_iMayRespawn = 0;
  m_tmSpawned = 0.0f;
  m_vDied = FLOAT3D(0 , 0 , 0);
  m_aDied = FLOAT3D(0 , 0 , 0);
  m_tmEstTime = 0.0f;
  m_iTimeScore = 0;
  m_iStartTime = 0;
  m_iEndTime = 0;
  m_tmLevelStarted = 0.0f;
  m_strLevelStats = "";
  m_penActionMarker = NULL;
  m_fAutoSpeed = 0.0f;
  m_iAutoOrgWeapon = 0;
  m_vAutoSpeed = FLOAT3D(0 , 0 , 0);
  m_tmSpiritStart = 0.0f;
  m_tmFadeStart = 0.0f;
  m_tmLastPicked = -10000.0f;
  m_strPickedName = "";
  m_fPickedAmmount = 0.0f;
  m_fPickedMana = 0.0f;
  m_iLastHealth = 0;
  m_iLastArmor = 0;
  m_iLastAmmo = 0;
  m_tmHealthChanged = -9;
  m_tmArmorChanged = -9;
  m_tmAmmoChanged = -9;
  m_tmMinigunAutoFireStart = -1.0f;
  m_vLastStain = FLOAT3D(0 , 0 , 0);
  m_aLastRotation = FLOAT3D(0 , 0 , 0);
  m_aLastViewRotation = FLOAT3D(0 , 0 , 0);
  m_vLastTranslation = FLOAT3D(0 , 0 , 0);
  m_aLocalRotation = FLOAT3D(0 , 0 , 0);
  m_aLocalViewRotation = FLOAT3D(0 , 0 , 0);
  m_vLocalTranslation = FLOAT3D(0 , 0 , 0);
  m_tmInvisibility = 0.0f;
  m_tmInvulnerability = 0.0f;
  m_tmSeriousDamage = 0.0f;
  m_tmSeriousSpeed = 0.0f;
  m_tmInvisibilityMax = 30.0f;
  m_tmInvulnerabilityMax = 30.0f;
  m_tmSeriousDamageMax = 40.0f;
  m_tmSeriousSpeedMax = 20.0f;
  m_tmChainShakeEnd = 0.0f;
  m_fChainShakeStrength = 1.0f;
  m_fChainShakeFreqMod = 1.0f;
  m_fChainsawShakeDX = 0.0f;
  m_fChainsawShakeDY = 0.0f;
  m_iSeriousBombCount = 0;
  m_iLastSeriousBombCount = 0;
  m_tmSeriousBombFired = -10.0f;
  m_penPrediction = NULL;
  CPlayerEntity::SetDefaultProperties();
}
  
#line 1281 "C:/MyMod/Sources/EntitiesMP/Player.es"
INDEX CPlayer::GenderSound(INDEX iSound) 
#line 1282 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 1283 "C:/MyMod/Sources/EntitiesMP/Player.es"
return iSound  + m_iGender  * GENDEROFFSET ;
#line 1284 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 1286 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::AddBouble(FLOAT3D vPos,FLOAT3D vSpeedRelative) 
#line 1287 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 1288 "C:/MyMod/Sources/EntitiesMP/Player.es"
ShellLaunchData  & sld  = m_asldData  [ m_iFirstEmptySLD  ];
#line 1289 "C:/MyMod/Sources/EntitiesMP/Player.es"
sld  . sld_vPos  = vPos ;
#line 1290 "C:/MyMod/Sources/EntitiesMP/Player.es"
const FLOATmatrix3D & m  = GetRotationMatrix  ();
#line 1291 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT3D vUp  (m  (1 , 2) , m  (2 , 2) , m  (3 , 2));
#line 1292 "C:/MyMod/Sources/EntitiesMP/Player.es"
sld  . sld_vUp  = vUp ;
#line 1293 "C:/MyMod/Sources/EntitiesMP/Player.es"
sld  . sld_vSpeed  = vSpeedRelative  * m ;
#line 1294 "C:/MyMod/Sources/EntitiesMP/Player.es"
sld  . sld_tmLaunch  = _pTimer  -> CurrentTick  ();
#line 1295 "C:/MyMod/Sources/EntitiesMP/Player.es"
sld  . sld_estType  = ESL_BUBBLE ;
#line 1297 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_iFirstEmptySLD  = (m_iFirstEmptySLD  + 1) % MAX_FLYING_SHELLS ;
#line 1298 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 1300 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::ClearShellLaunchData(void) 
#line 1301 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 1303 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_iFirstEmptySLD  = 0;
#line 1304 "C:/MyMod/Sources/EntitiesMP/Player.es"
for(INDEX iShell  = 0;iShell  < MAX_FLYING_SHELLS ;iShell  ++)
#line 1305 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 1306 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_asldData  [ iShell  ] . sld_tmLaunch  = - 100.0f;
#line 1307 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 1308 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 1310 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::AddBulletSpray(FLOAT3D vPos,EffectParticlesType eptType,FLOAT3D vStretch) 
#line 1311 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 1312 "C:/MyMod/Sources/EntitiesMP/Player.es"
BulletSprayLaunchData  & bsld  = m_absldData  [ m_iFirstEmptyBSLD  ];
#line 1313 "C:/MyMod/Sources/EntitiesMP/Player.es"
bsld  . bsld_vPos  = vPos ;
#line 1314 "C:/MyMod/Sources/EntitiesMP/Player.es"
bsld  . bsld_vG  = en_vGravityDir ;
#line 1315 "C:/MyMod/Sources/EntitiesMP/Player.es"
bsld  . bsld_eptType  = eptType ;
#line 1316 "C:/MyMod/Sources/EntitiesMP/Player.es"
bsld  . bsld_iRndBase  = FRnd  () * 123456;
#line 1317 "C:/MyMod/Sources/EntitiesMP/Player.es"
bsld  . bsld_tmLaunch  = _pTimer  -> CurrentTick  ();
#line 1318 "C:/MyMod/Sources/EntitiesMP/Player.es"
bsld  . bsld_vStretch  = vStretch ;
#line 1320 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_iFirstEmptyBSLD  = (m_iFirstEmptyBSLD  + 1) % MAX_BULLET_SPRAYS ;
#line 1321 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 1323 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::ClearBulletSprayLaunchData(void) 
#line 1324 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 1325 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_iFirstEmptyBSLD  = 0;
#line 1326 "C:/MyMod/Sources/EntitiesMP/Player.es"
for(INDEX iBulletSpray  = 0;iBulletSpray  < MAX_BULLET_SPRAYS ;iBulletSpray  ++)
#line 1327 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 1328 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_absldData  [ iBulletSpray  ] . bsld_tmLaunch  = - 100.0f;
#line 1329 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 1330 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 1332 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::AddGoreSpray(FLOAT3D vPos,FLOAT3D v3rdPos,SprayParticlesType sptType,FLOAT3D vSpilDirection,
#line 1333 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOATaabbox3D boxHitted,FLOAT fDamagePower,COLOR colParticles) 
#line 1334 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 1335 "C:/MyMod/Sources/EntitiesMP/Player.es"
GoreSprayLaunchData  & gsld  = m_agsldData  [ m_iFirstEmptyGSLD  ];
#line 1336 "C:/MyMod/Sources/EntitiesMP/Player.es"
gsld  . gsld_vPos  = vPos ;
#line 1337 "C:/MyMod/Sources/EntitiesMP/Player.es"
gsld  . gsld_v3rdPos  = v3rdPos ;
#line 1338 "C:/MyMod/Sources/EntitiesMP/Player.es"
gsld  . gsld_vG  = en_vGravityDir ;
#line 1339 "C:/MyMod/Sources/EntitiesMP/Player.es"
gsld  . gsld_fGA  = en_fGravityA ;
#line 1340 "C:/MyMod/Sources/EntitiesMP/Player.es"
gsld  . gsld_sptType  = sptType ;
#line 1341 "C:/MyMod/Sources/EntitiesMP/Player.es"
gsld  . gsld_boxHitted  = boxHitted ;
#line 1342 "C:/MyMod/Sources/EntitiesMP/Player.es"
gsld  . gsld_vSpilDirection  = vSpilDirection ;
#line 1343 "C:/MyMod/Sources/EntitiesMP/Player.es"
gsld  . gsld_fDamagePower  = fDamagePower ;
#line 1344 "C:/MyMod/Sources/EntitiesMP/Player.es"
gsld  . gsld_tmLaunch  = _pTimer  -> CurrentTick  ();
#line 1345 "C:/MyMod/Sources/EntitiesMP/Player.es"
gsld  . gsld_colParticles  = colParticles ;
#line 1347 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_iFirstEmptyGSLD  = (m_iFirstEmptyGSLD  + 1) % MAX_GORE_SPRAYS ;
#line 1348 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 1350 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::ClearGoreSprayLaunchData(void) 
#line 1351 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 1352 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_iFirstEmptyGSLD  = 0;
#line 1353 "C:/MyMod/Sources/EntitiesMP/Player.es"
for(INDEX iGoreSpray  = 0;iGoreSpray  < MAX_GORE_SPRAYS ;iGoreSpray  ++)
#line 1354 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 1355 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_agsldData  [ iGoreSpray  ] . gsld_tmLaunch  = - 100.0f;
#line 1356 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 1357 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
   CPlayer::CPlayer(void) 
#line 1360 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 1362 "C:/MyMod/Sources/EntitiesMP/Player.es"
bUseButtonHeld  = FALSE ;
#line 1363 "C:/MyMod/Sources/EntitiesMP/Player.es"
ClearShellLaunchData  ();
#line 1364 "C:/MyMod/Sources/EntitiesMP/Player.es"
ClearBulletSprayLaunchData  ();
#line 1365 "C:/MyMod/Sources/EntitiesMP/Player.es"
ClearGoreSprayLaunchData  ();
#line 1366 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_tmPredict  = 0;
#line 1372 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 1374 "C:/MyMod/Sources/EntitiesMP/Player.es"
class CPlayerWeapons * CPlayer::GetPlayerWeapons(void) 
#line 1375 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 1376 "C:/MyMod/Sources/EntitiesMP/Player.es"
ASSERT  (m_penWeapons  != NULL );
#line 1377 "C:/MyMod/Sources/EntitiesMP/Player.es"
return (CPlayerWeapons  *) & * m_penWeapons ;
#line 1378 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 1379 "C:/MyMod/Sources/EntitiesMP/Player.es"
class CPlayerAnimator * CPlayer::GetPlayerAnimator(void) 
#line 1380 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 1381 "C:/MyMod/Sources/EntitiesMP/Player.es"
ASSERT  (m_penAnimator  != NULL );
#line 1382 "C:/MyMod/Sources/EntitiesMP/Player.es"
return (CPlayerAnimator  *) & * m_penAnimator ;
#line 1383 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 1385 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlayerSettings * CPlayer::GetSettings(void) 
#line 1386 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 1387 "C:/MyMod/Sources/EntitiesMP/Player.es"
return (CPlayerSettings  *) en_pcCharacter  . pc_aubAppearance ;
#line 1388 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  void CPlayer::Copy(CEntity & enOther,ULONG ulFlags) 
#line 1391 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 1392 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlayerEntity  :: Copy  (enOther  , ulFlags );
#line 1393 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlayer  * penOther  = (CPlayer  *) (& enOther );
#line 1394 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_moRender  . Copy  (penOther  -> m_moRender );
#line 1395 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_psLevelStats  = penOther  -> m_psLevelStats ;
#line 1396 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_psLevelTotal  = penOther  -> m_psLevelTotal ;
#line 1397 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_psGameStats  = penOther  -> m_psGameStats ;
#line 1398 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_psGameTotal  = penOther  -> m_psGameTotal ;
#line 1401 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(ulFlags  & COPY_PREDICTOR )
#line 1402 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 1404 "C:/MyMod/Sources/EntitiesMP/Player.es"
memcpy  (m_asldData  , penOther  -> m_asldData  , sizeof  (m_asldData ));
#line 1405 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_iFirstEmptySLD  = penOther  -> m_iFirstEmptySLD ;
#line 1407 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_acmiMessages  . Clear  ();
#line 1408 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_ctUnreadMessages  = 0;
#line 1410 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetupLightSource  ();
#line 1413 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 1415 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_acmiMessages  = penOther  -> m_acmiMessages ;
#line 1416 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_ctUnreadMessages  = penOther  -> m_ctUnreadMessages ;
#line 1417 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 1418 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 1421 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::UpdateLatency(FLOAT tmLatencyNow) 
#line 1422 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 1423 "C:/MyMod/Sources/EntitiesMP/Player.es"
TIME  tmNow  = _pTimer  -> GetHighPrecisionTimer  () . GetSeconds  ();
#line 1426 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(tmNow  < m_tmLatencyLastAvg  + hud_tmLatencySnapshot ){
#line 1428 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_tmLatencyAvgSum  += tmLatencyNow ;
#line 1429 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_ctLatencyAvg  ++;
#line 1432 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 1434 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_tmLatency  = m_tmLatencyAvgSum  / m_ctLatencyAvg ;
#line 1436 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_tmLatencyAvgSum  = 0.0f;
#line 1437 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_ctLatencyAvg  = 0;
#line 1438 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_tmLatencyLastAvg  = tmNow ;
#line 1439 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 1441 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(_pNetwork  -> IsPlayerLocal  (this )){
#line 1442 "C:/MyMod/Sources/EntitiesMP/Player.es"
en_tmPing  = m_tmLatency ;
#line 1443 "C:/MyMod/Sources/EntitiesMP/Player.es"
net_tmLatencyAvg  = en_tmPing ;
#line 1444 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 1445 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 1448 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::ValidateCharacter(void) 
#line 1449 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 1451 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(GetSP  () -> sp_bSinglePlayer ){
#line 1453 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlayerSettings  * pps  = (CPlayerSettings  *) en_pcCharacter  . pc_aubAppearance ;
#line 1454 "C:/MyMod/Sources/EntitiesMP/Player.es"
memset  (pps  -> ps_achModelFile  , 0 , sizeof  (pps  -> ps_achModelFile ));
#line 1455 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 1456 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 1458 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::ParseGender(CTString & strName) 
#line 1459 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 1460 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(strName  . RemovePrefix  ("#male#")){
#line 1461 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_iGender  = GENDER_MALE ;
#line 1462 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else if(strName  . RemovePrefix  ("#female#")){
#line 1463 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_iGender  = GENDER_FEMALE ;
#line 1464 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 1465 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_iGender  = GENDER_MALE ;
#line 1466 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 1467 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 1469 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::CheckHighScore(void) 
#line 1470 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 1472 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(! _pNetwork  -> IsPlayingDemo  ()){
#line 1474 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(plr_iHiScore  > m_iHighScore ){
#line 1475 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_iHighScore  = plr_iHiScore ;
#line 1476 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 1477 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 1480 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_psGameStats  . ps_iScore  > m_iHighScore ){
#line 1482 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_iHighScore  > m_iBeatenHighScore ){
#line 1484 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_iBeatenHighScore  = m_iHighScore ;
#line 1486 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_soHighScore  . Set3DParameters  (25.0f , 5.0f , 1.0f , 1.0f);
#line 1488 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 1489 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 1490 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 1492 "C:/MyMod/Sources/EntitiesMP/Player.es"
CTString CPlayer::GetPredictName(void)const 
#line 1493 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 1494 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(IsPredicted  ()){
#line 1495 "C:/MyMod/Sources/EntitiesMP/Player.es"
return "PREDICTED";
#line 1496 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else if(IsPredictor  ()){
#line 1497 "C:/MyMod/Sources/EntitiesMP/Player.es"
return "predictor";
#line 1498 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else if(GetFlags  () & ENF_WILLBEPREDICTED ){
#line 1499 "C:/MyMod/Sources/EntitiesMP/Player.es"
return "WILLBEPREDICTED";
#line 1500 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 1501 "C:/MyMod/Sources/EntitiesMP/Player.es"
return "no prediction";
#line 1502 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 1503 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 1505 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::Write_t(CTStream * ostr) 
#line 1506 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 1507 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlayerEntity  :: Write_t  (ostr );
#line 1509 "C:/MyMod/Sources/EntitiesMP/Player.es"
ostr  -> WriteID_t  ("MSGS");
#line 1510 "C:/MyMod/Sources/EntitiesMP/Player.es"
INDEX ctMsg  = m_acmiMessages  . Count  ();
#line 1511 "C:/MyMod/Sources/EntitiesMP/Player.es"
(* ostr ) << ctMsg ;
#line 1512 "C:/MyMod/Sources/EntitiesMP/Player.es"
for(INDEX iMsg  = 0;iMsg  < ctMsg ;iMsg  ++){
#line 1513 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_acmiMessages  [ iMsg  ] . Write_t  (* ostr );
#line 1514 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 1515 "C:/MyMod/Sources/EntitiesMP/Player.es"
ostr  -> Write_t  (& m_psLevelStats  , sizeof  (m_psLevelStats ));
#line 1516 "C:/MyMod/Sources/EntitiesMP/Player.es"
ostr  -> Write_t  (& m_psLevelTotal  , sizeof  (m_psLevelTotal ));
#line 1517 "C:/MyMod/Sources/EntitiesMP/Player.es"
ostr  -> Write_t  (& m_psGameStats  , sizeof  (m_psGameStats ));
#line 1518 "C:/MyMod/Sources/EntitiesMP/Player.es"
ostr  -> Write_t  (& m_psGameTotal  , sizeof  (m_psGameTotal ));
#line 1519 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 1521 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::Read_t(CTStream * istr) 
#line 1522 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 1523 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlayerEntity  :: Read_t  (istr );
#line 1525 "C:/MyMod/Sources/EntitiesMP/Player.es"
ClearShellLaunchData  ();
#line 1526 "C:/MyMod/Sources/EntitiesMP/Player.es"
ClearBulletSprayLaunchData  ();
#line 1527 "C:/MyMod/Sources/EntitiesMP/Player.es"
ClearGoreSprayLaunchData  ();
#line 1529 "C:/MyMod/Sources/EntitiesMP/Player.es"
istr  -> ExpectID_t  ("MSGS");
#line 1530 "C:/MyMod/Sources/EntitiesMP/Player.es"
INDEX ctMsg ;
#line 1531 "C:/MyMod/Sources/EntitiesMP/Player.es"
(* istr ) >> ctMsg ;
#line 1532 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_acmiMessages  . Clear  ();
#line 1533 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_ctUnreadMessages  = 0;
#line 1534 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(ctMsg  > 0){
#line 1535 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_acmiMessages  . Push  (ctMsg );
#line 1536 "C:/MyMod/Sources/EntitiesMP/Player.es"
for(INDEX iMsg  = 0;iMsg  < ctMsg ;iMsg  ++){
#line 1537 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_acmiMessages  [ iMsg  ] . Read_t  (* istr );
#line 1538 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(! m_acmiMessages  [ iMsg  ] . cmi_bRead ){
#line 1539 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_ctUnreadMessages  ++;
#line 1540 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 1541 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 1542 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 1544 "C:/MyMod/Sources/EntitiesMP/Player.es"
istr  -> Read_t  (& m_psLevelStats  , sizeof  (m_psLevelStats ));
#line 1545 "C:/MyMod/Sources/EntitiesMP/Player.es"
istr  -> Read_t  (& m_psLevelTotal  , sizeof  (m_psLevelTotal ));
#line 1546 "C:/MyMod/Sources/EntitiesMP/Player.es"
istr  -> Read_t  (& m_psGameStats  , sizeof  (m_psGameStats ));
#line 1547 "C:/MyMod/Sources/EntitiesMP/Player.es"
istr  -> Read_t  (& m_psGameTotal  , sizeof  (m_psGameTotal ));
#line 1550 "C:/MyMod/Sources/EntitiesMP/Player.es"
ValidateCharacter  ();
#line 1551 "C:/MyMod/Sources/EntitiesMP/Player.es"
CTString strDummy ;
#line 1552 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetPlayerAppearance  (& m_moRender  , & en_pcCharacter  , strDummy  , FALSE );
#line 1553 "C:/MyMod/Sources/EntitiesMP/Player.es"
ParseGender  (strDummy );
#line 1554 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_ulFlags  |= PLF_SYNCWEAPON ;
#line 1556 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetupLightSource  ();
#line 1557 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 1560 "C:/MyMod/Sources/EntitiesMP/Player.es"
CLightSource * CPlayer::GetLightSource(void) 
#line 1561 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 1562 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(! IsPredictor  ()){
#line 1563 "C:/MyMod/Sources/EntitiesMP/Player.es"
return & m_lsLightSource ;
#line 1564 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 1565 "C:/MyMod/Sources/EntitiesMP/Player.es"
return NULL ;
#line 1566 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 1567 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 1570 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::SetPredictionTime(TIME tmAdvance) 
#line 1571 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 1572 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_tmPredict  = _pTimer  -> CurrentTick  () + tmAdvance ;
#line 1573 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 1576 "C:/MyMod/Sources/EntitiesMP/Player.es"
TIME CPlayer::GetPredictionTime(void) 
#line 1577 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 1578 "C:/MyMod/Sources/EntitiesMP/Player.es"
return m_tmPredict ;
#line 1579 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 1582 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT CPlayer::GetPredictionRange(void) 
#line 1583 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 1584 "C:/MyMod/Sources/EntitiesMP/Player.es"
return cli_fPredictPlayersRange ;
#line 1585 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 1588 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::AddDependentsToPrediction(void) 
#line 1589 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 1590 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_penWeapons  -> AddToPrediction  ();
#line 1591 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_penAnimator  -> AddToPrediction  ();
#line 1592 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_penView  -> AddToPrediction  ();
#line 1593 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_pen3rdPersonView  -> AddToPrediction  ();
#line 1594 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 1597 "C:/MyMod/Sources/EntitiesMP/Player.es"
TIME CPlayer::GetStatsInGameTimeLevel(void) 
#line 1598 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 1599 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_bEndOfLevel ){
#line 1600 "C:/MyMod/Sources/EntitiesMP/Player.es"
return m_psLevelStats  . ps_tmTime ;
#line 1601 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 1602 "C:/MyMod/Sources/EntitiesMP/Player.es"
return _pNetwork  -> GetGameTime  () - m_tmLevelStarted ;
#line 1603 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 1604 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 1605 "C:/MyMod/Sources/EntitiesMP/Player.es"
TIME CPlayer::GetStatsInGameTimeGame(void) 
#line 1606 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 1607 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_bEndOfLevel ){
#line 1608 "C:/MyMod/Sources/EntitiesMP/Player.es"
return m_psGameStats  . ps_tmTime ;
#line 1609 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 1610 "C:/MyMod/Sources/EntitiesMP/Player.es"
return m_psGameStats  . ps_tmTime  + (_pNetwork  -> GetGameTime  () - m_tmLevelStarted );
#line 1611 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 1612 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 1614 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT CPlayer::GetStatsRealWorldTime(void) 
#line 1615 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 1616 "C:/MyMod/Sources/EntitiesMP/Player.es"
time_t  timeNow ;
#line 1617 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_bEndOfLevel ){
#line 1618 "C:/MyMod/Sources/EntitiesMP/Player.es"
timeNow  = m_iEndTime ;
#line 1619 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 1620 "C:/MyMod/Sources/EntitiesMP/Player.es"
time  (& timeNow );
#line 1621 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 1622 "C:/MyMod/Sources/EntitiesMP/Player.es"
return (FLOAT) difftime  (timeNow  , m_iStartTime );
#line 1623 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 1625 "C:/MyMod/Sources/EntitiesMP/Player.es"
CTString CPlayer::GetStatsRealWorldStarted(void) 
#line 1626 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 1627 "C:/MyMod/Sources/EntitiesMP/Player.es"
struct  tm  * newtime ;
#line 1628 "C:/MyMod/Sources/EntitiesMP/Player.es"
newtime  = localtime  (& m_iStartTime );
#line 1630 "C:/MyMod/Sources/EntitiesMP/Player.es"
setlocale  (LC_ALL  , "");
#line 1631 "C:/MyMod/Sources/EntitiesMP/Player.es"
CTString strTimeline ;
#line 1632 "C:/MyMod/Sources/EntitiesMP/Player.es"
char  achTimeLine  [ 256 ];
#line 1633 "C:/MyMod/Sources/EntitiesMP/Player.es"
strftime  (achTimeLine  , sizeof  (achTimeLine ) - 1 , "%a %x %H:%M" , newtime );
#line 1634 "C:/MyMod/Sources/EntitiesMP/Player.es"
strTimeline  = achTimeLine ;
#line 1635 "C:/MyMod/Sources/EntitiesMP/Player.es"
setlocale  (LC_ALL  , "C");
#line 1636 "C:/MyMod/Sources/EntitiesMP/Player.es"
return strTimeline ;
#line 1637 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  void CPlayer::GetStats(CTString & strStats,const CompStatType csType,INDEX ctCharsPerRow) 
#line 1641 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 1644 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(csType  == CST_SHORT ){
#line 1645 "C:/MyMod/Sources/EntitiesMP/Player.es"
GetShortStats  (strStats );
#line 1646 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 1647 "C:/MyMod/Sources/EntitiesMP/Player.es"
ASSERT  (csType  == CST_DETAIL );
#line 1649 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  = "\n";
#line 1650 "C:/MyMod/Sources/EntitiesMP/Player.es"
_ctAlignWidth  = Min  (ctCharsPerRow  , INDEX (60));
#line 1652 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(GetSP  () -> sp_bCooperative ){
#line 1653 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(GetSP  () -> sp_bSinglePlayer ){
#line 1654 "C:/MyMod/Sources/EntitiesMP/Player.es"
GetDetailStatsSP  (strStats  , 0);
#line 1655 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 1656 "C:/MyMod/Sources/EntitiesMP/Player.es"
GetDetailStatsCoop  (strStats );
#line 1657 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 1658 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 1659 "C:/MyMod/Sources/EntitiesMP/Player.es"
GetDetailStatsDM  (strStats );
#line 1660 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 1661 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 1662 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 1665 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::GetShortStats(CTString & strStats) 
#line 1666 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 1667 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  . PrintF  (TRANS  ("%s %s Score: %d Kills: %d/%d") , 
#line 1668 "C:/MyMod/Sources/EntitiesMP/Player.es"
GetDifficultyString  () , TimeToString  (GetStatsInGameTimeLevel  ()) , 
#line 1669 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_psLevelStats  . ps_iScore  , m_psLevelStats  . ps_iKills  , m_psLevelTotal  . ps_iKills );
#line 1670 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 1673 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::GetDetailStatsDM(CTString & strStats) 
#line 1674 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 1675 "C:/MyMod/Sources/EntitiesMP/Player.es"
extern  INDEX SetAllPlayersStats  (INDEX iSortKey );
#line 1676 "C:/MyMod/Sources/EntitiesMP/Player.es"
extern  CPlayer  * _apenPlayers  [ NET_MAXGAMEPLAYERS  ];
#line 1678 "C:/MyMod/Sources/EntitiesMP/Player.es"
const BOOL bFragMatch  = GetSP  () -> sp_bUseFrags ;
#line 1681 "C:/MyMod/Sources/EntitiesMP/Player.es"
const INDEX ctPlayers  = SetAllPlayersStats  (bFragMatch  ? 5 : 3);
#line 1684 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += AlignString  (CTString (0 , "^cFFFFFF%s:^r\n%s" , TRANS  ("TIME") , TimeToString  (_pNetwork  -> GetGameTime  ())));
#line 1685 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += "\n";
#line 1688 "C:/MyMod/Sources/EntitiesMP/Player.es"
INDEX iMaxFrags  = LowerLimit  (INDEX (0));
#line 1689 "C:/MyMod/Sources/EntitiesMP/Player.es"
INDEX iMaxScore  = LowerLimit  (INDEX (0));
#line 1690 "C:/MyMod/Sources/EntitiesMP/Player.es"
{for(INDEX iPlayer  = 0;iPlayer  < ctPlayers ;iPlayer  ++){
#line 1691 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlayer  * penPlayer  = _apenPlayers  [ iPlayer  ];
#line 1692 "C:/MyMod/Sources/EntitiesMP/Player.es"
iMaxFrags  = Max  (iMaxFrags  , penPlayer  -> m_psLevelStats  . ps_iKills );
#line 1693 "C:/MyMod/Sources/EntitiesMP/Player.es"
iMaxScore  = Max  (iMaxScore  , penPlayer  -> m_psLevelStats  . ps_iScore );
#line 1694 "C:/MyMod/Sources/EntitiesMP/Player.es"
}}
#line 1697 "C:/MyMod/Sources/EntitiesMP/Player.es"
const CSessionProperties  & sp  = * GetSP  ();
#line 1698 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(sp  . sp_iTimeLimit  > 0){
#line 1699 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fTimeLeft  = ClampDn  (sp  . sp_iTimeLimit  * 60.0f - _pNetwork  -> GetGameTime  () , 0.0f);
#line 1700 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += AlignString  (CTString (0 , "^cFFFFFF%s:^r\n%s" , TRANS  ("TIME LEFT") , TimeToString  (fTimeLeft )));
#line 1701 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += "\n";
#line 1702 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 1703 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(bFragMatch  && sp  . sp_iFragLimit  > 0){
#line 1704 "C:/MyMod/Sources/EntitiesMP/Player.es"
INDEX iFragsLeft  = ClampDn  (sp  . sp_iFragLimit  - iMaxFrags  , INDEX (0));
#line 1705 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += AlignString  (CTString (0 , "^cFFFFFF%s:^r\n%d" , TRANS  ("FRAGS LEFT") , iFragsLeft ));
#line 1706 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += "\n";
#line 1707 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 1708 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(! bFragMatch  && sp  . sp_iScoreLimit  > 0){
#line 1709 "C:/MyMod/Sources/EntitiesMP/Player.es"
INDEX iScoreLeft  = ClampDn  (sp  . sp_iScoreLimit  - iMaxScore  , INDEX (0));
#line 1710 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += AlignString  (CTString (0 , "^cFFFFFF%s:^r\n%d" , TRANS  ("SCORE LEFT") , iScoreLeft ));
#line 1711 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += "\n";
#line 1712 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 1713 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += "\n";
#line 1715 "C:/MyMod/Sources/EntitiesMP/Player.es"
CTString strRank  = TRANS  ("NO.");
#line 1716 "C:/MyMod/Sources/EntitiesMP/Player.es"
CTString strFrag  = bFragMatch  ? TRANS  ("FRAGS") : TRANS  ("SCORE");
#line 1717 "C:/MyMod/Sources/EntitiesMP/Player.es"
CTString strPing  = TRANS  ("PING");
#line 1718 "C:/MyMod/Sources/EntitiesMP/Player.es"
CTString strName  = TRANS  ("PLAYER");
#line 1719 "C:/MyMod/Sources/EntitiesMP/Player.es"
INDEX ctRankChars  = Max  (strRank  . Length  () , INDEX (3));
#line 1720 "C:/MyMod/Sources/EntitiesMP/Player.es"
INDEX ctFragChars  = Max  (strFrag  . Length  () , INDEX (7));
#line 1721 "C:/MyMod/Sources/EntitiesMP/Player.es"
INDEX ctPingChars  = Max  (strPing  . Length  () , INDEX (5));
#line 1722 "C:/MyMod/Sources/EntitiesMP/Player.es"
INDEX ctNameChars  = Max  (strName  . Length  () , INDEX (20));
#line 1725 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += "^cFFFFFF";
#line 1726 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += PadStringRight  (strRank  , ctRankChars ) + " ";
#line 1727 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += PadStringLeft  (strFrag  , ctFragChars ) + " ";
#line 1728 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += PadStringLeft  (strPing  , ctPingChars ) + " ";
#line 1729 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += PadStringRight  (strName  , ctNameChars ) + " ";
#line 1730 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += "^r";
#line 1731 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += "\n\n";
#line 1732 "C:/MyMod/Sources/EntitiesMP/Player.es"
{for(INDEX iPlayer  = 0;iPlayer  < ctPlayers ;iPlayer  ++){
#line 1733 "C:/MyMod/Sources/EntitiesMP/Player.es"
CTString strLine ;
#line 1734 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlayer  * penPlayer  = _apenPlayers  [ iPlayer  ];
#line 1735 "C:/MyMod/Sources/EntitiesMP/Player.es"
INDEX iPing  = ceil  (penPlayer  -> en_tmPing  * 1000.0f);
#line 1736 "C:/MyMod/Sources/EntitiesMP/Player.es"
INDEX iScore  = bFragMatch  ? penPlayer  -> m_psLevelStats  . ps_iKills  : penPlayer  -> m_psLevelStats  . ps_iScore ;
#line 1737 "C:/MyMod/Sources/EntitiesMP/Player.es"
CTString strName  = penPlayer  -> GetPlayerName  ();
#line 1739 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += PadStringRight  (CTString (0 , "%d" , iPlayer  + 1) , ctRankChars ) + " ";
#line 1740 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += PadStringLeft  (CTString (0 , "%d" , iScore ) , ctFragChars ) + " ";
#line 1741 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += PadStringLeft  (CTString (0 , "%d" , iPing ) , ctPingChars ) + " ";
#line 1742 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += PadStringRight  (strName  , ctNameChars ) + " ";
#line 1743 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += "\n";
#line 1744 "C:/MyMod/Sources/EntitiesMP/Player.es"
}}
#line 1745 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 1748 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::GetDetailStatsCoop(CTString & strStats) 
#line 1749 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 1751 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += "^b" + CenterString  (TRANS  ("YOUR STATS")) + "^r\n";
#line 1752 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += "\n";
#line 1753 "C:/MyMod/Sources/EntitiesMP/Player.es"
GetDetailStatsSP  (strStats  , 1);
#line 1756 "C:/MyMod/Sources/EntitiesMP/Player.es"
extern  INDEX SetAllPlayersStats  (INDEX iSortKey );
#line 1757 "C:/MyMod/Sources/EntitiesMP/Player.es"
extern  CPlayer  * _apenPlayers  [ NET_MAXGAMEPLAYERS  ];
#line 1758 "C:/MyMod/Sources/EntitiesMP/Player.es"
const INDEX ctPlayers  = SetAllPlayersStats  (3);
#line 1761 "C:/MyMod/Sources/EntitiesMP/Player.es"
PlayerStats  psSquadLevel  = PlayerStats  ();
#line 1762 "C:/MyMod/Sources/EntitiesMP/Player.es"
PlayerStats  psSquadGame  = PlayerStats  ();
#line 1763 "C:/MyMod/Sources/EntitiesMP/Player.es"
{for(INDEX iPlayer  = 0;iPlayer  < ctPlayers ;iPlayer  ++){
#line 1764 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlayer  * penPlayer  = _apenPlayers  [ iPlayer  ];
#line 1766 "C:/MyMod/Sources/EntitiesMP/Player.es"
ASSERT  (penPlayer  != NULL );
#line 1767 "C:/MyMod/Sources/EntitiesMP/Player.es"
PlayerStats  psLevel  = penPlayer  -> m_psLevelStats ;
#line 1768 "C:/MyMod/Sources/EntitiesMP/Player.es"
PlayerStats  psGame  = penPlayer  -> m_psGameStats ;
#line 1769 "C:/MyMod/Sources/EntitiesMP/Player.es"
psSquadLevel  . ps_iScore  += psLevel  . ps_iScore ;
#line 1770 "C:/MyMod/Sources/EntitiesMP/Player.es"
psSquadLevel  . ps_iKills  += psLevel  . ps_iKills ;
#line 1771 "C:/MyMod/Sources/EntitiesMP/Player.es"
psSquadLevel  . ps_iDeaths  += psLevel  . ps_iDeaths ;
#line 1772 "C:/MyMod/Sources/EntitiesMP/Player.es"
psSquadLevel  . ps_iSecrets  += psLevel  . ps_iSecrets ;
#line 1773 "C:/MyMod/Sources/EntitiesMP/Player.es"
psSquadGame  . ps_iScore  += psGame  . ps_iScore ;
#line 1774 "C:/MyMod/Sources/EntitiesMP/Player.es"
psSquadGame  . ps_iKills  += psGame  . ps_iKills ;
#line 1775 "C:/MyMod/Sources/EntitiesMP/Player.es"
psSquadGame  . ps_iDeaths  += psGame  . ps_iDeaths ;
#line 1776 "C:/MyMod/Sources/EntitiesMP/Player.es"
psSquadGame  . ps_iSecrets  += psGame  . ps_iSecrets ;
#line 1777 "C:/MyMod/Sources/EntitiesMP/Player.es"
}}
#line 1780 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += "\n";
#line 1781 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += "^b" + CenterString  (TRANS  ("SQUAD TOTAL")) + "^r\n";
#line 1782 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += "\n";
#line 1783 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += CTString (0 , "^cFFFFFF%s^r" , TranslateConst  (en_pwoWorld  -> GetName  () , 0));
#line 1784 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += "\n";
#line 1785 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += AlignString  (CTString (0 , "  %s:\n%d" , TRANS  ("SCORE") , psSquadLevel  . ps_iScore ));
#line 1786 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += "\n";
#line 1787 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += AlignString  (CTString (0 , "  %s:\n%d" , TRANS  ("DEATHS") , psSquadLevel  . ps_iDeaths ));
#line 1788 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += "\n";
#line 1789 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += AlignString  (CTString (0 , "  %s:\n%d/%d" , TRANS  ("KILLS") , psSquadLevel  . ps_iKills  , m_psLevelTotal  . ps_iKills ));
#line 1790 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += "\n";
#line 1791 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += AlignString  (CTString (0 , "  %s:\n%d/%d" , TRANS  ("SECRETS") , psSquadLevel  . ps_iSecrets  , m_psLevelTotal  . ps_iSecrets ));
#line 1792 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += "\n";
#line 1793 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += "\n";
#line 1794 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += CTString ("^cFFFFFF") + TRANS  ("TOTAL") + "^r\n";
#line 1795 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += AlignString  (CTString (0 , "  %s:\n%d" , TRANS  ("SCORE") , psSquadGame  . ps_iScore ));
#line 1796 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += "\n";
#line 1797 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += AlignString  (CTString (0 , "  %s:\n%d" , TRANS  ("DEATHS") , psSquadGame  . ps_iDeaths ));
#line 1798 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += "\n";
#line 1799 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += AlignString  (CTString (0 , "  %s:\n%d/%d" , TRANS  ("KILLS") , psSquadGame  . ps_iKills  , m_psGameTotal  . ps_iKills ));
#line 1800 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += "\n";
#line 1801 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += AlignString  (CTString (0 , "  %s:\n%d/%d" , TRANS  ("SECRETS") , psSquadGame  . ps_iSecrets  , m_psGameTotal  . ps_iSecrets ));
#line 1802 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += "\n";
#line 1803 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += "\n";
#line 1806 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += "\n";
#line 1807 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += "^b" + CenterString  (TRANS  ("OTHER PLAYERS")) + "^r\n";
#line 1808 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += "\n";
#line 1811 "C:/MyMod/Sources/EntitiesMP/Player.es"
{for(INDEX iPlayer  = 0;iPlayer  < ctPlayers ;iPlayer  ++){
#line 1812 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlayer  * penPlayer  = _apenPlayers  [ iPlayer  ];
#line 1814 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(penPlayer  == this ){
#line 1816 "C:/MyMod/Sources/EntitiesMP/Player.es"
continue ;
#line 1817 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 1819 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += "^cFFFFFF" + CenterString  (penPlayer  -> GetPlayerName  ()) + "^r\n\n";
#line 1820 "C:/MyMod/Sources/EntitiesMP/Player.es"
penPlayer  -> GetDetailStatsSP  (strStats  , 2);
#line 1821 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += "\n";
#line 1822 "C:/MyMod/Sources/EntitiesMP/Player.es"
}}
#line 1823 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 1826 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::GetDetailStatsSP(CTString & strStats,INDEX iCoopType) 
#line 1827 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 1828 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(iCoopType  <= 1){
#line 1829 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_bEndOfGame ){
#line 1830 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(GetSP  () -> sp_gdGameDifficulty  == CSessionProperties  :: GD_EXTREME ){
#line 1831 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += TRANS  ("^f4SERIOUS GAME FINISHED,\nMENTAL MODE IS NOW ENABLED!^F\n\n");
#line 1832 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else if(GetSP  () -> sp_bMental ){
#line 1833 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += TRANS  ("^f4YOU HAVE MASTERED THE GAME!^F\n\n");
#line 1834 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 1835 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 1836 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 1838 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(iCoopType  <= 1){
#line 1840 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += AlignString  (CTString (0 , "^cFFFFFF%s:^r\n%d" , TRANS  ("TOTAL SCORE") , m_psGameStats  . ps_iScore ));
#line 1841 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += "\n";
#line 1842 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += AlignString  (CTString (0 , "^cFFFFFF%s:^r\n%s" , TRANS  ("DIFFICULTY") , GetDifficultyString  ()));
#line 1843 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += "\n";
#line 1844 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += AlignString  (CTString (0 , "^cFFFFFF%s:^r\n%s" , TRANS  ("STARTED") , GetStatsRealWorldStarted  ()));
#line 1845 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += "\n";
#line 1846 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += AlignString  (CTString (0 , "^cFFFFFF%s:^r\n%s" , TRANS  ("PLAYING TIME") , TimeToString  (GetStatsRealWorldTime  ())));
#line 1847 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += "\n";
#line 1848 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_psGameStats  . ps_iScore  <= plr_iHiScore ){
#line 1849 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += AlignString  (CTString (0 , "^cFFFFFF%s:^r\n%d" , TRANS  ("HI-SCORE") , plr_iHiScore ));
#line 1850 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 1851 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += TRANS  ("YOU BEAT THE HI-SCORE!");
#line 1852 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 1853 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += "\n\n";
#line 1854 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 1857 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += CTString (0 , "^cFFFFFF%s^r" , TranslateConst  (en_pwoWorld  -> GetName  () , 0));
#line 1858 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += "\n";
#line 1859 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(iCoopType  <= 1){
#line 1860 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_bEndOfLevel ){
#line 1861 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += AlignString  (CTString (0 , "  %s:\n%s" , TRANS  ("ESTIMATED TIME") , TimeToString  (m_tmEstTime )));
#line 1862 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += "\n";
#line 1863 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += AlignString  (CTString (0 , "  %s:\n%d" , TRANS  ("TIME BONUS") , m_iTimeScore ));
#line 1864 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += "\n";
#line 1865 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += "\n";
#line 1866 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 1869 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 1870 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += AlignString  (CTString (0 , "  %s:\n%d" , TRANS  ("SCORE") , m_psLevelStats  . ps_iScore ));
#line 1871 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += "\n";
#line 1872 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += AlignString  (CTString (0 , "  %s:\n%d/%d" , TRANS  ("KILLS") , m_psLevelStats  . ps_iKills  , m_psLevelTotal  . ps_iKills ));
#line 1873 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += "\n";
#line 1874 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(iCoopType  >= 1){
#line 1875 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += AlignString  (CTString (0 , "  %s:\n%d" , TRANS  ("DEATHS") , m_psLevelStats  . ps_iDeaths  , m_psLevelTotal  . ps_iDeaths ));
#line 1876 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += "\n";
#line 1877 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 1878 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += AlignString  (CTString (0 , "  %s:\n%d/%d" , TRANS  ("SECRETS") , m_psLevelStats  . ps_iSecrets  , m_psLevelTotal  . ps_iSecrets ));
#line 1879 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += "\n";
#line 1880 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(iCoopType  <= 1){
#line 1881 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += AlignString  (CTString (0 , "  %s:\n%s" , TRANS  ("TIME") , TimeToString  (GetStatsInGameTimeLevel  ())));
#line 1882 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += "\n";
#line 1883 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 1884 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += "\n";
#line 1887 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += CTString ("^cFFFFFF") + TRANS  ("TOTAL") + "^r";
#line 1888 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += "\n";
#line 1889 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += AlignString  (CTString (0 , "  %s:\n%d" , TRANS  ("SCORE") , m_psGameStats  . ps_iScore ));
#line 1890 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += "\n";
#line 1891 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += AlignString  (CTString (0 , "  %s:\n%d/%d" , TRANS  ("KILLS") , m_psGameStats  . ps_iKills  , m_psGameTotal  . ps_iKills ));
#line 1892 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += "\n";
#line 1893 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(iCoopType  >= 1){
#line 1894 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += AlignString  (CTString (0 , "  %s:\n%d" , TRANS  ("DEATHS") , m_psGameStats  . ps_iDeaths  , m_psGameTotal  . ps_iDeaths ));
#line 1895 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += "\n";
#line 1896 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 1897 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += AlignString  (CTString (0 , "  %s:\n%d/%d" , TRANS  ("SECRETS") , m_psGameStats  . ps_iSecrets  , m_psGameTotal  . ps_iSecrets ));
#line 1898 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += "\n";
#line 1899 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(iCoopType  <= 1){
#line 1900 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += AlignString  (CTString (0 , "  %s:\n%s" , TRANS  ("GAME TIME") , TimeToString  (GetStatsInGameTimeGame  ())));
#line 1901 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += "\n";
#line 1902 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 1903 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += "\n";
#line 1906 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(iCoopType  < 1){
#line 1907 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_strLevelStats  != ""){
#line 1908 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  += CTString ("^cFFFFFF") + TRANS  ("Per level statistics") + "^r\n\n" + m_strLevelStats ;
#line 1909 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 1910 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 1911 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 1914 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::GetGameSpyPlayerInfo(INDEX iPlayer,CTString & strOut) 
#line 1915 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 1916 "C:/MyMod/Sources/EntitiesMP/Player.es"
CTString strKey ;
#line 1917 "C:/MyMod/Sources/EntitiesMP/Player.es"
strKey  . PrintF  ("\\player_%d\\%s" , iPlayer  , (const char  *) GetPlayerName  ());
#line 1918 "C:/MyMod/Sources/EntitiesMP/Player.es"
strOut  += strKey ;
#line 1919 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(GetSP  () -> sp_bUseFrags ){
#line 1920 "C:/MyMod/Sources/EntitiesMP/Player.es"
strKey  . PrintF  ("\\frags_%d\\%d" , iPlayer  , m_psLevelStats  . ps_iKills );
#line 1921 "C:/MyMod/Sources/EntitiesMP/Player.es"
strOut  += strKey ;
#line 1922 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 1923 "C:/MyMod/Sources/EntitiesMP/Player.es"
strKey  . PrintF  ("\\frags_%d\\%d" , iPlayer  , m_psLevelStats  . ps_iScore );
#line 1924 "C:/MyMod/Sources/EntitiesMP/Player.es"
strOut  += strKey ;
#line 1925 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 1926 "C:/MyMod/Sources/EntitiesMP/Player.es"
strKey  . PrintF  ("\\ping_%d\\%d" , iPlayer  , INDEX (ceil  (en_tmPing  * 1000.0f)));
#line 1927 "C:/MyMod/Sources/EntitiesMP/Player.es"
strOut  += strKey ;
#line 1928 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 1931 "C:/MyMod/Sources/EntitiesMP/Player.es"
BOOL CPlayer::HasMessage(const CTFileName & fnmMessage) 
#line 1932 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 1933 "C:/MyMod/Sources/EntitiesMP/Player.es"
ULONG  ulHash  = fnmMessage  . GetHash  ();
#line 1934 "C:/MyMod/Sources/EntitiesMP/Player.es"
INDEX ctMsg  = m_acmiMessages  . Count  ();
#line 1935 "C:/MyMod/Sources/EntitiesMP/Player.es"
for(INDEX iMsg  = 0;iMsg  < ctMsg ;iMsg  ++){
#line 1936 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_acmiMessages  [ iMsg  ] . cmi_ulHash  == ulHash  && 
#line 1937 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_acmiMessages  [ iMsg  ] . cmi_fnmFileName  == fnmMessage ){
#line 1938 "C:/MyMod/Sources/EntitiesMP/Player.es"
return TRUE ;
#line 1939 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 1940 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 1941 "C:/MyMod/Sources/EntitiesMP/Player.es"
return FALSE ;
#line 1942 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 1945 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::ReceiveComputerMessage(const CTFileName & fnmMessage,ULONG ulFlags) 
#line 1946 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 1948 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(HasMessage  (fnmMessage )){
#line 1950 "C:/MyMod/Sources/EntitiesMP/Player.es"
return ;
#line 1951 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 1953 "C:/MyMod/Sources/EntitiesMP/Player.es"
CCompMessageID  & cmi  = m_acmiMessages  . Push  ();
#line 1954 "C:/MyMod/Sources/EntitiesMP/Player.es"
cmi  . NewMessage  (fnmMessage );
#line 1955 "C:/MyMod/Sources/EntitiesMP/Player.es"
cmi  . cmi_bRead  = ulFlags  & CMF_READ ;
#line 1956 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(! (ulFlags  & CMF_READ )){
#line 1957 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_ctUnreadMessages  ++;
#line 1958 "C:/MyMod/Sources/EntitiesMP/Player.es"
cmp_bUpdateInBackground  = TRUE ;
#line 1959 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 1960 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(! (ulFlags  & CMF_READ ) && (ulFlags  & CMF_ANALYZE )){
#line 1961 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_tmAnalyseEnd  = _pTimer  -> CurrentTick  () + 2.0f;
#line 1962 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_soMessage  . Set3DParameters  (25.0f , 5.0f , 1.0f , 1.0f);
#line 1963 "C:/MyMod/Sources/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , SOUND_INFO  , SOF_3D  | SOF_VOLUMETRIC  | SOF_LOCAL );
#line 1964 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 1965 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 1967 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::SayVoiceMessage(const CTFileName & fnmMessage) 
#line 1968 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 1969 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(GetSettings  () -> ps_ulFlags  & PSF_NOQUOTES ){
#line 1970 "C:/MyMod/Sources/EntitiesMP/Player.es"
return ;
#line 1971 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 1972 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetSpeakMouthPitch  ();
#line 1973 "C:/MyMod/Sources/EntitiesMP/Player.es"
PlaySound  (m_soSpeech  , fnmMessage  , SOF_3D  | SOF_VOLUMETRIC );
#line 1974 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 1977 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::CheatAllMessagesDir(const CTString & strDir,ULONG ulFlags) 
#line 1978 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 1980 "C:/MyMod/Sources/EntitiesMP/Player.es"
CDynamicStackArray  < CTFileName > afnmDir ;
#line 1981 "C:/MyMod/Sources/EntitiesMP/Player.es"
MakeDirList  (afnmDir  , strDir  , "*.txt" , DLI_RECURSIVE );
#line 1984 "C:/MyMod/Sources/EntitiesMP/Player.es"
for(INDEX i  = 0;i  < afnmDir  . Count  ();i  ++){
#line 1985 "C:/MyMod/Sources/EntitiesMP/Player.es"
CTFileName fnm  = afnmDir  [ i  ];
#line 1987 "C:/MyMod/Sources/EntitiesMP/Player.es"
ReceiveComputerMessage  (fnm  , ulFlags );
#line 1988 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 1989 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 1992 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::CheatAllMessages(void) 
#line 1993 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 1997 "C:/MyMod/Sources/EntitiesMP/Player.es"
CheatAllMessagesDir  ("Data\\Messages\\weapons\\" , 0);
#line 1998 "C:/MyMod/Sources/EntitiesMP/Player.es"
CheatAllMessagesDir  ("Data\\Messages\\enemies\\" , 0);
#line 1999 "C:/MyMod/Sources/EntitiesMP/Player.es"
CheatAllMessagesDir  ("DataMP\\Messages\\enemies\\" , 0);
#line 2000 "C:/MyMod/Sources/EntitiesMP/Player.es"
CheatAllMessagesDir  ("DataMP\\Messages\\information\\" , 0);
#line 2001 "C:/MyMod/Sources/EntitiesMP/Player.es"
CheatAllMessagesDir  ("DataMP\\Messages\\statistics\\" , 0);
#line 2002 "C:/MyMod/Sources/EntitiesMP/Player.es"
CheatAllMessagesDir  ("DataMP\\Messages\\weapons\\" , 0);
#line 2003 "C:/MyMod/Sources/EntitiesMP/Player.es"
CheatAllMessagesDir  ("DataMP\\Messages\\background\\" , 0);
#line 2004 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 2007 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::ItemPicked(const CTString & strName,FLOAT fAmmount) 
#line 2008 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 2010 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(_pTimer  -> CurrentTick  () > m_tmLastPicked  + PICKEDREPORT_TIME ){
#line 2012 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_strPickedName  = "";
#line 2014 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_fPickedMana  = 0;
#line 2015 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2017 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_strPickedName  != strName ){
#line 2019 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_strPickedName  = strName ;
#line 2021 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_fPickedAmmount  = 0;
#line 2022 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2024 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_fPickedAmmount  += fAmmount ;
#line 2025 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_tmLastPicked  = _pTimer  -> CurrentTick  ();
#line 2026 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 2029 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::SetupLightSource(void) 
#line 2030 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 2032 "C:/MyMod/Sources/EntitiesMP/Player.es"
CLightSource  lsNew ;
#line 2033 "C:/MyMod/Sources/EntitiesMP/Player.es"
lsNew  . ls_ulFlags  = LSF_NONPERSISTENT  | LSF_DYNAMIC ;
#line 2034 "C:/MyMod/Sources/EntitiesMP/Player.es"
lsNew  . ls_rHotSpot  = 1.0f;
#line 2035 "C:/MyMod/Sources/EntitiesMP/Player.es"
lsNew  . ls_colColor  = C_WHITE ;
#line 2036 "C:/MyMod/Sources/EntitiesMP/Player.es"
lsNew  . ls_rFallOff  = 2.5f;
#line 2037 "C:/MyMod/Sources/EntitiesMP/Player.es"
lsNew  . ls_plftLensFlare  = NULL ;
#line 2038 "C:/MyMod/Sources/EntitiesMP/Player.es"
lsNew  . ls_ubPolygonalMask  = 0;
#line 2039 "C:/MyMod/Sources/EntitiesMP/Player.es"
lsNew  . ls_paoLightAnimation  = & m_aoLightAnimation ;
#line 2041 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_lsLightSource  . ls_penEntity  = this ;
#line 2042 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_lsLightSource  . SetLightSource  (lsNew );
#line 2043 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 2046 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::PlayLightAnim(INDEX iAnim,ULONG ulFlags) {
#line 2047 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_aoLightAnimation  . GetData  () != NULL ){
#line 2048 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_aoLightAnimation  . PlayAnim  (iAnim  , ulFlags );
#line 2049 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2050 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 2053 "C:/MyMod/Sources/EntitiesMP/Player.es"
BOOL CPlayer::AdjustShadingParameters(FLOAT3D & vLightDirection,COLOR & colLight,COLOR & colAmbient) 
#line 2054 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 2055 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(cht_bDumpPlayerShading )
#line 2056 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 2057 "C:/MyMod/Sources/EntitiesMP/Player.es"
ANGLE3D a3dHPB ;
#line 2058 "C:/MyMod/Sources/EntitiesMP/Player.es"
DirectionVectorToAngles  (- vLightDirection  , a3dHPB );
#line 2059 "C:/MyMod/Sources/EntitiesMP/Player.es"
UBYTE  ubAR  , ubAG  , ubAB ;
#line 2060 "C:/MyMod/Sources/EntitiesMP/Player.es"
UBYTE  ubCR  , ubCG  , ubCB ;
#line 2061 "C:/MyMod/Sources/EntitiesMP/Player.es"
ColorToRGB  (colAmbient  , ubAR  , ubAG  , ubAB );
#line 2062 "C:/MyMod/Sources/EntitiesMP/Player.es"
ColorToRGB  (colLight  , ubCR  , ubCG  , ubCB );
#line 2063 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPrintF  ("Ambient: %d,%d,%d, Color: %d,%d,%d, Direction HPB (%g,%g,%g)\n" , 
#line 2064 "C:/MyMod/Sources/EntitiesMP/Player.es"
ubAR  , ubAG  , ubAB  , ubCR  , ubCG  , ubCB  , a3dHPB  (1) , a3dHPB  (2) , a3dHPB  (3));
#line 2065 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2068 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(! GetSP  () -> sp_bCooperative ){
#line 2069 "C:/MyMod/Sources/EntitiesMP/Player.es"
UBYTE  ubH  , ubS  , ubV ;
#line 2070 "C:/MyMod/Sources/EntitiesMP/Player.es"
ColorToHSV  (colAmbient  , ubH  , ubS  , ubV );
#line 2071 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(ubV  < 22){
#line 2072 "C:/MyMod/Sources/EntitiesMP/Player.es"
ubV  = 22;
#line 2073 "C:/MyMod/Sources/EntitiesMP/Player.es"
colAmbient  = HSVToColor  (ubH  , ubS  , ubV );
#line 2074 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2075 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2077 "C:/MyMod/Sources/EntitiesMP/Player.es"
return CPlayerEntity  :: AdjustShadingParameters  (vLightDirection  , colLight  , colAmbient );
#line 2078 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 2081 "C:/MyMod/Sources/EntitiesMP/Player.es"
CModelObject * CPlayer::GetModelForRendering(void) 
#line 2082 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 2084 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(! (m_ulFlags  & PLF_INITIALIZED )){
#line 2086 "C:/MyMod/Sources/EntitiesMP/Player.es"
return GetModelObject  ();
#line 2087 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2090 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlacement3D plView ;
#line 2091 "C:/MyMod/Sources/EntitiesMP/Player.es"
plView  . Lerp  (en_plLastViewpoint  , en_plViewpoint  , _pTimer  -> GetLerpFactor  ());
#line 2093 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerAnimator  &) * m_penAnimator ) . BodyAndHeadOrientation  (plView );
#line 2094 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerAnimator  &) * m_penAnimator ) . OnPreRender  ();
#line 2096 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_moRender  . Synchronize  (* GetModelObject  ());
#line 2097 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_ulFlags  & PLF_SYNCWEAPON ){
#line 2098 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_ulFlags  &= ~ PLF_SYNCWEAPON ;
#line 2099 "C:/MyMod/Sources/EntitiesMP/Player.es"
GetPlayerAnimator  () -> SyncWeapon  ();
#line 2100 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2102 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT tmNow  = _pTimer  -> GetLerpedCurrentTick  ();
#line 2104 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fFading  = 1.0f;
#line 2105 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_tmFadeStart  != 0){
#line 2106 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fFactor  = (tmNow  - m_tmFadeStart ) / 5.0f;
#line 2107 "C:/MyMod/Sources/EntitiesMP/Player.es"
fFactor  = Clamp  (fFactor  , 0.0f , 1.0f);
#line 2108 "C:/MyMod/Sources/EntitiesMP/Player.es"
fFading  *= fFactor ;
#line 2109 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2112 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT tmSpawnInvulnerability  = GetSP  () -> sp_tmSpawnInvulnerability ;
#line 2113 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(tmSpawnInvulnerability  > 0 && tmNow  - m_tmSpawned  < tmSpawnInvulnerability ){
#line 2115 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fDelta  = tmNow  - m_tmSpawned ;
#line 2116 "C:/MyMod/Sources/EntitiesMP/Player.es"
fFading  *= 0.75f + 0.25f * Sin  (fDelta  / 0.5f * 360);
#line 2117 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2119 "C:/MyMod/Sources/EntitiesMP/Player.es"
COLOR colAlpha  = m_moRender  . mo_colBlendColor ;
#line 2120 "C:/MyMod/Sources/EntitiesMP/Player.es"
colAlpha  = (colAlpha  & 0xffffff00) + (COLOR (fFading  * 0xff) & 0xff);
#line 2121 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_moRender  . mo_colBlendColor  = colAlpha ;
#line 2124 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_ulFlags  & PLF_NOTCONNECTED ){
#line 2126 "C:/MyMod/Sources/EntitiesMP/Player.es"
fFading  *= 0.25f + 0.25f * Sin  (tmNow  / 2.0f * 360);
#line 2128 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else if(m_tmInvisibility  > tmNow ){
#line 2129 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fIntensity  = 0.0f;
#line 2130 "C:/MyMod/Sources/EntitiesMP/Player.es"
if((m_tmInvisibility  - tmNow ) < 3.0f)
#line 2131 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 2132 "C:/MyMod/Sources/EntitiesMP/Player.es"
fIntensity  = 0.5f - 0.5f * cos  ((m_tmInvisibility  - tmNow ) * (6.0f * 3.1415927f / 3.0f));
#line 2133 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2134 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(_ulPlayerRenderingMask  == 1 << GetMyPlayerIndex  ()){
#line 2135 "C:/MyMod/Sources/EntitiesMP/Player.es"
colAlpha  = (colAlpha  & 0xffffff00) | (INDEX) (INVISIBILITY_ALPHA_LOCAL  + (FLOAT) (254 - INVISIBILITY_ALPHA_LOCAL ) * fIntensity );
#line 2136 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else if(TRUE ){
#line 2137 "C:/MyMod/Sources/EntitiesMP/Player.es"
if((m_tmInvisibility  - tmNow ) < 1.28f){
#line 2138 "C:/MyMod/Sources/EntitiesMP/Player.es"
colAlpha  = (colAlpha  & 0xffffff00) | (INDEX) (INVISIBILITY_ALPHA_REMOTE  + (FLOAT) (254 - INVISIBILITY_ALPHA_REMOTE ) * fIntensity );
#line 2139 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else if(TRUE ){
#line 2140 "C:/MyMod/Sources/EntitiesMP/Player.es"
colAlpha  = (colAlpha  & 0xffffff00) | INVISIBILITY_ALPHA_REMOTE ;
#line 2141 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2142 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2143 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_moRender  . mo_colBlendColor  = colAlpha ;
#line 2144 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2147 "C:/MyMod/Sources/EntitiesMP/Player.es"
return & m_moRender ;
#line 2148 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 2151 "C:/MyMod/Sources/EntitiesMP/Player.es"
class CPlayerActionMarker * CPlayer::GetActionMarker(void) {
#line 2152 "C:/MyMod/Sources/EntitiesMP/Player.es"
return (CPlayerActionMarker  *) & * m_penActionMarker ;
#line 2153 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 2156 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::FindMusicHolder(void) 
#line 2157 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 2158 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_penMainMusicHolder  == NULL ){
#line 2159 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_penMainMusicHolder  = _pNetwork  -> GetEntityWithName  ("MusicHolder" , 0);
#line 2160 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2161 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 2164 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::UpdateLevelStats(void) 
#line 2165 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 2167 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_psLevelStats  = PlayerStats  ();
#line 2170 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_penMainMusicHolder  == NULL ){
#line 2171 "C:/MyMod/Sources/EntitiesMP/Player.es"
return ;
#line 2172 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2173 "C:/MyMod/Sources/EntitiesMP/Player.es"
CMusicHolder  & mh  = (CMusicHolder  &) * m_penMainMusicHolder ;
#line 2176 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(mh  . m_ctEnemiesInWorld  == 0){
#line 2177 "C:/MyMod/Sources/EntitiesMP/Player.es"
mh  . CountEnemies  ();
#line 2178 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2180 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_psLevelTotal  . ps_iKills  = mh  . m_ctEnemiesInWorld ;
#line 2181 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_psGameTotal  . ps_iKills  += mh  . m_ctEnemiesInWorld ;
#line 2182 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_psLevelTotal  . ps_iSecrets  = mh  . m_ctSecretsInWorld ;
#line 2183 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_psGameTotal  . ps_iSecrets  += mh  . m_ctSecretsInWorld ;
#line 2184 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 2187 "C:/MyMod/Sources/EntitiesMP/Player.es"
BOOL CPlayer::IsFuss(void) 
#line 2188 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 2190 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_penMainMusicHolder  == NULL ){
#line 2192 "C:/MyMod/Sources/EntitiesMP/Player.es"
return FALSE ;
#line 2193 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2195 "C:/MyMod/Sources/EntitiesMP/Player.es"
return ((CMusicHolder  *) & * m_penMainMusicHolder ) -> m_cenFussMakers  . Count  () > 0;
#line 2196 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 2198 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::SetDefaultMouthPitch(void) 
#line 2199 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 2200 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_soMouth  . Set3DParameters  (50.0f , 10.0f , 1.0f , 1.0f);
#line 2201 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 2202 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::SetRandomMouthPitch(FLOAT fMin,FLOAT fMax) 
#line 2203 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 2204 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_soMouth  . Set3DParameters  (50.0f , 10.0f , 1.0f , Lerp  (fMin  , fMax  , FRnd  ()));
#line 2205 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 2206 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::SetSpeakMouthPitch(void) 
#line 2207 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 2208 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_soSpeech  . Set3DParameters  (50.0f , 10.0f , 2.0f , 1.0f);
#line 2209 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 2212 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::ApplyShaking(CPlacement3D & plViewer) 
#line 2213 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 2215 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fT  = _pTimer  -> GetLerpedCurrentTick  ();
#line 2216 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(fT  < m_tmChainShakeEnd )
#line 2217 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 2218 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_fChainsawShakeDX  = 0.03f * m_fChainShakeStrength  * SinFast  (fT  * m_fChainShakeFreqMod  * 3300.0f);
#line 2219 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_fChainsawShakeDY  = 0.03f * m_fChainShakeStrength  * SinFast  (fT  * m_fChainShakeFreqMod  * 2900.0f);
#line 2221 "C:/MyMod/Sources/EntitiesMP/Player.es"
plViewer  . pl_PositionVector  (1) += m_fChainsawShakeDX ;
#line 2222 "C:/MyMod/Sources/EntitiesMP/Player.es"
plViewer  . pl_PositionVector  (3) += m_fChainsawShakeDY ;
#line 2223 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2225 "C:/MyMod/Sources/EntitiesMP/Player.es"
CWorldSettingsController  * pwsc  = GetWSC  (this );
#line 2226 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(pwsc  == NULL  || pwsc  -> m_tmShakeStarted  < 0){
#line 2227 "C:/MyMod/Sources/EntitiesMP/Player.es"
return ;
#line 2228 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2230 "C:/MyMod/Sources/EntitiesMP/Player.es"
TIME  tm  = _pTimer  -> GetLerpedCurrentTick  () - pwsc  -> m_tmShakeStarted ;
#line 2231 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(tm  < 0){
#line 2232 "C:/MyMod/Sources/EntitiesMP/Player.es"
return ;
#line 2233 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2234 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fDistance  = (plViewer  . pl_PositionVector  - pwsc  -> m_vShakePos ) . Length  ();
#line 2235 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fIntensity  = IntensityAtDistance  (pwsc  -> m_fShakeFalloff  , 0 , fDistance );
#line 2236 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fShakeY  , fShakeB  , fShakeZ ;
#line 2237 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(! pwsc  -> m_bShakeFadeIn ){
#line 2238 "C:/MyMod/Sources/EntitiesMP/Player.es"
fShakeY  = SinFast  (tm  * pwsc  -> m_tmShakeFrequencyY  * 360.0f) * 
#line 2239 "C:/MyMod/Sources/EntitiesMP/Player.es"
exp  (- tm  * (pwsc  -> m_fShakeFade )) * 
#line 2240 "C:/MyMod/Sources/EntitiesMP/Player.es"
fIntensity  * pwsc  -> m_fShakeIntensityY ;
#line 2241 "C:/MyMod/Sources/EntitiesMP/Player.es"
fShakeB  = SinFast  (tm  * pwsc  -> m_tmShakeFrequencyB  * 360.0f) * 
#line 2242 "C:/MyMod/Sources/EntitiesMP/Player.es"
exp  (- tm  * (pwsc  -> m_fShakeFade )) * 
#line 2243 "C:/MyMod/Sources/EntitiesMP/Player.es"
fIntensity  * pwsc  -> m_fShakeIntensityB ;
#line 2244 "C:/MyMod/Sources/EntitiesMP/Player.es"
fShakeZ  = SinFast  (tm  * pwsc  -> m_tmShakeFrequencyZ  * 360.0f) * 
#line 2245 "C:/MyMod/Sources/EntitiesMP/Player.es"
exp  (- tm  * (pwsc  -> m_fShakeFade )) * 
#line 2246 "C:/MyMod/Sources/EntitiesMP/Player.es"
fIntensity  * pwsc  -> m_fShakeIntensityZ ;
#line 2247 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 2248 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT ootm  = 1.0f / tm ;
#line 2249 "C:/MyMod/Sources/EntitiesMP/Player.es"
fShakeY  = SinFast  (tm  * pwsc  -> m_tmShakeFrequencyY  * 360.0f) * 
#line 2250 "C:/MyMod/Sources/EntitiesMP/Player.es"
exp  ((tm  - 2) * ootm  * (pwsc  -> m_fShakeFade )) * 
#line 2251 "C:/MyMod/Sources/EntitiesMP/Player.es"
fIntensity  * pwsc  -> m_fShakeIntensityY ;
#line 2252 "C:/MyMod/Sources/EntitiesMP/Player.es"
fShakeB  = SinFast  (tm  * pwsc  -> m_tmShakeFrequencyB  * 360.0f) * 
#line 2253 "C:/MyMod/Sources/EntitiesMP/Player.es"
exp  ((tm  - 2) * ootm  * (pwsc  -> m_fShakeFade )) * 
#line 2254 "C:/MyMod/Sources/EntitiesMP/Player.es"
fIntensity  * pwsc  -> m_fShakeIntensityB ;
#line 2255 "C:/MyMod/Sources/EntitiesMP/Player.es"
fShakeZ  = SinFast  (tm  * pwsc  -> m_tmShakeFrequencyZ  * 360.0f) * 
#line 2256 "C:/MyMod/Sources/EntitiesMP/Player.es"
exp  ((tm  - 2) * ootm  * (pwsc  -> m_fShakeFade )) * 
#line 2257 "C:/MyMod/Sources/EntitiesMP/Player.es"
fIntensity  * pwsc  -> m_fShakeIntensityZ ;
#line 2258 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2259 "C:/MyMod/Sources/EntitiesMP/Player.es"
plViewer  . pl_PositionVector  (2) += fShakeY ;
#line 2260 "C:/MyMod/Sources/EntitiesMP/Player.es"
plViewer  . pl_PositionVector  (3) += fShakeZ ;
#line 2261 "C:/MyMod/Sources/EntitiesMP/Player.es"
plViewer  . pl_OrientationAngle  (3) += fShakeB ;
#line 2263 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 2265 "C:/MyMod/Sources/EntitiesMP/Player.es"
COLOR CPlayer::GetWorldGlaring(void) 
#line 2266 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 2267 "C:/MyMod/Sources/EntitiesMP/Player.es"
CWorldSettingsController  * pwsc  = GetWSC  (this );
#line 2268 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(pwsc  == NULL  || pwsc  -> m_tmGlaringStarted  < 0){
#line 2269 "C:/MyMod/Sources/EntitiesMP/Player.es"
return 0;
#line 2270 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2271 "C:/MyMod/Sources/EntitiesMP/Player.es"
TIME  tm  = _pTimer  -> GetLerpedCurrentTick  ();
#line 2272 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fRatio  = CalculateRatio  (tm  , pwsc  -> m_tmGlaringStarted  , pwsc  -> m_tmGlaringEnded  , 
#line 2273 "C:/MyMod/Sources/EntitiesMP/Player.es"
pwsc  -> m_fGlaringFadeInRatio  , pwsc  -> m_fGlaringFadeOutRatio );
#line 2274 "C:/MyMod/Sources/EntitiesMP/Player.es"
COLOR colResult  = (pwsc  -> m_colGlade  & 0xFFFFFF00) | (UBYTE  (fRatio  * 255.0f));
#line 2275 "C:/MyMod/Sources/EntitiesMP/Player.es"
return colResult ;
#line 2276 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 2278 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::RenderScroll(CDrawPort * pdp) 
#line 2279 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 2280 "C:/MyMod/Sources/EntitiesMP/Player.es"
CWorldSettingsController  * pwsc  = GetWSC  (this );
#line 2281 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(pwsc  != NULL  && pwsc  -> m_penScrollHolder  != NULL )
#line 2282 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 2283 "C:/MyMod/Sources/EntitiesMP/Player.es"
CScrollHolder  & sch  = (CScrollHolder  &) * pwsc  -> m_penScrollHolder ;
#line 2284 "C:/MyMod/Sources/EntitiesMP/Player.es"
sch  . Credits_Render  (& sch  , pdp );
#line 2285 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2286 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 2288 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::RenderCredits(CDrawPort * pdp) 
#line 2289 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 2290 "C:/MyMod/Sources/EntitiesMP/Player.es"
CWorldSettingsController  * pwsc  = GetWSC  (this );
#line 2291 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(pwsc  != NULL  && pwsc  -> m_penCreditsHolder  != NULL )
#line 2292 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 2293 "C:/MyMod/Sources/EntitiesMP/Player.es"
CCreditsHolder  & cch  = (CCreditsHolder  &) * pwsc  -> m_penCreditsHolder ;
#line 2294 "C:/MyMod/Sources/EntitiesMP/Player.es"
cch  . Credits_Render  (& cch  , pdp );
#line 2295 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2296 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 2298 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::RenderTextFX(CDrawPort * pdp) 
#line 2299 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 2300 "C:/MyMod/Sources/EntitiesMP/Player.es"
CWorldSettingsController  * pwsc  = GetWSC  (this );
#line 2301 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(pwsc  != NULL  && pwsc  -> m_penTextFXHolder  != NULL )
#line 2302 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 2303 "C:/MyMod/Sources/EntitiesMP/Player.es"
CTextFXHolder  & tfx  = (CTextFXHolder  &) * pwsc  -> m_penTextFXHolder ;
#line 2304 "C:/MyMod/Sources/EntitiesMP/Player.es"
tfx  . TextFX_Render  (& tfx  , pdp );
#line 2305 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2306 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 2308 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::RenderHudPicFX(CDrawPort * pdp) 
#line 2309 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 2310 "C:/MyMod/Sources/EntitiesMP/Player.es"
CWorldSettingsController  * pwsc  = GetWSC  (this );
#line 2311 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(pwsc  != NULL  && pwsc  -> m_penHudPicFXHolder  != NULL )
#line 2312 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 2313 "C:/MyMod/Sources/EntitiesMP/Player.es"
CHudPicHolder  & hpfx  = (CHudPicHolder  &) * pwsc  -> m_penHudPicFXHolder ;
#line 2314 "C:/MyMod/Sources/EntitiesMP/Player.es"
hpfx  . HudPic_Render  (& hpfx  , pdp );
#line 2315 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2316 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 2323 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::SetupView(CDrawPort * pdp,CAnyProjection3D & apr,CEntity * & penViewer,
#line 2324 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlacement3D & plViewer,COLOR & colBlend,BOOL bCamera) 
#line 2325 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 2327 "C:/MyMod/Sources/EntitiesMP/Player.es"
GetLerpedAbsoluteViewPlacement  (plViewer );
#line 2328 "C:/MyMod/Sources/EntitiesMP/Player.es"
ASSERT  (IsValidFloat  (plViewer  . pl_OrientationAngle  (1)) && IsValidFloat  (plViewer  . pl_OrientationAngle  (2)) && IsValidFloat  (plViewer  . pl_OrientationAngle  (3)));
#line 2330 "C:/MyMod/Sources/EntitiesMP/Player.es"
penViewer  = GetViewEntity  ();
#line 2332 "C:/MyMod/Sources/EntitiesMP/Player.es"
INDEX iViewState  = m_iViewState ;
#line 2334 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_penCamera  != NULL  && bCamera ){
#line 2335 "C:/MyMod/Sources/EntitiesMP/Player.es"
iViewState  = PVT_SCENECAMERA ;
#line 2336 "C:/MyMod/Sources/EntitiesMP/Player.es"
plViewer  = m_penCamera  -> GetLerpedPlacement  ();
#line 2337 "C:/MyMod/Sources/EntitiesMP/Player.es"
penViewer  = m_penCamera ;
#line 2338 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2341 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPerspectiveProjection3D  prPerspectiveProjection ;
#line 2342 "C:/MyMod/Sources/EntitiesMP/Player.es"
plr_fFOV  = Clamp  (plr_fFOV  , 1.0f , 160.0f);
#line 2343 "C:/MyMod/Sources/EntitiesMP/Player.es"
ANGLE aFOV  = plr_fFOV ;
#line 2345 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(! GetSP  () -> sp_bCooperative ){
#line 2346 "C:/MyMod/Sources/EntitiesMP/Player.es"
aFOV  = 140.0f;
#line 2347 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2349 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(((CPlayerWeapons  &) * m_penWeapons ) . m_iCurrentWeapon  == WEAPON_SNIPER )
#line 2350 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 2351 "C:/MyMod/Sources/EntitiesMP/Player.es"
aFOV  = Lerp  (((CPlayerWeapons  &) * m_penWeapons ) . m_fSniperFOVlast  , 
#line 2352 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerWeapons  &) * m_penWeapons ) . m_fSniperFOV  , 
#line 2353 "C:/MyMod/Sources/EntitiesMP/Player.es"
_pTimer  -> GetLerpFactor  ());
#line 2354 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2356 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_pstState  == PST_DIVE  && iViewState  == PVT_PLAYEREYES ){
#line 2357 "C:/MyMod/Sources/EntitiesMP/Player.es"
TIME  tmNow  = _pTimer  -> GetLerpedCurrentTick  ();
#line 2358 "C:/MyMod/Sources/EntitiesMP/Player.es"
aFOV  += sin  (tmNow  * 0.79f) * 2.0f;
#line 2359 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2360 "C:/MyMod/Sources/EntitiesMP/Player.es"
ApplyShaking  (plViewer );
#line 2362 "C:/MyMod/Sources/EntitiesMP/Player.es"
colBlend  = 0;
#line 2363 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(iViewState  == PVT_SCENECAMERA ){
#line 2364 "C:/MyMod/Sources/EntitiesMP/Player.es"
CCamera  * pcm  = (CCamera  *) & * m_penCamera ;
#line 2365 "C:/MyMod/Sources/EntitiesMP/Player.es"
prPerspectiveProjection  . FOVL  () = 
#line 2366 "C:/MyMod/Sources/EntitiesMP/Player.es"
Lerp  (pcm  -> m_fLastFOV  , pcm  -> m_fFOV  , _pTimer  -> GetLerpFactor  ());
#line 2367 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(pcm  -> m_tmDelta  > 0.001f){
#line 2368 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fFactor  = (_pTimer  -> GetLerpedCurrentTick  () - pcm  -> m_tmAtMarker ) / pcm  -> m_tmDelta ;
#line 2369 "C:/MyMod/Sources/EntitiesMP/Player.es"
fFactor  = Clamp  (fFactor  , 0.0f , 1.0f);
#line 2370 "C:/MyMod/Sources/EntitiesMP/Player.es"
colBlend  = LerpColor  (pcm  -> m_colFade0  , pcm  -> m_colFade1  , fFactor );
#line 2371 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 2372 "C:/MyMod/Sources/EntitiesMP/Player.es"
colBlend  = pcm  -> m_colFade0 ;
#line 2373 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2374 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 2375 "C:/MyMod/Sources/EntitiesMP/Player.es"
prPerspectiveProjection  . FOVL  () = aFOV ;
#line 2376 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2377 "C:/MyMod/Sources/EntitiesMP/Player.es"
prPerspectiveProjection  . ScreenBBoxL  () = FLOATaabbox2D  (
#line 2378 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT2D  (0.0f , 0.0f) , 
#line 2379 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT2D  ((FLOAT) pdp  -> GetWidth  () , (FLOAT) pdp  -> GetHeight  ())
#line 2380 "C:/MyMod/Sources/EntitiesMP/Player.es"
);
#line 2382 "C:/MyMod/Sources/EntitiesMP/Player.es"
plr_fFrontClipDistance  = Clamp  (plr_fFrontClipDistance  , 0.05f , 0.50f);
#line 2383 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fFCD  = plr_fFrontClipDistance ;
#line 2385 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_pstState  == PST_SWIM  && iViewState  == PVT_PLAYEREYES ){fFCD  *= 0.6666f;}
#line 2386 "C:/MyMod/Sources/EntitiesMP/Player.es"
prPerspectiveProjection  . FrontClipDistanceL  () = fFCD ;
#line 2387 "C:/MyMod/Sources/EntitiesMP/Player.es"
prPerspectiveProjection  . AspectRatioL  () = 1.0f;
#line 2389 "C:/MyMod/Sources/EntitiesMP/Player.es"
apr  = prPerspectiveProjection ;
#line 2390 "C:/MyMod/Sources/EntitiesMP/Player.es"
apr  -> ViewerPlacementL  () = plViewer ;
#line 2391 "C:/MyMod/Sources/EntitiesMP/Player.es"
apr  -> ObjectPlacementL  () = CPlacement3D (FLOAT3D (0 , 0 , 0) , ANGLE3D (0 , 0 , 0));
#line 2392 "C:/MyMod/Sources/EntitiesMP/Player.es"
prPlayerProjection  = apr ;
#line 2393 "C:/MyMod/Sources/EntitiesMP/Player.es"
prPlayerProjection  -> Prepare  ();
#line 2394 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 2397 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::ListenFromEntity(CEntity * penListener,const CPlacement3D & plSound) 
#line 2398 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 2399 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOATmatrix3D mRotation ;
#line 2400 "C:/MyMod/Sources/EntitiesMP/Player.es"
MakeRotationMatrixFast  (mRotation  , plSound  . pl_OrientationAngle );
#line 2401 "C:/MyMod/Sources/EntitiesMP/Player.es"
sliSound  . sli_vPosition  = plSound  . pl_PositionVector ;
#line 2402 "C:/MyMod/Sources/EntitiesMP/Player.es"
sliSound  . sli_mRotation  = mRotation ;
#line 2403 "C:/MyMod/Sources/EntitiesMP/Player.es"
sliSound  . sli_fVolume  = 1.0f;
#line 2404 "C:/MyMod/Sources/EntitiesMP/Player.es"
sliSound  . sli_vSpeed  = en_vCurrentTranslationAbsolute ;
#line 2405 "C:/MyMod/Sources/EntitiesMP/Player.es"
sliSound  . sli_penEntity  = penListener ;
#line 2406 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_pstState  == PST_DIVE ){
#line 2407 "C:/MyMod/Sources/EntitiesMP/Player.es"
sliSound  . sli_fFilter  = 20.0f;
#line 2408 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 2409 "C:/MyMod/Sources/EntitiesMP/Player.es"
sliSound  . sli_fFilter  = 0.0f;
#line 2410 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2411 "C:/MyMod/Sources/EntitiesMP/Player.es"
INDEX iEnv  = 0;
#line 2413 "C:/MyMod/Sources/EntitiesMP/Player.es"
CBrushSector  * pbsc  = penListener  -> GetSectorFromPoint  (plSound  . pl_PositionVector );
#line 2416 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(pbsc  != NULL ){
#line 2417 "C:/MyMod/Sources/EntitiesMP/Player.es"
iEnv  = pbsc  -> GetEnvironmentType  ();
#line 2418 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2421 "C:/MyMod/Sources/EntitiesMP/Player.es"
CEnvironmentType  & et  = GetWorld  () -> wo_aetEnvironmentTypes  [ iEnv  ];
#line 2422 "C:/MyMod/Sources/EntitiesMP/Player.es"
sliSound  . sli_iEnvironmentType  = et  . et_iType ;
#line 2423 "C:/MyMod/Sources/EntitiesMP/Player.es"
sliSound  . sli_fEnvironmentSize  = et  . et_fSize ;
#line 2424 "C:/MyMod/Sources/EntitiesMP/Player.es"
_pSound  -> Listen  (sliSound );
#line 2425 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 2428 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::RenderDummyView(CDrawPort * pdp) 
#line 2429 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 2431 "C:/MyMod/Sources/EntitiesMP/Player.es"
pdp  -> Fill  (C_BLACK  | CT_OPAQUE );
#line 2434 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(! GetSP  () -> sp_bSinglePlayer ){
#line 2436 "C:/MyMod/Sources/EntitiesMP/Player.es"
PIX  pixDPWidth  = pdp  -> GetWidth  ();
#line 2437 "C:/MyMod/Sources/EntitiesMP/Player.es"
PIX  pixDPHeight  = pdp  -> GetHeight  ();
#line 2438 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fScale  = (FLOAT) pixDPWidth  / 640.0f;
#line 2439 "C:/MyMod/Sources/EntitiesMP/Player.es"
pdp  -> SetFont  (_pfdDisplayFont );
#line 2440 "C:/MyMod/Sources/EntitiesMP/Player.es"
pdp  -> SetTextScaling  (fScale );
#line 2441 "C:/MyMod/Sources/EntitiesMP/Player.es"
pdp  -> SetTextAspect  (1.0f);
#line 2442 "C:/MyMod/Sources/EntitiesMP/Player.es"
CTString strMsg ;
#line 2443 "C:/MyMod/Sources/EntitiesMP/Player.es"
strMsg  . PrintF  (TRANS  ("%s connected") , GetPlayerName  ());
#line 2444 "C:/MyMod/Sources/EntitiesMP/Player.es"
pdp  -> PutTextCXY  (strMsg  , pixDPWidth  * 0.5f , pixDPHeight  * 0.5f , SE_COL_BLUE_NEUTRAL_LT  | CT_OPAQUE );
#line 2445 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2446 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 2449 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::RenderPlayerView(CDrawPort * pdp,BOOL bShowExtras) 
#line 2450 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 2452 "C:/MyMod/Sources/EntitiesMP/Player.es"
CAnyProjection3D  apr ;
#line 2453 "C:/MyMod/Sources/EntitiesMP/Player.es"
CEntity  * penViewer ;
#line 2454 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlacement3D plViewer ;
#line 2455 "C:/MyMod/Sources/EntitiesMP/Player.es"
COLOR colBlend ;
#line 2458 "C:/MyMod/Sources/EntitiesMP/Player.es"
for(INDEX iEye  = STEREO_LEFT ;iEye  <= (Stereo_IsEnabled  () ? STEREO_RIGHT  : STEREO_LEFT );iEye  ++){
#line 2461 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetupView  (pdp  , apr  , penViewer  , plViewer  , colBlend  , FALSE );
#line 2464 "C:/MyMod/Sources/EntitiesMP/Player.es"
Stereo_SetBuffer  (iEye );
#line 2465 "C:/MyMod/Sources/EntitiesMP/Player.es"
Stereo_AdjustProjection  (* apr  , iEye  , 1);
#line 2468 "C:/MyMod/Sources/EntitiesMP/Player.es"
ASSERT  (IsValidFloat  (plViewer  . pl_OrientationAngle  (1)) && IsValidFloat  (plViewer  . pl_OrientationAngle  (2)) && IsValidFloat  (plViewer  . pl_OrientationAngle  (3)));
#line 2469 "C:/MyMod/Sources/EntitiesMP/Player.es"
_ulPlayerRenderingMask  = 1 << GetMyPlayerIndex  ();
#line 2470 "C:/MyMod/Sources/EntitiesMP/Player.es"
RenderView  (* en_pwoWorld  , * penViewer  , apr  , * pdp );
#line 2471 "C:/MyMod/Sources/EntitiesMP/Player.es"
_ulPlayerRenderingMask  = 0;
#line 2473 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(iEye  == STEREO_LEFT ){
#line 2475 "C:/MyMod/Sources/EntitiesMP/Player.es"
ListenFromEntity  (this  , plViewer );
#line 2476 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2478 "C:/MyMod/Sources/EntitiesMP/Player.es"
RenderScroll  (pdp );
#line 2479 "C:/MyMod/Sources/EntitiesMP/Player.es"
RenderTextFX  (pdp );
#line 2480 "C:/MyMod/Sources/EntitiesMP/Player.es"
RenderCredits  (pdp );
#line 2481 "C:/MyMod/Sources/EntitiesMP/Player.es"
RenderHudPicFX  (pdp );
#line 2483 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(hud_bShowAll  && bShowExtras ){
#line 2485 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlacement3D plLight  (_vViewerLightDirection  , ANGLE3D (0 , 0 , 0));
#line 2486 "C:/MyMod/Sources/EntitiesMP/Player.es"
plLight  . AbsoluteToRelative  (plViewer );
#line 2487 "C:/MyMod/Sources/EntitiesMP/Player.es"
RenderHUD  (* (CPerspectiveProjection3D  *) (CProjection3D  *) apr  , pdp  , 
#line 2488 "C:/MyMod/Sources/EntitiesMP/Player.es"
plLight  . pl_PositionVector  , _colViewerLight  , _colViewerAmbient  , 
#line 2489 "C:/MyMod/Sources/EntitiesMP/Player.es"
penViewer  == this  && (GetFlags  () & ENF_ALIVE ) , iEye );
#line 2490 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2491 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2492 "C:/MyMod/Sources/EntitiesMP/Player.es"
Stereo_SetBuffer  (STEREO_BOTH );
#line 2495 "C:/MyMod/Sources/EntitiesMP/Player.es"
PIX  pixDPWidth  = pdp  -> GetWidth  ();
#line 2496 "C:/MyMod/Sources/EntitiesMP/Player.es"
PIX  pixDPHeight  = pdp  -> GetHeight  ();
#line 2497 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fScale  = (FLOAT) pixDPWidth  / 640.0f;
#line 2500 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(_pTimer  -> CurrentTick  () < m_tmCenterMessageEnd ){
#line 2501 "C:/MyMod/Sources/EntitiesMP/Player.es"
pdp  -> SetFont  (_pfdDisplayFont );
#line 2502 "C:/MyMod/Sources/EntitiesMP/Player.es"
pdp  -> SetTextScaling  (fScale );
#line 2503 "C:/MyMod/Sources/EntitiesMP/Player.es"
pdp  -> SetTextAspect  (1.0f);
#line 2504 "C:/MyMod/Sources/EntitiesMP/Player.es"
pdp  -> PutTextCXY  (m_strCenterMessage  , pixDPWidth  * 0.5f , pixDPHeight  * 0.85f , C_WHITE  | 0xDD);
#line 2506 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else if(_pTimer  -> CurrentTick  () < m_tmLastPicked  + PICKEDREPORT_TIME ){
#line 2507 "C:/MyMod/Sources/EntitiesMP/Player.es"
pdp  -> SetFont  (_pfdDisplayFont );
#line 2508 "C:/MyMod/Sources/EntitiesMP/Player.es"
pdp  -> SetTextScaling  (fScale );
#line 2509 "C:/MyMod/Sources/EntitiesMP/Player.es"
pdp  -> SetTextAspect  (1.0f);
#line 2510 "C:/MyMod/Sources/EntitiesMP/Player.es"
CTString strPicked ;
#line 2511 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_fPickedAmmount  == 0){
#line 2512 "C:/MyMod/Sources/EntitiesMP/Player.es"
strPicked  = m_strPickedName ;
#line 2513 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 2514 "C:/MyMod/Sources/EntitiesMP/Player.es"
strPicked  . PrintF  ("%s +%d" , m_strPickedName  , int  (m_fPickedAmmount ));
#line 2515 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2516 "C:/MyMod/Sources/EntitiesMP/Player.es"
pdp  -> PutTextCXY  (strPicked  , pixDPWidth  * 0.5f , pixDPHeight  * 0.82f , C_WHITE  | 0xDD);
#line 2517 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(! GetSP  () -> sp_bCooperative  && ! GetSP  () -> sp_bUseFrags  && m_fPickedMana  >= 1){
#line 2518 "C:/MyMod/Sources/EntitiesMP/Player.es"
CTString strValue ;
#line 2519 "C:/MyMod/Sources/EntitiesMP/Player.es"
strValue  . PrintF  ("%s +%d" , TRANS  ("Value") , INDEX (m_fPickedMana ));
#line 2520 "C:/MyMod/Sources/EntitiesMP/Player.es"
pdp  -> PutTextCXY  (strValue  , pixDPWidth  * 0.5f , pixDPHeight  * 0.85f , C_WHITE  | 0xDD);
#line 2521 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2522 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2524 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(_pTimer  -> CurrentTick  () < m_tmAnalyseEnd ){
#line 2525 "C:/MyMod/Sources/EntitiesMP/Player.es"
pdp  -> SetFont  (_pfdDisplayFont );
#line 2526 "C:/MyMod/Sources/EntitiesMP/Player.es"
pdp  -> SetTextScaling  (fScale );
#line 2527 "C:/MyMod/Sources/EntitiesMP/Player.es"
pdp  -> SetTextAspect  (1.0f);
#line 2528 "C:/MyMod/Sources/EntitiesMP/Player.es"
UBYTE  ubA  = int  (sin  (_pTimer  -> CurrentTick  () * 10.0f) * 127 + 128);
#line 2529 "C:/MyMod/Sources/EntitiesMP/Player.es"
pdp  -> PutTextCXY  (TRANS  ("Analyzing...") , pixDPWidth  * 0.5f , pixDPHeight  * 0.2f , SE_COL_BLUE_NEUTRAL_LT  | ubA );
#line 2530 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2531 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 2534 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::RenderCameraView(CDrawPort * pdp,BOOL bListen) 
#line 2535 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 2536 "C:/MyMod/Sources/EntitiesMP/Player.es"
CDrawPort  dpCamera ;
#line 2537 "C:/MyMod/Sources/EntitiesMP/Player.es"
CDrawPort  * pdpCamera  = pdp ;
#line 2538 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_penCamera  != NULL  && ((CCamera  &) * m_penCamera ) . m_bWideScreen ){
#line 2539 "C:/MyMod/Sources/EntitiesMP/Player.es"
pdp  -> MakeWideScreen  (& dpCamera );
#line 2540 "C:/MyMod/Sources/EntitiesMP/Player.es"
pdpCamera  = & dpCamera ;
#line 2541 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2543 "C:/MyMod/Sources/EntitiesMP/Player.es"
pdp  -> Unlock  ();
#line 2544 "C:/MyMod/Sources/EntitiesMP/Player.es"
pdpCamera  -> Lock  ();
#line 2546 "C:/MyMod/Sources/EntitiesMP/Player.es"
CAnyProjection3D  apr ;
#line 2547 "C:/MyMod/Sources/EntitiesMP/Player.es"
CEntity  * penViewer ;
#line 2548 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlacement3D plViewer ;
#line 2549 "C:/MyMod/Sources/EntitiesMP/Player.es"
COLOR colBlend ;
#line 2552 "C:/MyMod/Sources/EntitiesMP/Player.es"
for(INDEX iEye  = STEREO_LEFT ;iEye  <= (Stereo_IsEnabled  () ? STEREO_RIGHT  : STEREO_LEFT );iEye  ++){
#line 2555 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetupView  (pdpCamera  , apr  , penViewer  , plViewer  , colBlend  , TRUE );
#line 2558 "C:/MyMod/Sources/EntitiesMP/Player.es"
Stereo_SetBuffer  (iEye );
#line 2559 "C:/MyMod/Sources/EntitiesMP/Player.es"
Stereo_AdjustProjection  (* apr  , iEye  , 1);
#line 2562 "C:/MyMod/Sources/EntitiesMP/Player.es"
ASSERT  (IsValidFloat  (plViewer  . pl_OrientationAngle  (1)) && IsValidFloat  (plViewer  . pl_OrientationAngle  (2)) && IsValidFloat  (plViewer  . pl_OrientationAngle  (3)));
#line 2563 "C:/MyMod/Sources/EntitiesMP/Player.es"
_ulPlayerRenderingMask  = 1 << GetMyPlayerIndex  ();
#line 2564 "C:/MyMod/Sources/EntitiesMP/Player.es"
RenderView  (* en_pwoWorld  , * penViewer  , apr  , * pdpCamera );
#line 2565 "C:/MyMod/Sources/EntitiesMP/Player.es"
_ulPlayerRenderingMask  = 0;
#line 2568 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(bListen  && iEye  == STEREO_LEFT ){
#line 2569 "C:/MyMod/Sources/EntitiesMP/Player.es"
ListenFromEntity  (penViewer  , plViewer );
#line 2570 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2571 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2572 "C:/MyMod/Sources/EntitiesMP/Player.es"
Stereo_SetBuffer  (STEREO_BOTH );
#line 2574 "C:/MyMod/Sources/EntitiesMP/Player.es"
RenderScroll  (pdpCamera );
#line 2575 "C:/MyMod/Sources/EntitiesMP/Player.es"
RenderTextFX  (pdpCamera );
#line 2576 "C:/MyMod/Sources/EntitiesMP/Player.es"
RenderCredits  (pdpCamera );
#line 2577 "C:/MyMod/Sources/EntitiesMP/Player.es"
RenderHudPicFX  (pdpCamera );
#line 2580 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 2581 "C:/MyMod/Sources/EntitiesMP/Player.es"
COLOR colGlare  = GetWorldGlaring  ();
#line 2582 "C:/MyMod/Sources/EntitiesMP/Player.es"
UBYTE  ubR  , ubG  , ubB  , ubA ;
#line 2583 "C:/MyMod/Sources/EntitiesMP/Player.es"
ColorToRGBA  (colGlare  , ubR  , ubG  , ubB  , ubA );
#line 2584 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(ubA  != 0){
#line 2585 "C:/MyMod/Sources/EntitiesMP/Player.es"
pdpCamera  -> dp_ulBlendingRA  += ULONG  (ubR ) * ULONG  (ubA );
#line 2586 "C:/MyMod/Sources/EntitiesMP/Player.es"
pdpCamera  -> dp_ulBlendingGA  += ULONG  (ubG ) * ULONG  (ubA );
#line 2587 "C:/MyMod/Sources/EntitiesMP/Player.es"
pdpCamera  -> dp_ulBlendingBA  += ULONG  (ubB ) * ULONG  (ubA );
#line 2588 "C:/MyMod/Sources/EntitiesMP/Player.es"
pdpCamera  -> dp_ulBlendingA  += ULONG  (ubA );
#line 2589 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2591 "C:/MyMod/Sources/EntitiesMP/Player.es"
pdpCamera  -> BlendScreen  ();
#line 2592 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2594 "C:/MyMod/Sources/EntitiesMP/Player.es"
pdpCamera  -> Unlock  ();
#line 2595 "C:/MyMod/Sources/EntitiesMP/Player.es"
pdp  -> Lock  ();
#line 2598 "C:/MyMod/Sources/EntitiesMP/Player.es"
if((colBlend  & CT_AMASK ) != 0){
#line 2599 "C:/MyMod/Sources/EntitiesMP/Player.es"
pdp  -> Fill  (colBlend );
#line 2600 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2603 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(_pTimer  -> CurrentTick  () < m_tmCenterMessageEnd ){
#line 2604 "C:/MyMod/Sources/EntitiesMP/Player.es"
PIX  pixDPWidth  = pdp  -> GetWidth  ();
#line 2605 "C:/MyMod/Sources/EntitiesMP/Player.es"
PIX  pixDPHeight  = pdp  -> GetHeight  ();
#line 2606 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fScale  = (FLOAT) pixDPWidth  / 640.0f;
#line 2607 "C:/MyMod/Sources/EntitiesMP/Player.es"
pdp  -> SetFont  (_pfdDisplayFont );
#line 2608 "C:/MyMod/Sources/EntitiesMP/Player.es"
pdp  -> SetTextScaling  (fScale );
#line 2609 "C:/MyMod/Sources/EntitiesMP/Player.es"
pdp  -> SetTextAspect  (1.0f);
#line 2610 "C:/MyMod/Sources/EntitiesMP/Player.es"
pdp  -> PutTextCXY  (m_strCenterMessage  , pixDPWidth  * 0.5f , pixDPHeight  * 0.85f , C_WHITE  | 0xDD);
#line 2611 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2612 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 2615 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::RenderGameView(CDrawPort * pdp,void * pvUserData) 
#line 2616 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 2617 "C:/MyMod/Sources/EntitiesMP/Player.es"
BOOL bShowExtras  = (ULONG  (pvUserData ) & GRV_SHOWEXTRAS );
#line 2618 "C:/MyMod/Sources/EntitiesMP/Player.es"
pdp  -> Unlock  ();
#line 2621 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(! (m_ulFlags  & PLF_INITIALIZED ) || (m_ulFlags  & PLF_DONTRENDER )){
#line 2623 "C:/MyMod/Sources/EntitiesMP/Player.es"
CDrawPort  dpView  (pdp  , TRUE );
#line 2624 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(dpView  . Lock  ()){
#line 2625 "C:/MyMod/Sources/EntitiesMP/Player.es"
RenderDummyView  (& dpView );
#line 2626 "C:/MyMod/Sources/EntitiesMP/Player.es"
dpView  . Unlock  ();
#line 2627 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2628 "C:/MyMod/Sources/EntitiesMP/Player.es"
pdp  -> Lock  ();
#line 2629 "C:/MyMod/Sources/EntitiesMP/Player.es"
return ;
#line 2630 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2633 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(pvUserData  != 0){
#line 2635 "C:/MyMod/Sources/EntitiesMP/Player.es"
CTimerValue  tvNow  = _pTimer  -> GetHighPrecisionTimer  ();
#line 2636 "C:/MyMod/Sources/EntitiesMP/Player.es"
if((tvNow  - _tvProbingLast ) . GetSeconds  () < 0.1){
#line 2638 "C:/MyMod/Sources/EntitiesMP/Player.es"
_pGfx  -> gl_bAllowProbing  = TRUE ;
#line 2639 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2640 "C:/MyMod/Sources/EntitiesMP/Player.es"
_tvProbingLast  = tvNow ;
#line 2641 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2646 "C:/MyMod/Sources/EntitiesMP/Player.es"
BOOL bDualHead  = 
#line 2647 "C:/MyMod/Sources/EntitiesMP/Player.es"
pdp  -> IsDualHead  () && 
#line 2648 "C:/MyMod/Sources/EntitiesMP/Player.es"
GetSP  () -> sp_gmGameMode  != CSessionProperties  :: GM_FLYOVER  && 
#line 2649 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_penActionMarker  == NULL ;
#line 2652 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(bDualHead  || m_penCamera  == NULL ){
#line 2654 "C:/MyMod/Sources/EntitiesMP/Player.es"
CDrawPort  dpView  (pdp  , TRUE );
#line 2655 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(dpView  . Lock  ()){
#line 2657 "C:/MyMod/Sources/EntitiesMP/Player.es"
RenderPlayerView  (& dpView  , bShowExtras );
#line 2658 "C:/MyMod/Sources/EntitiesMP/Player.es"
dpView  . Unlock  ();
#line 2659 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2660 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2663 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_penCamera  != NULL ){
#line 2665 "C:/MyMod/Sources/EntitiesMP/Player.es"
CDrawPort  dpView  (pdp  , m_penActionMarker  != NULL );
#line 2666 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(dpView  . Lock  ()){
#line 2668 "C:/MyMod/Sources/EntitiesMP/Player.es"
RenderCameraView  (& dpView  , ! bDualHead );
#line 2669 "C:/MyMod/Sources/EntitiesMP/Player.es"
dpView  . Unlock  ();
#line 2670 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2672 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 2674 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(bDualHead ){
#line 2676 "C:/MyMod/Sources/EntitiesMP/Player.es"
cmp_ppenDHPlayer  = this ;
#line 2677 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2678 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2680 "C:/MyMod/Sources/EntitiesMP/Player.es"
pdp  -> Lock  ();
#line 2681 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 2691 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::PreMoving(void) {
#line 2698 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerAnimator  &) * m_penAnimator ) . StoreLast  ();
#line 2699 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlayerEntity  :: PreMoving  ();
#line 2700 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 2703 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::DoMoving(void) {
#line 2704 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlayerEntity  :: DoMoving  ();
#line 2705 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerAnimator  &) * m_penAnimator ) . AnimateBanking  ();
#line 2707 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_penView  != NULL ){
#line 2708 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerView  &) * m_penView ) . DoMoving  ();
#line 2709 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2710 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_pen3rdPersonView  != NULL ){
#line 2711 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerView  &) * m_pen3rdPersonView ) . DoMoving  ();
#line 2712 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2713 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 2717 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::PostMoving(void) 
#line 2718 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 2719 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlayerEntity  :: PostMoving  ();
#line 2721 "C:/MyMod/Sources/EntitiesMP/Player.es"
en_ulFlags  &= ~ ENF_INRENDERING ;
#line 2723 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerAnimator  &) * m_penAnimator ) . AnimateSoftEyes  ();
#line 2727 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(GetFlags  () & ENF_ALIVE )
#line 2728 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 2729 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_fManaFraction  += 
#line 2730 "C:/MyMod/Sources/EntitiesMP/Player.es"
ClampDn  (1.0f - en_vCurrentTranslationAbsolute  . Length  () / 20.0f , 0.0f) * 20.0f 
#line 2731 "C:/MyMod/Sources/EntitiesMP/Player.es"
* _pTimer  -> TickQuantum ;
#line 2732 "C:/MyMod/Sources/EntitiesMP/Player.es"
INDEX iNewMana  = m_fManaFraction ;
#line 2733 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_iMana  += iNewMana ;
#line 2734 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_fManaFraction  -= iNewMana ;
#line 2735 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2738 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(GetSP  () -> sp_gdGameDifficulty  == CSessionProperties  :: GD_TOURIST  && GetFlags  () & ENF_ALIVE ){
#line 2740 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fHealth  = GetHealth  ();
#line 2741 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fTopHealth  = TopHealth  ();
#line 2742 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(fHealth  < fTopHealth ){
#line 2743 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetHealth  (ClampUp  (fHealth  + _pTimer  -> TickQuantum  , fTopHealth ));
#line 2744 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2745 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2748 "C:/MyMod/Sources/EntitiesMP/Player.es"
GetPlayerWeapons  () -> UpdateTargetingInfo  ();
#line 2750 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_pen3rdPersonView  != NULL ){
#line 2751 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerView  &) * m_pen3rdPersonView ) . PostMoving  ();
#line 2752 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2753 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_penView  != NULL ){
#line 2754 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerView  &) * m_penView ) . PostMoving  ();
#line 2755 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2758 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(! (m_ulFlags  & PLF_APPLIEDACTION )){
#line 2760 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetUnconnected  ();
#line 2761 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2764 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_ulFlags  &= ~ PLF_APPLIEDACTION ;
#line 2765 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 2768 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::SetUnconnected(void) 
#line 2769 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 2770 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_ulFlags  & PLF_NOTCONNECTED ){
#line 2771 "C:/MyMod/Sources/EntitiesMP/Player.es"
return ;
#line 2772 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2773 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_ulFlags  |= PLF_NOTCONNECTED ;
#line 2776 "C:/MyMod/Sources/EntitiesMP/Player.es"
ForceFullStop  ();
#line 2777 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetPhysicsFlags  (GetPhysicsFlags  () & ~ (EPF_TRANSLATEDBYGRAVITY  | EPF_ORIENTEDBYGRAVITY ));
#line 2778 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetCollisionFlags  (GetCollisionFlags  () & ~ ((ECBI_BRUSH  | ECBI_MODEL ) << ECB_TEST ));
#line 2779 "C:/MyMod/Sources/EntitiesMP/Player.es"
en_plLastViewpoint  . pl_OrientationAngle  = en_plViewpoint  . pl_OrientationAngle  = ANGLE3D (0 , 0 , 0);
#line 2781 "C:/MyMod/Sources/EntitiesMP/Player.es"
StartModelAnim  (PLAYER_ANIM_STAND  , 0);
#line 2782 "C:/MyMod/Sources/EntitiesMP/Player.es"
GetPlayerAnimator  () -> BodyAnimationTemplate  (
#line 2783 "C:/MyMod/Sources/EntitiesMP/Player.es"
BODY_ANIM_NORMALWALK  , BODY_ANIM_COLT_STAND  , BODY_ANIM_SHOTGUN_STAND  , BODY_ANIM_MINIGUN_STAND  , 
#line 2784 "C:/MyMod/Sources/EntitiesMP/Player.es"
AOF_LOOPING  | AOF_NORESTART );
#line 2785 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 2788 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::SetConnected(void) 
#line 2789 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 2790 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(! (m_ulFlags  & PLF_NOTCONNECTED )){
#line 2791 "C:/MyMod/Sources/EntitiesMP/Player.es"
return ;
#line 2792 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2793 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_ulFlags  &= ~ PLF_NOTCONNECTED ;
#line 2795 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetPhysicsFlags  (GetPhysicsFlags  () | (EPF_TRANSLATEDBYGRAVITY  | EPF_ORIENTEDBYGRAVITY ));
#line 2796 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetCollisionFlags  (GetCollisionFlags  () | ((ECBI_BRUSH  | ECBI_MODEL ) << ECB_TEST ));
#line 2797 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 2800 "C:/MyMod/Sources/EntitiesMP/Player.es"
BOOL CPlayer::IsConnected(void)const 
#line 2801 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 2802 "C:/MyMod/Sources/EntitiesMP/Player.es"
return ! (m_ulFlags  & PLF_NOTCONNECTED );
#line 2803 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 2806 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::ChecksumForSync(ULONG & ulCRC,INDEX iExtensiveSyncCheck) 
#line 2807 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 2808 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlayerEntity  :: ChecksumForSync  (ulCRC  , iExtensiveSyncCheck );
#line 2809 "C:/MyMod/Sources/EntitiesMP/Player.es"
CRC_AddLONG  (ulCRC  , m_psLevelStats  . ps_iScore );
#line 2810 "C:/MyMod/Sources/EntitiesMP/Player.es"
CRC_AddLONG  (ulCRC  , m_iMana );
#line 2811 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(iExtensiveSyncCheck  > 0){
#line 2812 "C:/MyMod/Sources/EntitiesMP/Player.es"
CRC_AddFLOAT  (ulCRC  , m_fManaFraction );
#line 2813 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2814 "C:/MyMod/Sources/EntitiesMP/Player.es"
CRC_AddFLOAT  (ulCRC  , m_fArmor );
#line 2815 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 2819 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::DumpSync_t(CTStream & strm,INDEX iExtensiveSyncCheck) 
#line 2820 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 2821 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlayerEntity  :: DumpSync_t  (strm  , iExtensiveSyncCheck );
#line 2822 "C:/MyMod/Sources/EntitiesMP/Player.es"
strm  . FPrintF_t  ("Score: %d\n" , m_psLevelStats  . ps_iScore );
#line 2823 "C:/MyMod/Sources/EntitiesMP/Player.es"
strm  . FPrintF_t  ("m_iMana:  %d\n" , m_iMana );
#line 2824 "C:/MyMod/Sources/EntitiesMP/Player.es"
strm  . FPrintF_t  ("m_fManaFraction: %g(%08x)\n" , m_fManaFraction  , (ULONG  &) m_fManaFraction );
#line 2825 "C:/MyMod/Sources/EntitiesMP/Player.es"
strm  . FPrintF_t  ("m_fArmor: %g(%08x)\n" , m_fArmor  , (ULONG  &) m_fArmor );
#line 2826 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  void CPlayer::LeaveStain(BOOL bGrow) 
#line 2835 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 2836 "C:/MyMod/Sources/EntitiesMP/Player.es"
ESpawnEffect  ese ;
#line 2837 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT3D vPoint ;
#line 2838 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOATplane3D vPlaneNormal ;
#line 2839 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fDistanceToEdge ;
#line 2841 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOATaabbox3D box ;
#line 2842 "C:/MyMod/Sources/EntitiesMP/Player.es"
GetBoundingBox  (box );
#line 2845 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(GetNearestPolygon  (vPoint  , vPlaneNormal  , fDistanceToEdge )){
#line 2847 "C:/MyMod/Sources/EntitiesMP/Player.es"
if((vPoint  - GetPlacement  () . pl_PositionVector ) . Length  () < 0.5f 
#line 2848 "C:/MyMod/Sources/EntitiesMP/Player.es"
&& (m_vLastStain  - vPoint ) . Length  () > 1.0f){
#line 2849 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_vLastStain  = vPoint ;
#line 2850 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fStretch  = box  . Size  () . Length  ();
#line 2851 "C:/MyMod/Sources/EntitiesMP/Player.es"
ese  . colMuliplier  = C_WHITE  | CT_OPAQUE ;
#line 2853 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(bGrow ){
#line 2854 "C:/MyMod/Sources/EntitiesMP/Player.es"
ese  . betType  = BET_BLOODSTAINGROW ;
#line 2855 "C:/MyMod/Sources/EntitiesMP/Player.es"
ese  . vStretch  = FLOAT3D (fStretch  * 1.5f , fStretch  * 1.5f , 1.0f);
#line 2856 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 2857 "C:/MyMod/Sources/EntitiesMP/Player.es"
ese  . betType  = BET_BLOODSTAIN ;
#line 2858 "C:/MyMod/Sources/EntitiesMP/Player.es"
ese  . vStretch  = FLOAT3D (fStretch  * 0.75f , fStretch  * 0.75f , 1.0f);
#line 2859 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2860 "C:/MyMod/Sources/EntitiesMP/Player.es"
ese  . vNormal  = FLOAT3D (vPlaneNormal );
#line 2861 "C:/MyMod/Sources/EntitiesMP/Player.es"
ese  . vDirection  = FLOAT3D (0 , 0 , 0);
#line 2862 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT3D vPos  = vPoint  + ese  . vNormal  / 50.0f * (FRnd  () + 0.5f);
#line 2863 "C:/MyMod/Sources/EntitiesMP/Player.es"
CEntityPointer penEffect  = CreateEntity  (CPlacement3D (vPos  , ANGLE3D (0 , 0 , 0)) , CLASS_BASIC_EFFECT );
#line 2864 "C:/MyMod/Sources/EntitiesMP/Player.es"
penEffect  -> Initialize  (ese );
#line 2865 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2866 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2867 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 2870 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::DamageImpact(enum DamageType dmtType,
#line 2871 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fDamageAmmount,const FLOAT3D & vHitPoint,const FLOAT3D & vDirection) 
#line 2872 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 2874 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(GetRenderType  () != RT_MODEL ){
#line 2876 "C:/MyMod/Sources/EntitiesMP/Player.es"
return ;
#line 2877 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2879 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(dmtType  == DMT_ABYSS  || dmtType  == DMT_SPIKESTAB ){
#line 2880 "C:/MyMod/Sources/EntitiesMP/Player.es"
return ;
#line 2881 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2883 "C:/MyMod/Sources/EntitiesMP/Player.es"
fDamageAmmount  = Clamp  (fDamageAmmount  , 0.0f , 5000.0f);
#line 2885 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fKickDamage  = fDamageAmmount ;
#line 2886 "C:/MyMod/Sources/EntitiesMP/Player.es"
if((dmtType  == DMT_EXPLOSION ) || (dmtType  == DMT_IMPACT ) || (dmtType  == DMT_CANNONBALL_EXPLOSION ))
#line 2887 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 2888 "C:/MyMod/Sources/EntitiesMP/Player.es"
fKickDamage  *= 1.5;
#line 2889 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2890 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(dmtType  == DMT_DROWNING  || dmtType  == DMT_CLOSERANGE ){
#line 2891 "C:/MyMod/Sources/EntitiesMP/Player.es"
fKickDamage  /= 10;
#line 2892 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2893 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(dmtType  == DMT_CHAINSAW )
#line 2894 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 2895 "C:/MyMod/Sources/EntitiesMP/Player.es"
fKickDamage  /= 10;
#line 2896 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2899 "C:/MyMod/Sources/EntitiesMP/Player.es"
TIME  tmNow  = _pTimer  -> CurrentTick  ();
#line 2900 "C:/MyMod/Sources/EntitiesMP/Player.es"
TIME  tmDelta  = tmNow  - m_tmLastDamage ;
#line 2901 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_tmLastDamage  = tmNow ;
#line 2904 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(tmDelta  >= _pTimer  -> TickQuantum  * 3){
#line 2905 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_vDamage  = FLOAT3D (0 , 0 , 0);
#line 2906 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2908 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT3D vDirectionFixed ;
#line 2909 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(vDirection  . ManhattanNorm  () > 0.5f){
#line 2910 "C:/MyMod/Sources/EntitiesMP/Player.es"
vDirectionFixed  = vDirection ;
#line 2911 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 2912 "C:/MyMod/Sources/EntitiesMP/Player.es"
vDirectionFixed  = - en_vGravityDir ;
#line 2913 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2914 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT3D vDamageOld  = m_vDamage ;
#line 2915 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_vDamage  += (vDirectionFixed ) * fKickDamage ;
#line 2917 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fOldLen  = vDamageOld  . Length  ();
#line 2918 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fNewLen  = m_vDamage  . Length  ();
#line 2919 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fOldRootLen  = Sqrt  (fOldLen );
#line 2920 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fNewRootLen  = Sqrt  (fNewLen );
#line 2922 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fMassFactor  = 200.0f / ((EntityInfo  *) GetEntityInfo  ()) -> fMass ;
#line 2924 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(! (en_ulFlags  & ENF_ALIVE ))
#line 2925 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 2926 "C:/MyMod/Sources/EntitiesMP/Player.es"
fMassFactor  /= 3;
#line 2927 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2929 "C:/MyMod/Sources/EntitiesMP/Player.es"
switch(dmtType )
#line 2930 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 2931 "C:/MyMod/Sources/EntitiesMP/Player.es"
case DMT_CLOSERANGE : 
#line 2932 "C:/MyMod/Sources/EntitiesMP/Player.es"
case DMT_CHAINSAW : 
#line 2933 "C:/MyMod/Sources/EntitiesMP/Player.es"
case DMT_DROWNING : 
#line 2934 "C:/MyMod/Sources/EntitiesMP/Player.es"
case DMT_IMPACT : 
#line 2935 "C:/MyMod/Sources/EntitiesMP/Player.es"
case DMT_BRUSH : 
#line 2936 "C:/MyMod/Sources/EntitiesMP/Player.es"
case DMT_BURNING : 
#line 2938 "C:/MyMod/Sources/EntitiesMP/Player.es"
break ;
#line 2939 "C:/MyMod/Sources/EntitiesMP/Player.es"
default  :
#line 2940 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 2941 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(fOldLen  != 0.0f)
#line 2942 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 2944 "C:/MyMod/Sources/EntitiesMP/Player.es"
GiveImpulseTranslationAbsolute  (- vDamageOld  / fOldRootLen  * fMassFactor );
#line 2945 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2953 "C:/MyMod/Sources/EntitiesMP/Player.es"
GiveImpulseTranslationAbsolute  (m_vDamage  / fNewRootLen  * fMassFactor );
#line 2954 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2955 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2957 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_fMaxDamageAmmount  < fDamageAmmount )
#line 2958 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 2959 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_fMaxDamageAmmount  = fDamageAmmount ;
#line 2960 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2962 "C:/MyMod/Sources/EntitiesMP/Player.es"
if((m_tmSpraySpawned  <= _pTimer  -> CurrentTick  () - _pTimer  -> TickQuantum  * 8 || 
#line 2963 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_fSprayDamage  + fDamageAmmount  > 50.0f)){
#line 2966 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlacement3D plSpray  = CPlacement3D (vHitPoint  , ANGLE3D (0 , 0 , 0));
#line 2967 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_penSpray  = CreateEntity  (plSpray  , CLASS_BLOOD_SPRAY );
#line 2968 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_penSpray  -> SetParent  (this );
#line 2969 "C:/MyMod/Sources/EntitiesMP/Player.es"
ESpawnSpray  eSpawnSpray ;
#line 2970 "C:/MyMod/Sources/EntitiesMP/Player.es"
eSpawnSpray  . colBurnColor  = C_WHITE  | CT_OPAQUE ;
#line 2972 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_fMaxDamageAmmount  > 10.0f)
#line 2973 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 2974 "C:/MyMod/Sources/EntitiesMP/Player.es"
eSpawnSpray  . fDamagePower  = 3.0f;
#line 2975 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2976 "C:/MyMod/Sources/EntitiesMP/Player.es"
else if(m_fSprayDamage  + fDamageAmmount  > 50.0f)
#line 2977 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 2978 "C:/MyMod/Sources/EntitiesMP/Player.es"
eSpawnSpray  . fDamagePower  = 2.0f;
#line 2979 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2980 "C:/MyMod/Sources/EntitiesMP/Player.es"
else 
#line 2981 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 2982 "C:/MyMod/Sources/EntitiesMP/Player.es"
eSpawnSpray  . fDamagePower  = 1.0f;
#line 2983 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 2985 "C:/MyMod/Sources/EntitiesMP/Player.es"
eSpawnSpray  . sptType  = SPT_BLOOD ;
#line 2986 "C:/MyMod/Sources/EntitiesMP/Player.es"
eSpawnSpray  . fSizeMultiplier  = 1.0f;
#line 2989 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT3D vHitPointRelative  = vHitPoint  - GetPlacement  () . pl_PositionVector ;
#line 2990 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT3D vReflectingNormal ;
#line 2991 "C:/MyMod/Sources/EntitiesMP/Player.es"
GetNormalComponent  (vHitPointRelative  , en_vGravityDir  , vReflectingNormal );
#line 2992 "C:/MyMod/Sources/EntitiesMP/Player.es"
vReflectingNormal  . Normalize  ();
#line 2994 "C:/MyMod/Sources/EntitiesMP/Player.es"
vReflectingNormal  (1) /= 5.0f;
#line 2996 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT3D vProjectedComponent  = vReflectingNormal  * (vDirection  % vReflectingNormal );
#line 2997 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT3D vSpilDirection  = vDirection  - vProjectedComponent  * 2.0f - en_vGravityDir  * 0.5f;
#line 2999 "C:/MyMod/Sources/EntitiesMP/Player.es"
eSpawnSpray  . vDirection  = vSpilDirection ;
#line 3000 "C:/MyMod/Sources/EntitiesMP/Player.es"
eSpawnSpray  . penOwner  = this ;
#line 3003 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_penSpray  -> Initialize  (eSpawnSpray );
#line 3004 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_tmSpraySpawned  = _pTimer  -> CurrentTick  ();
#line 3005 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_fSprayDamage  = 0.0f;
#line 3006 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_fMaxDamageAmmount  = 0.0f;
#line 3007 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3008 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_fSprayDamage  += fDamageAmmount ;
#line 3009 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 3013 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::ReceiveDamage(CEntity * penInflictor,enum DamageType dmtType,
#line 3014 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fDamageAmmount,const FLOAT3D & vHitPoint,const FLOAT3D & vDirection) 
#line 3015 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 3017 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(penInflictor  == this  && (dmtType  == DMT_CLOSERANGE  || dmtType  == DMT_CHAINSAW  || 
#line 3018 "C:/MyMod/Sources/EntitiesMP/Player.es"
((dmtType  == DMT_EXPLOSION  || dmtType  == DMT_CANNONBALL_EXPLOSION  || dmtType  == DMT_PROJECTILE ) && 
#line 3019 "C:/MyMod/Sources/EntitiesMP/Player.es"
GetSP  () -> sp_gdGameDifficulty  <= CSessionProperties  :: GD_EASY ))){
#line 3020 "C:/MyMod/Sources/EntitiesMP/Player.es"
return ;
#line 3021 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3024 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_ulFlags  & PLF_NOTCONNECTED ){
#line 3026 "C:/MyMod/Sources/EntitiesMP/Player.es"
return ;
#line 3027 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3030 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(cht_bGod  && CheatsEnabled  ()){return ;}
#line 3033 "C:/MyMod/Sources/EntitiesMP/Player.es"
const TIME  tmDelta  = m_tmInvulnerability  - _pTimer  -> CurrentTick  ();
#line 3034 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(tmDelta  > 0 && dmtType  != DMT_ABYSS  && dmtType  != DMT_TELEPORT ){return ;}
#line 3037 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT tmSpawnInvulnerability  = GetSP  () -> sp_tmSpawnInvulnerability ;
#line 3038 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(tmSpawnInvulnerability  > 0 && _pTimer  -> CurrentTick  () - m_tmSpawned  < tmSpawnInvulnerability ){
#line 3040 "C:/MyMod/Sources/EntitiesMP/Player.es"
return ;
#line 3041 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3044 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(! GetSP  () -> sp_bFriendlyFire  && GetSP  () -> sp_bCooperative ){
#line 3045 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(IsOfClass  (penInflictor  , "Player") && penInflictor  != this ){
#line 3046 "C:/MyMod/Sources/EntitiesMP/Player.es"
return ;
#line 3047 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3048 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3051 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(dmtType  == DMT_HEAT  && ! (GetFlags  () & ENF_ALIVE )){
#line 3052 "C:/MyMod/Sources/EntitiesMP/Player.es"
return ;
#line 3053 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3056 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fDifficultyDamage  = GetSP  () -> sp_fDamageStrength ;
#line 3057 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(fDifficultyDamage  <= 1.0f || penInflictor  != this ){
#line 3058 "C:/MyMod/Sources/EntitiesMP/Player.es"
fDamageAmmount  *= fDifficultyDamage ;
#line 3059 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3062 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(fDamageAmmount  <= 0){
#line 3063 "C:/MyMod/Sources/EntitiesMP/Player.es"
return ;
#line 3064 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3066 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fSubHealth  , fSubArmor ;
#line 3067 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(dmtType  == DMT_DROWNING ){
#line 3069 "C:/MyMod/Sources/EntitiesMP/Player.es"
fSubHealth  = fDamageAmmount ;
#line 3070 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3071 "C:/MyMod/Sources/EntitiesMP/Player.es"
else {
#line 3073 "C:/MyMod/Sources/EntitiesMP/Player.es"
fSubArmor  = fDamageAmmount  * 2.0f / 3.0f;
#line 3074 "C:/MyMod/Sources/EntitiesMP/Player.es"
fSubHealth  = fDamageAmmount  - fSubArmor ;
#line 3075 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_fArmor  -= fSubArmor ;
#line 3076 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_fArmor  < 0){
#line 3077 "C:/MyMod/Sources/EntitiesMP/Player.es"
fSubHealth  -= m_fArmor ;
#line 3078 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_fArmor  = 0.0f;
#line 3079 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3080 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3083 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(fSubHealth  > 0){
#line 3085 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_penCamera  != NULL ){
#line 3087 "C:/MyMod/Sources/EntitiesMP/Player.es"
CEntity  * penOnBreak  = ((CCamera  &) * m_penCamera ) . m_penOnBreak ;
#line 3088 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(penOnBreak  != NULL ){
#line 3090 "C:/MyMod/Sources/EntitiesMP/Player.es"
SendToTarget  (penOnBreak  , EET_TRIGGER  , this );
#line 3092 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 3094 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_penCamera  = NULL ;
#line 3095 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3096 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3098 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3101 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_penActionMarker  != NULL ){
#line 3103 "C:/MyMod/Sources/EntitiesMP/Player.es"
return ;
#line 3104 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3106 "C:/MyMod/Sources/EntitiesMP/Player.es"
DamageImpact  (dmtType  , fSubHealth  , vHitPoint  , vDirection );
#line 3109 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlayerEntity  :: ReceiveDamage  (penInflictor  , dmtType  , fSubHealth  , vHitPoint  , vDirection );
#line 3112 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(fDamageAmmount  > 1.0f){
#line 3114 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(dmtType  == DMT_EXPLOSION  || dmtType  == DMT_PROJECTILE  || dmtType  == DMT_BULLET  
#line 3115 "C:/MyMod/Sources/EntitiesMP/Player.es"
|| dmtType  == DMT_IMPACT  || dmtType  == DMT_CANNONBALL  || dmtType  == DMT_CANNONBALL_EXPLOSION ){
#line 3118 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3119 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(GetFlags  () & ENF_ALIVE ){
#line 3120 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_fDamageAmmount  += fDamageAmmount ;
#line 3121 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_tmWoundedTime  = _pTimer  -> CurrentTick  ();
#line 3122 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3123 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3126 "C:/MyMod/Sources/EntitiesMP/Player.es"
ESound  eSound ;
#line 3127 "C:/MyMod/Sources/EntitiesMP/Player.es"
eSound  . EsndtSound  = SNDT_PLAYER ;
#line 3128 "C:/MyMod/Sources/EntitiesMP/Player.es"
eSound  . penTarget  = this ;
#line 3129 "C:/MyMod/Sources/EntitiesMP/Player.es"
SendEventInRange  (eSound  , FLOATaabbox3D (GetPlacement  () . pl_PositionVector  , 10.0f));
#line 3132 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(dmtType  == DMT_DROWNING ){
#line 3133 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetRandomMouthPitch  (0.9f , 1.1f);
#line 3134 "C:/MyMod/Sources/EntitiesMP/Player.es"
PlaySound  (m_soMouth  , GenderSound  (SOUND_DROWN ) , SOF_3D );
#line 3135 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(_pNetwork  -> IsPlayerLocal  (this )){IFeel_PlayEffect  ("WoundWater");}
#line 3136 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_tmMouthSoundLast  = _pTimer  -> CurrentTick  ();
#line 3137 "C:/MyMod/Sources/EntitiesMP/Player.es"
PlaySound  (m_soLocalAmbientOnce  , SOUND_WATERBUBBLES  , SOF_3D  | SOF_VOLUMETRIC  | SOF_LOCAL );
#line 3138 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_soLocalAmbientOnce  . Set3DParameters  (25.0f , 5.0f , 2.0f , Lerp  (0.5f , 1.5f , FRnd  ()));
#line 3139 "C:/MyMod/Sources/EntitiesMP/Player.es"
SpawnBubbles  (10 + INDEX (FRnd  () * 10));
#line 3140 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else if(m_fDamageAmmount  > 1.0f){
#line 3142 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(GetFlags  () & ENF_ALIVE ){
#line 3144 "C:/MyMod/Sources/EntitiesMP/Player.es"
INDEX iSound ;
#line 3145 "C:/MyMod/Sources/EntitiesMP/Player.es"
char  * strIFeel  = NULL ;
#line 3146 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_fDamageAmmount  < 5.0f){
#line 3147 "C:/MyMod/Sources/EntitiesMP/Player.es"
iSound  = GenderSound  (SOUND_WOUNDWEAK );
#line 3148 "C:/MyMod/Sources/EntitiesMP/Player.es"
strIFeel  = "WoundWeak";
#line 3149 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3150 "C:/MyMod/Sources/EntitiesMP/Player.es"
else if(m_fDamageAmmount  < 25.0f){
#line 3151 "C:/MyMod/Sources/EntitiesMP/Player.es"
iSound  = GenderSound  (SOUND_WOUNDMEDIUM );
#line 3152 "C:/MyMod/Sources/EntitiesMP/Player.es"
strIFeel  = "WoundMedium";
#line 3153 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3154 "C:/MyMod/Sources/EntitiesMP/Player.es"
else {
#line 3155 "C:/MyMod/Sources/EntitiesMP/Player.es"
iSound  = GenderSound  (SOUND_WOUNDSTRONG );
#line 3156 "C:/MyMod/Sources/EntitiesMP/Player.es"
strIFeel  = "WoundStrong";
#line 3157 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3158 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_pstState  == PST_DIVE ){
#line 3159 "C:/MyMod/Sources/EntitiesMP/Player.es"
iSound  = GenderSound  (SOUND_WOUNDWATER );
#line 3160 "C:/MyMod/Sources/EntitiesMP/Player.es"
strIFeel  = "WoundWater";
#line 3161 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3162 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetRandomMouthPitch  (0.9f , 1.1f);
#line 3164 "C:/MyMod/Sources/EntitiesMP/Player.es"
TIME  tmNow  = _pTimer  -> CurrentTick  ();
#line 3165 "C:/MyMod/Sources/EntitiesMP/Player.es"
if((tmNow  - m_tmScreamTime ) > 1.0f){
#line 3166 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_tmScreamTime  = tmNow ;
#line 3167 "C:/MyMod/Sources/EntitiesMP/Player.es"
PlaySound  (m_soMouth  , iSound  , SOF_3D );
#line 3168 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(_pNetwork  -> IsPlayerLocal  (this )){IFeel_PlayEffect  (strIFeel );}
#line 3169 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3170 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3171 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3172 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 3175 "C:/MyMod/Sources/EntitiesMP/Player.es"
BOOL CPlayer::ShouldBlowUp(void) 
#line 3176 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 3178 "C:/MyMod/Sources/EntitiesMP/Player.es"
return 
#line 3180 "C:/MyMod/Sources/EntitiesMP/Player.es"
GetSP  () -> sp_bGibs  && 
#line 3182 "C:/MyMod/Sources/EntitiesMP/Player.es"
(GetHealth  () <= 0) && 
#line 3184 "C:/MyMod/Sources/EntitiesMP/Player.es"
(m_vDamage  . Length  () > _fBlowUpAmmount ) && 
#line 3186 "C:/MyMod/Sources/EntitiesMP/Player.es"
GetRenderType  () == RT_MODEL ;
#line 3187 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 3190 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::BlowUp(void) 
#line 3191 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 3192 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT3D vNormalizedDamage  = m_vDamage  - m_vDamage  * (_fBlowUpAmmount  / m_vDamage  . Length  ());
#line 3193 "C:/MyMod/Sources/EntitiesMP/Player.es"
vNormalizedDamage  /= Sqrt  (vNormalizedDamage  . Length  ());
#line 3194 "C:/MyMod/Sources/EntitiesMP/Player.es"
vNormalizedDamage  *= 0.75f;
#line 3196 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT3D vBodySpeed  = en_vCurrentTranslationAbsolute  - en_vGravityDir  * (en_vGravityDir  % en_vCurrentTranslationAbsolute );
#line 3197 "C:/MyMod/Sources/EntitiesMP/Player.es"
const FLOAT fBlowUpSize  = 2.0f;
#line 3200 "C:/MyMod/Sources/EntitiesMP/Player.es"
const INDEX iBloodType  = GetSP  () -> sp_iBlood ;
#line 3202 "C:/MyMod/Sources/EntitiesMP/Player.es"
ULONG  ulFleshTexture  = TEXTURE_FLESH_GREEN ;
#line 3203 "C:/MyMod/Sources/EntitiesMP/Player.es"
ULONG  ulFleshModel  = MODEL_FLESH ;
#line 3204 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(iBloodType  == 2){ulFleshTexture  = TEXTURE_FLESH_RED ;}
#line 3206 "C:/MyMod/Sources/EntitiesMP/Player.es"
Debris_Begin  (EIBT_FLESH  , DPT_BLOODTRAIL  , BET_BLOODSTAIN  , fBlowUpSize  , vNormalizedDamage  , vBodySpeed  , 1.0f , 0.0f);
#line 3207 "C:/MyMod/Sources/EntitiesMP/Player.es"
for(INDEX iDebris  = 0;iDebris  < 4;iDebris  ++){
#line 3209 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(iBloodType  == 3){
#line 3210 "C:/MyMod/Sources/EntitiesMP/Player.es"
switch(IRnd  () % 5){
#line 3211 "C:/MyMod/Sources/EntitiesMP/Player.es"
case 1: {ulFleshModel  = MODEL_FLESH_APPLE ;ulFleshTexture  = TEXTURE_FLESH_APPLE ;break ;}
#line 3212 "C:/MyMod/Sources/EntitiesMP/Player.es"
case 2: {ulFleshModel  = MODEL_FLESH_BANANA ;ulFleshTexture  = TEXTURE_FLESH_BANANA ;break ;}
#line 3213 "C:/MyMod/Sources/EntitiesMP/Player.es"
case 3: {ulFleshModel  = MODEL_FLESH_BURGER ;ulFleshTexture  = TEXTURE_FLESH_BURGER ;break ;}
#line 3214 "C:/MyMod/Sources/EntitiesMP/Player.es"
case 4: {ulFleshModel  = MODEL_FLESH_LOLLY ;ulFleshTexture  = TEXTURE_FLESH_LOLLY ;break ;}
#line 3215 "C:/MyMod/Sources/EntitiesMP/Player.es"
default  :{ulFleshModel  = MODEL_FLESH_ORANGE ;ulFleshTexture  = TEXTURE_FLESH_ORANGE ;break ;}
#line 3216 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3217 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3218 "C:/MyMod/Sources/EntitiesMP/Player.es"
Debris_Spawn  (this  , this  , ulFleshModel  , ulFleshTexture  , 0 , 0 , 0 , IRnd  () % 4 , 0.5f , 
#line 3219 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT3D (FRnd  () * 0.6f + 0.2f , FRnd  () * 0.6f + 0.2f , FRnd  () * 0.6f + 0.2f));
#line 3220 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3223 "C:/MyMod/Sources/EntitiesMP/Player.es"
LeaveStain  (FALSE );
#line 3225 "C:/MyMod/Sources/EntitiesMP/Player.es"
PlaySound  (m_soBody  , SOUND_BLOWUP  , SOF_3D );
#line 3228 "C:/MyMod/Sources/EntitiesMP/Player.es"
SwitchToEditorModel  ();
#line 3230 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fSpeedOrg  = en_vCurrentTranslationAbsolute  . Length  ();
#line 3231 "C:/MyMod/Sources/EntitiesMP/Player.es"
const FLOAT fSpeedMax  = 30.0f;
#line 3232 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(fSpeedOrg  > fSpeedMax ){
#line 3233 "C:/MyMod/Sources/EntitiesMP/Player.es"
en_vCurrentTranslationAbsolute  *= fSpeedMax  / fSpeedOrg ;
#line 3234 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3238 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 3244 "C:/MyMod/Sources/EntitiesMP/Player.es"
void * CPlayer::GetEntityInfo(void) 
#line 3245 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 3246 "C:/MyMod/Sources/EntitiesMP/Player.es"
switch(m_pstState ){
#line 3247 "C:/MyMod/Sources/EntitiesMP/Player.es"
case PST_STAND : case PST_FALL : 
#line 3248 "C:/MyMod/Sources/EntitiesMP/Player.es"
return & eiPlayerGround ;
#line 3249 "C:/MyMod/Sources/EntitiesMP/Player.es"
break ;
#line 3250 "C:/MyMod/Sources/EntitiesMP/Player.es"
case PST_CROUCH : 
#line 3251 "C:/MyMod/Sources/EntitiesMP/Player.es"
return & eiPlayerCrouch ;
#line 3252 "C:/MyMod/Sources/EntitiesMP/Player.es"
break ;
#line 3253 "C:/MyMod/Sources/EntitiesMP/Player.es"
case PST_SWIM : case PST_DIVE : 
#line 3254 "C:/MyMod/Sources/EntitiesMP/Player.es"
return & eiPlayerSwim ;
#line 3255 "C:/MyMod/Sources/EntitiesMP/Player.es"
break ;
#line 3256 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3257 "C:/MyMod/Sources/EntitiesMP/Player.es"
return & eiPlayerGround ;
#line 3258 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 3262 "C:/MyMod/Sources/EntitiesMP/Player.es"
BOOL CPlayer::ReceiveItem(const CEntityEvent & ee) 
#line 3263 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 3265 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(ee  . ee_slEvent  == EVENTCODE_EHealth )
#line 3266 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 3268 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fHealthOld  = GetHealth  ();
#line 3269 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fHealthNew  = fHealthOld  + ((EHealth  &) ee ) . fHealth ;
#line 3270 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(((EHealth  &) ee ) . bOverTopHealth ){
#line 3271 "C:/MyMod/Sources/EntitiesMP/Player.es"
fHealthNew  = ClampUp  (fHealthNew  , MaxHealth  ());
#line 3272 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 3273 "C:/MyMod/Sources/EntitiesMP/Player.es"
fHealthNew  = ClampUp  (fHealthNew  , TopHealth  ());
#line 3274 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3277 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(ceil  (fHealthNew ) > ceil  (fHealthOld )){
#line 3279 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetHealth  (fHealthNew );
#line 3280 "C:/MyMod/Sources/EntitiesMP/Player.es"
ItemPicked  (TRANS  ("Health") , ((EHealth  &) ee ) . fHealth );
#line 3281 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_iMana  += (INDEX) (((EHealth  &) ee ) . fHealth );
#line 3282 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_fPickedMana  += ((EHealth  &) ee ) . fHealth ;
#line 3283 "C:/MyMod/Sources/EntitiesMP/Player.es"
return TRUE ;
#line 3284 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3285 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3288 "C:/MyMod/Sources/EntitiesMP/Player.es"
else if(ee  . ee_slEvent  == EVENTCODE_EArmor )
#line 3289 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 3291 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fArmorOld  = m_fArmor ;
#line 3292 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fArmorNew  = fArmorOld  + ((EArmor  &) ee ) . fArmor ;
#line 3293 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(((EArmor  &) ee ) . bOverTopArmor ){
#line 3294 "C:/MyMod/Sources/EntitiesMP/Player.es"
fArmorNew  = ClampUp  (fArmorNew  , MaxArmor  ());
#line 3295 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 3296 "C:/MyMod/Sources/EntitiesMP/Player.es"
fArmorNew  = ClampUp  (fArmorNew  , TopArmor  ());
#line 3297 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3299 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(ceil  (fArmorNew ) > ceil  (fArmorOld )){
#line 3301 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_fArmor  = fArmorNew ;
#line 3302 "C:/MyMod/Sources/EntitiesMP/Player.es"
ItemPicked  (TRANS  ("Armor") , ((EArmor  &) ee ) . fArmor );
#line 3303 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_iMana  += (INDEX) (((EArmor  &) ee ) . fArmor );
#line 3304 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_fPickedMana  += ((EArmor  &) ee ) . fArmor ;
#line 3305 "C:/MyMod/Sources/EntitiesMP/Player.es"
return TRUE ;
#line 3306 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3307 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3310 "C:/MyMod/Sources/EntitiesMP/Player.es"
else if(ee  . ee_slEvent  == EVENTCODE_EMessageItem ){
#line 3311 "C:/MyMod/Sources/EntitiesMP/Player.es"
EMessageItem  & eMI  = (EMessageItem  &) ee ;
#line 3312 "C:/MyMod/Sources/EntitiesMP/Player.es"
ReceiveComputerMessage  (eMI  . fnmMessage  , CMF_ANALYZE );
#line 3313 "C:/MyMod/Sources/EntitiesMP/Player.es"
ItemPicked  (TRANS  ("Ancient papyrus") , 0);
#line 3314 "C:/MyMod/Sources/EntitiesMP/Player.es"
return TRUE ;
#line 3315 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3318 "C:/MyMod/Sources/EntitiesMP/Player.es"
else if(ee  . ee_slEvent  == EVENTCODE_EWeaponItem ){
#line 3319 "C:/MyMod/Sources/EntitiesMP/Player.es"
return ((CPlayerWeapons  &) * m_penWeapons ) . ReceiveWeapon  (ee );
#line 3320 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3323 "C:/MyMod/Sources/EntitiesMP/Player.es"
else if(ee  . ee_slEvent  == EVENTCODE_EAmmoItem ){
#line 3324 "C:/MyMod/Sources/EntitiesMP/Player.es"
return ((CPlayerWeapons  &) * m_penWeapons ) . ReceiveAmmo  (ee );
#line 3325 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3327 "C:/MyMod/Sources/EntitiesMP/Player.es"
else if(ee  . ee_slEvent  == EVENTCODE_EAmmoPackItem ){
#line 3328 "C:/MyMod/Sources/EntitiesMP/Player.es"
return ((CPlayerWeapons  &) * m_penWeapons ) . ReceivePackAmmo  (ee );
#line 3329 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3332 "C:/MyMod/Sources/EntitiesMP/Player.es"
else if(ee  . ee_slEvent  == EVENTCODE_EKey ){
#line 3334 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_penActionMarker  != NULL ){
#line 3335 "C:/MyMod/Sources/EntitiesMP/Player.es"
return FALSE ;
#line 3336 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3338 "C:/MyMod/Sources/EntitiesMP/Player.es"
ULONG  ulKey  = 1 << INDEX (((EKey  &) ee ) . kitType );
#line 3339 "C:/MyMod/Sources/EntitiesMP/Player.es"
EKey  & eKey  = (EKey  &) ee ;
#line 3340 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(eKey  . kitType  == KIT_HAWKWINGS01DUMMY  || eKey  . kitType  == KIT_HAWKWINGS02DUMMY  
#line 3341 "C:/MyMod/Sources/EntitiesMP/Player.es"
|| eKey  . kitType  == KIT_TABLESDUMMY  || eKey  . kitType  == KIT_JAGUARGOLDDUMMY )
#line 3342 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 3343 "C:/MyMod/Sources/EntitiesMP/Player.es"
ulKey  = 0;
#line 3344 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3346 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_ulKeys  & ulKey ){
#line 3348 "C:/MyMod/Sources/EntitiesMP/Player.es"
return FALSE ;
#line 3350 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 3352 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_ulKeys  |= ulKey ;
#line 3353 "C:/MyMod/Sources/EntitiesMP/Player.es"
CTString strKey  = GetKeyName  (((EKey  &) ee ) . kitType );
#line 3354 "C:/MyMod/Sources/EntitiesMP/Player.es"
ItemPicked  (strKey  , 0);
#line 3356 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(GetSP  () -> sp_bCooperative  && ! GetSP  () -> sp_bSinglePlayer ){
#line 3357 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPrintF  (TRANS  ("^cFFFFFF%s - %s^r\n") , GetPlayerName  () , strKey );
#line 3358 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3359 "C:/MyMod/Sources/EntitiesMP/Player.es"
return TRUE ;
#line 3360 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3361 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3364 "C:/MyMod/Sources/EntitiesMP/Player.es"
else if(ee  . ee_slEvent  == EVENTCODE_EPowerUp ){
#line 3365 "C:/MyMod/Sources/EntitiesMP/Player.es"
const FLOAT tmNow  = _pTimer  -> CurrentTick  ();
#line 3366 "C:/MyMod/Sources/EntitiesMP/Player.es"
switch(((EPowerUp  &) ee ) . puitType ){
#line 3367 "C:/MyMod/Sources/EntitiesMP/Player.es"
case PUIT_INVISIB : m_tmInvisibility  = tmNow  + m_tmInvisibilityMax ;
#line 3368 "C:/MyMod/Sources/EntitiesMP/Player.es"
ItemPicked  (TRANS  ("^cABE3FFInvisibility") , 0);
#line 3369 "C:/MyMod/Sources/EntitiesMP/Player.es"
return TRUE ;
#line 3370 "C:/MyMod/Sources/EntitiesMP/Player.es"
case PUIT_INVULNER : m_tmInvulnerability  = tmNow  + m_tmInvulnerabilityMax ;
#line 3371 "C:/MyMod/Sources/EntitiesMP/Player.es"
ItemPicked  (TRANS  ("^c00B440Invulnerability") , 0);
#line 3372 "C:/MyMod/Sources/EntitiesMP/Player.es"
return TRUE ;
#line 3373 "C:/MyMod/Sources/EntitiesMP/Player.es"
case PUIT_DAMAGE : m_tmSeriousDamage  = tmNow  + m_tmSeriousDamageMax ;
#line 3374 "C:/MyMod/Sources/EntitiesMP/Player.es"
ItemPicked  (TRANS  ("^cFF0000Serious Damage!") , 0);
#line 3375 "C:/MyMod/Sources/EntitiesMP/Player.es"
return TRUE ;
#line 3376 "C:/MyMod/Sources/EntitiesMP/Player.es"
case PUIT_SPEED : m_tmSeriousSpeed  = tmNow  + m_tmSeriousSpeedMax ;
#line 3377 "C:/MyMod/Sources/EntitiesMP/Player.es"
ItemPicked  (TRANS  ("^cFF9400Serious Speed") , 0);
#line 3378 "C:/MyMod/Sources/EntitiesMP/Player.es"
return TRUE ;
#line 3379 "C:/MyMod/Sources/EntitiesMP/Player.es"
case PUIT_BOMB : 
#line 3380 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_iSeriousBombCount  ++;
#line 3381 "C:/MyMod/Sources/EntitiesMP/Player.es"
ItemPicked  (TRANS  ("^cFF0000Serious Bomb!") , 0);
#line 3384 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(GetSP  () -> sp_bCooperative ){
#line 3385 "C:/MyMod/Sources/EntitiesMP/Player.es"
EComputerMessage  eMsg ;
#line 3386 "C:/MyMod/Sources/EntitiesMP/Player.es"
eMsg  . fnmMessage  = CTFILENAME  ("DataMP\\Messages\\Weapons\\seriousbomb.txt");
#line 3387 "C:/MyMod/Sources/EntitiesMP/Player.es"
this  -> SendEvent  (eMsg );
#line 3388 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3389 "C:/MyMod/Sources/EntitiesMP/Player.es"
return TRUE ;
#line 3390 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3391 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3394 "C:/MyMod/Sources/EntitiesMP/Player.es"
return FALSE ;
#line 3395 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 3400 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::ChangePlayerView() 
#line 3401 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 3403 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_iViewState  == PVT_PLAYEREYES ){
#line 3405 "C:/MyMod/Sources/EntitiesMP/Player.es"
ASSERT  (m_pen3rdPersonView  == NULL );
#line 3406 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_pen3rdPersonView  == NULL ){
#line 3407 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_pen3rdPersonView  = CreateEntity  (GetPlacement  () , CLASS_PLAYER_VIEW );
#line 3408 "C:/MyMod/Sources/EntitiesMP/Player.es"
EViewInit  eInit ;
#line 3409 "C:/MyMod/Sources/EntitiesMP/Player.es"
eInit  . penOwner  = this ;
#line 3410 "C:/MyMod/Sources/EntitiesMP/Player.es"
eInit  . penCamera  = NULL ;
#line 3411 "C:/MyMod/Sources/EntitiesMP/Player.es"
eInit  . vtView  = VT_3RDPERSONVIEW ;
#line 3412 "C:/MyMod/Sources/EntitiesMP/Player.es"
eInit  . bDeathFixed  = FALSE ;
#line 3413 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_pen3rdPersonView  -> Initialize  (eInit );
#line 3414 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3416 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_iViewState  = PVT_3RDPERSONVIEW ;
#line 3419 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else if(m_iViewState  == PVT_3RDPERSONVIEW ){
#line 3420 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_iViewState  = PVT_PLAYEREYES ;
#line 3423 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_pen3rdPersonView  != NULL ){
#line 3424 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerView  &) * m_pen3rdPersonView ) . SendEvent  (EEnd  ());
#line 3425 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_pen3rdPersonView  = NULL ;
#line 3426 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3427 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3428 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 3431 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::ComputerPressed(void) 
#line 3432 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 3435 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(cmp_ppenPlayer  == NULL  && _pNetwork  -> IsPlayerLocal  (this )){
#line 3436 "C:/MyMod/Sources/EntitiesMP/Player.es"
cmp_ppenPlayer  = this ;
#line 3437 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3438 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_bComputerInvoked  = TRUE ;
#line 3440 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_tmAnalyseEnd  = 0;
#line 3441 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_bPendingMessage  = FALSE ;
#line 3442 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_tmMessagePlay  = 0;
#line 3444 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 3448 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::UsePressed(BOOL bOrComputer) 
#line 3449 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 3451 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlayerWeapons  * penWeapons  = GetPlayerWeapons  ();
#line 3452 "C:/MyMod/Sources/EntitiesMP/Player.es"
CEntity  * pen  = penWeapons  -> m_penRayHit ;
#line 3453 "C:/MyMod/Sources/EntitiesMP/Player.es"
BOOL bSomethingToUse  = FALSE ;
#line 3456 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(pen  != NULL ){
#line 3458 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(IsOfClass  (pen  , "Moving Brush")){
#line 3459 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(((CMovingBrush  &) * pen ) . m_penSwitch  != NULL ){
#line 3460 "C:/MyMod/Sources/EntitiesMP/Player.es"
pen  = ((CMovingBrush  &) * pen ) . m_penSwitch ;
#line 3461 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3462 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3465 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(IsOfClass  (pen  , "Switch") && penWeapons  -> m_fRayHitDistance  < 2.0f){
#line 3466 "C:/MyMod/Sources/EntitiesMP/Player.es"
CSwitch  & enSwitch  = (CSwitch  &) * pen ;
#line 3468 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(enSwitch  . m_bUseable ){
#line 3470 "C:/MyMod/Sources/EntitiesMP/Player.es"
SendToTarget  (pen  , EET_TRIGGER  , this );
#line 3471 "C:/MyMod/Sources/EntitiesMP/Player.es"
bSomethingToUse  = TRUE ;
#line 3472 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3473 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3476 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(IsOfClass  (pen  , "MessageHolder") 
#line 3477 "C:/MyMod/Sources/EntitiesMP/Player.es"
&& penWeapons  -> m_fRayHitDistance  < ((CMessageHolder  *) & * pen ) -> m_fDistance  
#line 3478 "C:/MyMod/Sources/EntitiesMP/Player.es"
&& ((CMessageHolder  *) & * pen ) -> m_bActive ){
#line 3479 "C:/MyMod/Sources/EntitiesMP/Player.es"
const CTFileName & fnmMessage  = ((CMessageHolder  *) & * pen ) -> m_fnmMessage ;
#line 3481 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(! HasMessage  (fnmMessage )){
#line 3483 "C:/MyMod/Sources/EntitiesMP/Player.es"
ReceiveComputerMessage  (fnmMessage  , CMF_ANALYZE );
#line 3484 "C:/MyMod/Sources/EntitiesMP/Player.es"
bSomethingToUse  = TRUE ;
#line 3485 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3486 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3487 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3489 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(! bSomethingToUse  && bOrComputer ){
#line 3491 "C:/MyMod/Sources/EntitiesMP/Player.es"
ComputerPressed  ();
#line 3492 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3493 "C:/MyMod/Sources/EntitiesMP/Player.es"
else if(! bSomethingToUse )
#line 3494 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 3495 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlayerWeapons  * penWeapon  = GetPlayerWeapons  ();
#line 3499 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(penWeapon  -> m_iCurrentWeapon  == WEAPON_SNIPER  && 
#line 3500 "C:/MyMod/Sources/EntitiesMP/Player.es"
penWeapon  -> m_iWantedWeapon  == WEAPON_SNIPER ){
#line 3501 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_ulFlags  & PLF_ISZOOMING ){
#line 3502 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_ulFlags  &= ~ PLF_ISZOOMING ;
#line 3503 "C:/MyMod/Sources/EntitiesMP/Player.es"
penWeapon  -> m_bSniping  = FALSE ;
#line 3504 "C:/MyMod/Sources/EntitiesMP/Player.es"
penWeapon  -> m_fSniperFOVlast  = penWeapon  -> m_fSniperFOV  = penWeapon  -> m_fSniperMaxFOV ;
#line 3505 "C:/MyMod/Sources/EntitiesMP/Player.es"
PlaySound  (m_soSniperZoom  , SOUND_SILENCE  , SOF_3D );
#line 3506 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(_pNetwork  -> IsPlayerLocal  (this )){IFeel_StopEffect  ("SniperZoom");}
#line 3507 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3508 "C:/MyMod/Sources/EntitiesMP/Player.es"
else {
#line 3509 "C:/MyMod/Sources/EntitiesMP/Player.es"
penWeapon  -> m_bSniping  = TRUE ;
#line 3510 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_ulFlags  |= PLF_ISZOOMING ;
#line 3511 "C:/MyMod/Sources/EntitiesMP/Player.es"
penWeapon  -> m_fSniperFOVlast  = penWeapon  -> m_fSniperFOV  = penWeapon  -> m_fMinimumZoomFOV ;
#line 3512 "C:/MyMod/Sources/EntitiesMP/Player.es"
PlaySound  (m_soSniperZoom  , SOUND_SNIPER_ZOOM  , SOF_3D  | SOF_LOOP );
#line 3513 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(_pNetwork  -> IsPlayerLocal  (this )){IFeel_PlayEffect  ("SniperZoom");}
#line 3514 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3515 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3516 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3517 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 3523 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::SetGameEnd(void) 
#line 3524 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 3525 "C:/MyMod/Sources/EntitiesMP/Player.es"
_pNetwork  -> SetGameFinished  ();
#line 3527 "C:/MyMod/Sources/EntitiesMP/Player.es"
for(INDEX iPlayer  = 0;iPlayer  < GetMaxPlayers  ();iPlayer  ++){
#line 3528 "C:/MyMod/Sources/EntitiesMP/Player.es"
CEntity  * pen  = GetPlayerEntity  (iPlayer );
#line 3529 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(pen  != NULL ){
#line 3530 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(cmp_ppenPlayer  == NULL  && _pNetwork  -> IsPlayerLocal  (pen )){
#line 3531 "C:/MyMod/Sources/EntitiesMP/Player.es"
cmp_ppenPlayer  = (CPlayer  *) pen ;
#line 3532 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3533 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3534 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3535 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 3537 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::CheckGameEnd(void) 
#line 3538 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 3539 "C:/MyMod/Sources/EntitiesMP/Player.es"
BOOL bFinished  = FALSE ;
#line 3541 "C:/MyMod/Sources/EntitiesMP/Player.es"
INDEX iTimeLimit  = GetSP  () -> sp_iTimeLimit ;
#line 3542 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(iTimeLimit  > 0 && _pTimer  -> CurrentTick  () >= iTimeLimit  * 60.0f){
#line 3543 "C:/MyMod/Sources/EntitiesMP/Player.es"
bFinished  = TRUE ;
#line 3544 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3546 "C:/MyMod/Sources/EntitiesMP/Player.es"
INDEX iFragLimit  = GetSP  () -> sp_iFragLimit ;
#line 3547 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(iFragLimit  > 0 && m_psLevelStats  . ps_iKills  >= iFragLimit ){
#line 3548 "C:/MyMod/Sources/EntitiesMP/Player.es"
bFinished  = TRUE ;
#line 3549 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3551 "C:/MyMod/Sources/EntitiesMP/Player.es"
INDEX iScoreLimit  = GetSP  () -> sp_iScoreLimit ;
#line 3552 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(iScoreLimit  > 0 && m_psLevelStats  . ps_iScore  >= iScoreLimit ){
#line 3553 "C:/MyMod/Sources/EntitiesMP/Player.es"
bFinished  = TRUE ;
#line 3554 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3556 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(bFinished ){
#line 3557 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetGameEnd  ();
#line 3558 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3559 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 3562 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::PreapplyAction(const CPlayerAction & paAction) 
#line 3563 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 3564 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 3567 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::ApplyAction(const CPlayerAction & paOriginal,FLOAT tmLatency) 
#line 3568 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 3569 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(! (m_ulFlags  & PLF_INITIALIZED )){return ;}
#line 3573 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_ulFlags  & PLF_NOTCONNECTED ){
#line 3575 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetConnected  ();
#line 3576 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3578 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_ulFlags  |= PLF_APPLIEDACTION ;
#line 3581 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlayerAction  paAction  = paOriginal ;
#line 3586 "C:/MyMod/Sources/EntitiesMP/Player.es"
ANGLE3D aDeltaRotation  = paAction  . pa_aRotation  - m_aLastRotation ;
#line 3587 "C:/MyMod/Sources/EntitiesMP/Player.es"
ANGLE3D aDeltaViewRotation  = paAction  . pa_aViewRotation  - m_aLastViewRotation ;
#line 3589 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_ulFlags  & PLF_ISZOOMING ){
#line 3590 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fRotationDamping  = ((CPlayerWeapons  &) * m_penWeapons ) . m_fSniperFOV  / ((CPlayerWeapons  &) * m_penWeapons ) . m_fSniperMaxFOV ;
#line 3591 "C:/MyMod/Sources/EntitiesMP/Player.es"
aDeltaRotation  *= fRotationDamping ;
#line 3592 "C:/MyMod/Sources/EntitiesMP/Player.es"
aDeltaViewRotation  *= fRotationDamping ;
#line 3593 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3595 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_aLastRotation  = paAction  . pa_aRotation ;
#line 3596 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_aLastViewRotation  = paAction  . pa_aViewRotation ;
#line 3598 "C:/MyMod/Sources/EntitiesMP/Player.es"
paAction  . pa_aRotation  = aDeltaRotation ;
#line 3599 "C:/MyMod/Sources/EntitiesMP/Player.es"
paAction  . pa_aViewRotation  = aDeltaViewRotation ;
#line 3603 "C:/MyMod/Sources/EntitiesMP/Player.es"
paAction  . pa_aRotation  /= _pTimer  -> TickQuantum ;
#line 3604 "C:/MyMod/Sources/EntitiesMP/Player.es"
paAction  . pa_aViewRotation  /= _pTimer  -> TickQuantum ;
#line 3607 "C:/MyMod/Sources/EntitiesMP/Player.es"
CEntity  * penMe  = this ;
#line 3608 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(IsPredictor  ()){
#line 3609 "C:/MyMod/Sources/EntitiesMP/Player.es"
penMe  = penMe  -> GetPredicted  ();
#line 3610 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3611 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetPredictable  (! _pNetwork  -> IsPlayerLocal  (penMe ));
#line 3614 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(! IsPredictor  ()){
#line 3615 "C:/MyMod/Sources/EntitiesMP/Player.es"
CheckGameEnd  ();
#line 3616 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3619 "C:/MyMod/Sources/EntitiesMP/Player.es"
paAction  . pa_vTranslation  (1) = Clamp  (paAction  . pa_vTranslation  (1) , - plr_fSpeedSide  , plr_fSpeedSide );
#line 3620 "C:/MyMod/Sources/EntitiesMP/Player.es"
paAction  . pa_vTranslation  (2) = Clamp  (paAction  . pa_vTranslation  (2) , - plr_fSpeedUp  , plr_fSpeedUp );
#line 3621 "C:/MyMod/Sources/EntitiesMP/Player.es"
paAction  . pa_vTranslation  (3) = Clamp  (paAction  . pa_vTranslation  (3) , - plr_fSpeedForward  , plr_fSpeedBackward );
#line 3624 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(Abs  (paAction  . pa_vTranslation  (3)) < plr_fSpeedForward  / 1.99f 
#line 3625 "C:/MyMod/Sources/EntitiesMP/Player.es"
&& Abs  (paAction  . pa_vTranslation  (1)) < plr_fSpeedSide  / 1.99f){
#line 3627 "C:/MyMod/Sources/EntitiesMP/Player.es"
en_fStepDnHeight  = 1.5f;
#line 3630 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 3632 "C:/MyMod/Sources/EntitiesMP/Player.es"
en_fStepDnHeight  = - 1;
#line 3633 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3636 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT3D & v  = paAction  . pa_vTranslation ;
#line 3637 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fDiag  = Sqrt  (v  (1) * v  (1) + v  (3) * v  (3));
#line 3638 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(fDiag  > 0.01f){
#line 3639 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fDiagLimited  = Min  (fDiag  , plr_fSpeedForward );
#line 3640 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fFactor  = fDiagLimited  / fDiag ;
#line 3641 "C:/MyMod/Sources/EntitiesMP/Player.es"
v  (1) *= fFactor ;
#line 3642 "C:/MyMod/Sources/EntitiesMP/Player.es"
v  (3) *= fFactor ;
#line 3643 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3645 "C:/MyMod/Sources/EntitiesMP/Player.es"
ulButtonsNow  = paAction  . pa_ulButtons ;
#line 3646 "C:/MyMod/Sources/EntitiesMP/Player.es"
ulButtonsBefore  = m_ulLastButtons ;
#line 3647 "C:/MyMod/Sources/EntitiesMP/Player.es"
ulNewButtons  = ulButtonsNow  & ~ ulButtonsBefore ;
#line 3648 "C:/MyMod/Sources/EntitiesMP/Player.es"
ulReleasedButtons  = (~ ulButtonsNow ) & (ulButtonsBefore );
#line 3650 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_ulLastButtons  = ulButtonsNow ;
#line 3651 "C:/MyMod/Sources/EntitiesMP/Player.es"
en_plLastViewpoint  = en_plViewpoint ;
#line 3654 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlayerWeapons  * penWeapon  = GetPlayerWeapons  ();
#line 3655 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(penWeapon  -> m_iCurrentWeapon  == WEAPON_SNIPER )
#line 3656 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 3657 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(bUseButtonHeld  && m_ulFlags  & PLF_ISZOOMING )
#line 3658 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 3659 "C:/MyMod/Sources/EntitiesMP/Player.es"
penWeapon  -> m_fSniperFOVlast  = penWeapon  -> m_fSniperFOV ;
#line 3660 "C:/MyMod/Sources/EntitiesMP/Player.es"
penWeapon  -> m_fSniperFOV  -= penWeapon  -> m_fSnipingZoomSpeed ;
#line 3661 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(penWeapon  -> m_fSniperFOV  < penWeapon  -> m_fSniperMinFOV )
#line 3662 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 3663 "C:/MyMod/Sources/EntitiesMP/Player.es"
penWeapon  -> m_fSniperFOVlast  = penWeapon  -> m_fSniperFOV  = penWeapon  -> m_fSniperMinFOV ;
#line 3664 "C:/MyMod/Sources/EntitiesMP/Player.es"
PlaySound  (m_soSniperZoom  , SOUND_SILENCE  , SOF_3D );
#line 3665 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(_pNetwork  -> IsPlayerLocal  (this )){IFeel_StopEffect  ("SniperZoom");}
#line 3666 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3667 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3668 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(ulReleasedButtons  & PLACT_USE_HELD )
#line 3669 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 3670 "C:/MyMod/Sources/EntitiesMP/Player.es"
penWeapon  -> m_fSniperFOVlast  = penWeapon  -> m_fSniperFOV ;
#line 3671 "C:/MyMod/Sources/EntitiesMP/Player.es"
PlaySound  (m_soSniperZoom  , SOUND_SILENCE  , SOF_3D );
#line 3672 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(_pNetwork  -> IsPlayerLocal  (this )){IFeel_StopEffect  ("SniperZoom");}
#line 3673 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3674 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3677 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(GetFlags  () & ENF_ALIVE ){
#line 3679 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_penActionMarker  == NULL ){
#line 3681 "C:/MyMod/Sources/EntitiesMP/Player.es"
AliveActions  (paAction );
#line 3683 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 3685 "C:/MyMod/Sources/EntitiesMP/Player.es"
AutoActions  (paAction );
#line 3686 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3688 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 3689 "C:/MyMod/Sources/EntitiesMP/Player.es"
DeathActions  (paAction );
#line 3690 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3692 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(Abs  (_pTimer  -> CurrentTick  () - m_tmAnalyseEnd ) < _pTimer  -> TickQuantum  * 2){
#line 3693 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_tmAnalyseEnd  = 0;
#line 3694 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_bPendingMessage  = TRUE ;
#line 3695 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_tmMessagePlay  = 0;
#line 3696 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3697 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_bPendingMessage  && ! IsFuss  ()){
#line 3698 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_bPendingMessage  = FALSE ;
#line 3699 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_tmMessagePlay  = _pTimer  -> CurrentTick  () + 1.0f;
#line 3700 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_tmAnimateInbox  = _pTimer  -> CurrentTick  ();
#line 3701 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3702 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(Abs  (_pTimer  -> CurrentTick  () - m_tmMessagePlay ) < _pTimer  -> TickQuantum  * 2){
#line 3703 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_bPendingMessage  = FALSE ;
#line 3704 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_tmAnalyseEnd  = 0;
#line 3706 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(! m_bComputerInvoked  && GetSP  () -> sp_bSinglePlayer ){
#line 3707 "C:/MyMod/Sources/EntitiesMP/Player.es"
PrintCenterMessage  (this  , this  , 
#line 3708 "C:/MyMod/Sources/EntitiesMP/Player.es"
TRANS  ("Press USE to read the message!") , 5.0f , MSS_NONE );
#line 3709 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3710 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3713 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(CheatsEnabled  ()){
#line 3714 "C:/MyMod/Sources/EntitiesMP/Player.es"
Cheats  ();
#line 3715 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3718 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(cht_iGoToMarker  > 0 && (GetFlags  () & ENF_ALIVE )){
#line 3720 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_iLastViewState  = m_iViewState ;
#line 3721 "C:/MyMod/Sources/EntitiesMP/Player.es"
SendEvent  (ERebirth  ());
#line 3722 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3725 "C:/MyMod/Sources/EntitiesMP/Player.es"
UpdateLatency  (tmLatency );
#line 3728 "C:/MyMod/Sources/EntitiesMP/Player.es"
CheckHighScore  ();
#line 3729 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 3733 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::Disconnect(void) 
#line 3734 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 3736 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_strName  = GetPlayerName  ();
#line 3738 "C:/MyMod/Sources/EntitiesMP/Player.es"
en_pcCharacter  = CPlayerCharacter  ();
#line 3740 "C:/MyMod/Sources/EntitiesMP/Player.es"
SendEvent  (EDisconnected  ());
#line 3741 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 3744 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::CharacterChanged(const CPlayerCharacter & pcNew) 
#line 3745 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 3747 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlayerCharacter  pcOrg  = en_pcCharacter ;
#line 3750 "C:/MyMod/Sources/EntitiesMP/Player.es"
en_pcCharacter  = pcNew ;
#line 3751 "C:/MyMod/Sources/EntitiesMP/Player.es"
ValidateCharacter  ();
#line 3754 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(pcOrg  . GetName  () != pcNew  . GetName  ()){
#line 3756 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPrintF  (TRANS  ("%s is now known as %s\n") , 
#line 3757 "C:/MyMod/Sources/EntitiesMP/Player.es"
pcOrg  . GetNameForPrinting  () , pcNew  . GetNameForPrinting  ());
#line 3758 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3761 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(pcOrg  . GetTeam  () != pcNew  . GetTeam  ()){
#line 3763 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPrintF  (TRANS  ("%s switched to team %s\n") , 
#line 3764 "C:/MyMod/Sources/EntitiesMP/Player.es"
pcNew  . GetNameForPrinting  () , pcNew  . GetTeamForPrinting  ());
#line 3765 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3768 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlayerSettings  * ppsOrg  = (CPlayerSettings  *) pcOrg  . pc_aubAppearance ;
#line 3769 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlayerSettings  * ppsNew  = (CPlayerSettings  *) pcNew  . pc_aubAppearance ;
#line 3770 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(memcmp  (ppsOrg  -> ps_achModelFile  , ppsNew  -> ps_achModelFile  , sizeof  (ppsOrg  -> ps_achModelFile )) != 0){
#line 3772 "C:/MyMod/Sources/EntitiesMP/Player.es"
CTString strNewLook ;
#line 3773 "C:/MyMod/Sources/EntitiesMP/Player.es"
BOOL bSuccess  = SetPlayerAppearance  (& m_moRender  , & en_pcCharacter  , strNewLook  , FALSE );
#line 3775 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(bSuccess ){
#line 3776 "C:/MyMod/Sources/EntitiesMP/Player.es"
ParseGender  (strNewLook );
#line 3778 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPrintF  (TRANS  ("%s now appears as %s\n") , 
#line 3779 "C:/MyMod/Sources/EntitiesMP/Player.es"
pcNew  . GetNameForPrinting  () , strNewLook );
#line 3781 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 3783 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPrintF  (TRANS  ("Cannot change appearance for %s: setting '%s' is unavailable\n") , 
#line 3784 "C:/MyMod/Sources/EntitiesMP/Player.es"
pcNew  . GetNameForPrinting  () , (const char  *) ppsNew  -> GetModelFilename  ());
#line 3785 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3787 "C:/MyMod/Sources/EntitiesMP/Player.es"
GetPlayerAnimator  () -> SyncWeapon  ();
#line 3788 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3790 "C:/MyMod/Sources/EntitiesMP/Player.es"
BOOL b3RDPersonOld  = ppsOrg  -> ps_ulFlags  & PSF_PREFER3RDPERSON ;
#line 3791 "C:/MyMod/Sources/EntitiesMP/Player.es"
BOOL b3RDPersonNew  = ppsNew  -> ps_ulFlags  & PSF_PREFER3RDPERSON ;
#line 3792 "C:/MyMod/Sources/EntitiesMP/Player.es"
if((b3RDPersonOld  && ! b3RDPersonNew  && m_iViewState  == PVT_3RDPERSONVIEW ) 
#line 3793 "C:/MyMod/Sources/EntitiesMP/Player.es"
|| (b3RDPersonNew  && ! b3RDPersonOld  && m_iViewState  == PVT_PLAYEREYES )){
#line 3794 "C:/MyMod/Sources/EntitiesMP/Player.es"
ChangePlayerView  ();
#line 3795 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3796 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 3800 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::AliveActions(const CPlayerAction & pa) 
#line 3801 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 3802 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlayerAction  paAction  = pa ;
#line 3805 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_penCamera  != NULL ){
#line 3807 "C:/MyMod/Sources/EntitiesMP/Player.es"
paAction  . pa_vTranslation  = FLOAT3D (0 , 0 , 0);
#line 3808 "C:/MyMod/Sources/EntitiesMP/Player.es"
paAction  . pa_aRotation  = ANGLE3D (0 , 0 , 0);
#line 3809 "C:/MyMod/Sources/EntitiesMP/Player.es"
paAction  . pa_aViewRotation  = ANGLE3D (0 , 0 , 0);
#line 3811 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(ulNewButtons  & (PLACT_FIRE  | PLACT_USE )){
#line 3813 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_penCamera  = NULL ;
#line 3814 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3815 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 3816 "C:/MyMod/Sources/EntitiesMP/Player.es"
ButtonsActions  (paAction );
#line 3817 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3820 "C:/MyMod/Sources/EntitiesMP/Player.es"
ActiveActions  (paAction );
#line 3823 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT tmSinceWounding  = _pTimer  -> CurrentTick  () - m_tmWoundedTime ;
#line 3824 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(tmSinceWounding  < 4.0f){
#line 3826 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_fDamageAmmount  *= 1.0f - tmSinceWounding  / 4.0f;
#line 3827 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 3829 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_fDamageAmmount  = 0.0f;
#line 3830 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3831 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 3834 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::AutoActions(const CPlayerAction & pa) 
#line 3835 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 3837 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(ulNewButtons  & (PLACT_FIRE  | PLACT_USE  | PLACT_COMPUTER )){
#line 3838 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_penCamera  != NULL ){
#line 3839 "C:/MyMod/Sources/EntitiesMP/Player.es"
CEntity  * penOnBreak  = ((CCamera  &) * m_penCamera ) . m_penOnBreak ;
#line 3840 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(penOnBreak  != NULL ){
#line 3841 "C:/MyMod/Sources/EntitiesMP/Player.es"
SendToTarget  (penOnBreak  , EET_TRIGGER  , this );
#line 3842 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3843 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3844 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3846 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlayerAction  paAction  = pa ;
#line 3848 "C:/MyMod/Sources/EntitiesMP/Player.es"
paAction  . pa_vTranslation  = FLOAT3D (0 , 0 , 0);
#line 3849 "C:/MyMod/Sources/EntitiesMP/Player.es"
paAction  . pa_aRotation  = ANGLE3D (0 , 0 , 0);
#line 3850 "C:/MyMod/Sources/EntitiesMP/Player.es"
paAction  . pa_aViewRotation  = ANGLE3D (0 , 0 , 0);
#line 3853 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_fAutoSpeed  > 0){
#line 3854 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT3D vDelta  = 
#line 3855 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_penActionMarker  -> GetPlacement  () . pl_PositionVector  - 
#line 3856 "C:/MyMod/Sources/EntitiesMP/Player.es"
GetPlacement  () . pl_PositionVector ;
#line 3857 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fDistance  = vDelta  . Length  ();
#line 3858 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(fDistance  > 0.1f){
#line 3859 "C:/MyMod/Sources/EntitiesMP/Player.es"
vDelta  /= fDistance ;
#line 3860 "C:/MyMod/Sources/EntitiesMP/Player.es"
ANGLE aDH  = GetRelativeHeading  (vDelta );
#line 3863 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fSpeed  = m_fAutoSpeed ;
#line 3864 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(GetActionMarker  () -> m_paaAction  == PAA_RUNANDSTOP ){
#line 3866 "C:/MyMod/Sources/EntitiesMP/Player.es"
fSpeed  = Min  (fSpeed  , fDistance  / _pTimer  -> TickQuantum );
#line 3867 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3869 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(Abs  (aDH ) > 5.0f){
#line 3870 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(fSpeed  > m_fAutoSpeed  - 0.1f){
#line 3871 "C:/MyMod/Sources/EntitiesMP/Player.es"
aDH  = Clamp  (aDH  , - 30.0f , 30.0f);
#line 3872 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3873 "C:/MyMod/Sources/EntitiesMP/Player.es"
paAction  . pa_aRotation  = ANGLE3D (aDH  / _pTimer  -> TickQuantum  , 0 , 0);
#line 3874 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3876 "C:/MyMod/Sources/EntitiesMP/Player.es"
paAction  . pa_vTranslation  = FLOAT3D (0 , 0 , - fSpeed );
#line 3877 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3878 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 3879 "C:/MyMod/Sources/EntitiesMP/Player.es"
paAction  . pa_vTranslation  = m_vAutoSpeed ;
#line 3880 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3882 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlayerActionMarker  * ppam  = GetActionMarker  ();
#line 3883 "C:/MyMod/Sources/EntitiesMP/Player.es"
ASSERT  (ppam  != NULL );
#line 3884 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(ppam  -> m_paaAction  == PAA_LOGO_FIRE_MINIGUN  || ppam  -> m_paaAction  == PAA_LOGO_FIRE_INTROSE )
#line 3885 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 3886 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_tmMinigunAutoFireStart  != - 1)
#line 3887 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 3888 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT tmDelta  = _pTimer  -> CurrentTick  () - m_tmMinigunAutoFireStart ;
#line 3889 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT aDH  = 0.0f;
#line 3890 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT aDP  = 0.0f;
#line 3891 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(tmDelta  >= 0.0f && tmDelta  <= 0.75f)
#line 3892 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 3893 "C:/MyMod/Sources/EntitiesMP/Player.es"
aDH  = 0.0f;
#line 3894 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3895 "C:/MyMod/Sources/EntitiesMP/Player.es"
else if(tmDelta  >= 0.75f)
#line 3896 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 3897 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fDT  = tmDelta  - 0.75f;
#line 3898 "C:/MyMod/Sources/EntitiesMP/Player.es"
aDH  = 1.0f * cos  (fDT  + PI  / 2.0f);
#line 3899 "C:/MyMod/Sources/EntitiesMP/Player.es"
aDP  = 0.5f * cos  (fDT );
#line 3900 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3901 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(ppam  -> m_paaAction  == PAA_LOGO_FIRE_INTROSE )
#line 3902 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 3903 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fRatio  = CalculateRatio  (tmDelta  , 0.25 , 5 , 0.1f , 0.1f);
#line 3904 "C:/MyMod/Sources/EntitiesMP/Player.es"
aDP  = 2.0f * sin  (tmDelta  * 200.0f) * fRatio ;
#line 3905 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(tmDelta  > 2.5f)
#line 3906 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 3907 "C:/MyMod/Sources/EntitiesMP/Player.es"
aDP  += (tmDelta  - 2.5f) * 4.0f;
#line 3908 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3909 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3910 "C:/MyMod/Sources/EntitiesMP/Player.es"
paAction  . pa_aRotation  = ANGLE3D (aDH  / _pTimer  -> TickQuantum  , aDP  / _pTimer  -> TickQuantum  , 0);
#line 3911 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3912 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3915 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(! (m_ulFlags  & PLF_AUTOMOVEMENTS )){
#line 3916 "C:/MyMod/Sources/EntitiesMP/Player.es"
ActiveActions  (paAction );
#line 3917 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3918 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 3920 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::GetLerpedWeaponPosition(FLOAT3D vRel,CPlacement3D & pl) 
#line 3921 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 3922 "C:/MyMod/Sources/EntitiesMP/Player.es"
pl  = CPlacement3D (vRel  , ANGLE3D (0 , 0 , 0));
#line 3923 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlacement3D plView ;
#line 3924 "C:/MyMod/Sources/EntitiesMP/Player.es"
_bDiscard3rdView  = GetViewEntity  () != this ;
#line 3925 "C:/MyMod/Sources/EntitiesMP/Player.es"
GetLerpedAbsoluteViewPlacement  (plView );
#line 3926 "C:/MyMod/Sources/EntitiesMP/Player.es"
pl  . RelativeToAbsolute  (plView );
#line 3927 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 3929 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::SpawnBubbles(INDEX ctBubbles) 
#line 3930 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 3931 "C:/MyMod/Sources/EntitiesMP/Player.es"
for(INDEX iBouble  = 0;iBouble  < ctBubbles ;iBouble  ++)
#line 3932 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 3933 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT3D vRndRel  = FLOAT3D ((FRnd  () - 0.5f) * 0.25f , - 0.25f , - 0.5f + FRnd  () / 10.0f);
#line 3934 "C:/MyMod/Sources/EntitiesMP/Player.es"
ANGLE3D aDummy  = ANGLE3D (0 , 0 , 0);
#line 3935 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlacement3D plMouth  = CPlacement3D (vRndRel  , aDummy );
#line 3937 "C:/MyMod/Sources/EntitiesMP/Player.es"
plMouth  . RelativeToAbsolute  (en_plViewpoint );
#line 3938 "C:/MyMod/Sources/EntitiesMP/Player.es"
plMouth  . RelativeToAbsolute  (GetPlacement  ());
#line 3939 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT3D vRndSpd  = FLOAT3D ((FRnd  () - 0.5f) * 0.25f , (FRnd  () - 0.5f) * 0.25f , (FRnd  () - 0.5f) * 0.25f);
#line 3940 "C:/MyMod/Sources/EntitiesMP/Player.es"
AddBouble  (plMouth  . pl_PositionVector  , vRndSpd );
#line 3941 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3942 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 3944 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::PlayPowerUpSound(void) {
#line 3945 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_soPowerUpBeep  . Set3DParameters  (50.0f , 10.0f , 4.0f , 1.0f);
#line 3946 "C:/MyMod/Sources/EntitiesMP/Player.es"
PlaySound  (m_soPowerUpBeep  , SOUND_POWERUP_BEEP  , SOF_3D  | SOF_VOLUMETRIC  | SOF_LOCAL );
#line 3947 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 3949 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::ActiveActions(const CPlayerAction & paAction) 
#line 3950 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 3952 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT3D vTranslation  = paAction  . pa_vTranslation ;
#line 3954 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(cht_fTranslationMultiplier  && CheatsEnabled  ()){
#line 3955 "C:/MyMod/Sources/EntitiesMP/Player.es"
vTranslation  *= cht_fTranslationMultiplier ;
#line 3956 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3959 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(((CPlayerWeapons  &) * m_penWeapons ) . m_iCurrentWeapon  == WEAPON_KNIFE  && 
#line 3960 "C:/MyMod/Sources/EntitiesMP/Player.es"
! GetSP  () -> sp_bCooperative ){
#line 3961 "C:/MyMod/Sources/EntitiesMP/Player.es"
vTranslation  *= 1.3f;
#line 3962 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3965 "C:/MyMod/Sources/EntitiesMP/Player.es"
const TIME  tmDelta  = m_tmSeriousSpeed  - _pTimer  -> CurrentTick  ();
#line 3966 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(tmDelta  > 0 && m_fAutoSpeed  == 0.0f){
#line 3967 "C:/MyMod/Sources/EntitiesMP/Player.es"
vTranslation  (1) *= 2.0f;
#line 3968 "C:/MyMod/Sources/EntitiesMP/Player.es"
vTranslation  (3) *= 2.0f;
#line 3969 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3971 "C:/MyMod/Sources/EntitiesMP/Player.es"
en_fAcceleration  = plr_fAcceleration ;
#line 3972 "C:/MyMod/Sources/EntitiesMP/Player.es"
en_fDeceleration  = plr_fDeceleration ;
#line 3973 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(! GetSP  () -> sp_bCooperative )
#line 3974 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 3975 "C:/MyMod/Sources/EntitiesMP/Player.es"
vTranslation  (1) *= 1.35f;
#line 3976 "C:/MyMod/Sources/EntitiesMP/Player.es"
vTranslation  (3) *= 1.35f;
#line 3978 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 3980 "C:/MyMod/Sources/EntitiesMP/Player.es"
CContentType  & ctUp  = GetWorld  () -> wo_actContentTypes  [ en_iUpContent  ];
#line 3981 "C:/MyMod/Sources/EntitiesMP/Player.es"
CContentType  & ctDn  = GetWorld  () -> wo_actContentTypes  [ en_iDnContent  ];
#line 3982 "C:/MyMod/Sources/EntitiesMP/Player.es"
PlayerState  pstWanted  = PST_STAND ;
#line 3983 "C:/MyMod/Sources/EntitiesMP/Player.es"
BOOL bUpSwimable  = (ctUp  . ct_ulFlags  & CTF_SWIMABLE ) && en_fImmersionFactor  <= 0.99f;
#line 3984 "C:/MyMod/Sources/EntitiesMP/Player.es"
BOOL bDnSwimable  = (ctDn  . ct_ulFlags  & CTF_SWIMABLE ) && en_fImmersionFactor  >= 0.5f;
#line 3987 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(bUpSwimable  || bDnSwimable ){
#line 3989 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_ulFlags  |= PLF_JUMPALLOWED ;
#line 3992 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(en_fImmersionFactor  >= 0.99f || bUpSwimable ){
#line 3994 "C:/MyMod/Sources/EntitiesMP/Player.es"
pstWanted  = PST_DIVE ;
#line 3996 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 3998 "C:/MyMod/Sources/EntitiesMP/Player.es"
pstWanted  = PST_SWIM ;
#line 3999 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4001 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 4003 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(en_penReference  != NULL ){
#line 4005 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_fFallTime  = 0.0f;
#line 4008 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 4010 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_fFallTime  += _pTimer  -> TickQuantum ;
#line 4011 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4013 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(vTranslation  (2) < 0.1f){
#line 4015 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_ulFlags  |= PLF_JUMPALLOWED ;
#line 4016 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4019 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_fFallTime  >= 0.5f){
#line 4021 "C:/MyMod/Sources/EntitiesMP/Player.es"
pstWanted  = PST_FALL ;
#line 4023 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 4025 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(vTranslation  (2) < - 0.01f){
#line 4027 "C:/MyMod/Sources/EntitiesMP/Player.es"
pstWanted  = PST_CROUCH ;
#line 4029 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 4031 "C:/MyMod/Sources/EntitiesMP/Player.es"
pstWanted  = PST_STAND ;
#line 4032 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4033 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4034 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4038 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(! (GetPhysicsFlags  () & EPF_TRANSLATEDBYGRAVITY )){
#line 4039 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetDesiredRotation  (paAction  . pa_aRotation );
#line 4040 "C:/MyMod/Sources/EntitiesMP/Player.es"
StartModelAnim  (PLAYER_ANIM_STAND  , AOF_LOOPING  | AOF_NORESTART );
#line 4041 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetDesiredTranslation  (vTranslation );
#line 4043 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 4044 "C:/MyMod/Sources/EntitiesMP/Player.es"
PlayerState  pstOld  = m_pstState ;
#line 4047 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(pstWanted  != m_pstState ){
#line 4049 "C:/MyMod/Sources/EntitiesMP/Player.es"
switch(pstWanted ){
#line 4051 "C:/MyMod/Sources/EntitiesMP/Player.es"
case PST_STAND : {
#line 4053 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(ChangeCollisionBoxIndexNow  (PLAYER_COLLISION_BOX_STAND )){
#line 4054 "C:/MyMod/Sources/EntitiesMP/Player.es"
en_plViewpoint  . pl_PositionVector  (2) = plr_fViewHeightStand ;
#line 4055 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_pstState  == PST_CROUCH ){
#line 4056 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerAnimator  &) * m_penAnimator ) . Rise  ();
#line 4057 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 4058 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerAnimator  &) * m_penAnimator ) . Stand  ();
#line 4059 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4060 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_pstState  = PST_STAND ;
#line 4061 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4062 "C:/MyMod/Sources/EntitiesMP/Player.es"
}break ;
#line 4064 "C:/MyMod/Sources/EntitiesMP/Player.es"
case PST_CROUCH : {
#line 4066 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(ChangeCollisionBoxIndexNow  (PLAYER_COLLISION_BOX_CROUCH )){
#line 4067 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_pstState  = PST_CROUCH ;
#line 4068 "C:/MyMod/Sources/EntitiesMP/Player.es"
en_plViewpoint  . pl_PositionVector  (2) = plr_fViewHeightCrouch ;
#line 4069 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerAnimator  &) * m_penAnimator ) . Crouch  ();
#line 4070 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4071 "C:/MyMod/Sources/EntitiesMP/Player.es"
}break ;
#line 4073 "C:/MyMod/Sources/EntitiesMP/Player.es"
case PST_SWIM : {
#line 4075 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(ChangeCollisionBoxIndexNow  (PLAYER_COLLISION_BOX_SWIMSMALL )){
#line 4076 "C:/MyMod/Sources/EntitiesMP/Player.es"
ChangeCollisionBoxIndexWhenPossible  (PLAYER_COLLISION_BOX_SWIM );
#line 4077 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_pstState  = PST_SWIM ;
#line 4078 "C:/MyMod/Sources/EntitiesMP/Player.es"
en_plViewpoint  . pl_PositionVector  (2) = plr_fViewHeightSwim ;
#line 4079 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerAnimator  &) * m_penAnimator ) . Swim  ();
#line 4080 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_fSwimTime  = _pTimer  -> CurrentTick  ();
#line 4081 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4082 "C:/MyMod/Sources/EntitiesMP/Player.es"
}break ;
#line 4084 "C:/MyMod/Sources/EntitiesMP/Player.es"
case PST_DIVE : {
#line 4086 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(ChangeCollisionBoxIndexNow  (PLAYER_COLLISION_BOX_SWIMSMALL )){
#line 4087 "C:/MyMod/Sources/EntitiesMP/Player.es"
ChangeCollisionBoxIndexWhenPossible  (PLAYER_COLLISION_BOX_SWIM );
#line 4088 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_pstState  = PST_DIVE ;
#line 4089 "C:/MyMod/Sources/EntitiesMP/Player.es"
en_plViewpoint  . pl_PositionVector  (2) = plr_fViewHeightDive ;
#line 4090 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerAnimator  &) * m_penAnimator ) . Swim  ();
#line 4091 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4092 "C:/MyMod/Sources/EntitiesMP/Player.es"
}break ;
#line 4094 "C:/MyMod/Sources/EntitiesMP/Player.es"
case PST_FALL : {
#line 4096 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(ChangeCollisionBoxIndexNow  (PLAYER_COLLISION_BOX_STAND )){
#line 4097 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_pstState  = PST_FALL ;
#line 4098 "C:/MyMod/Sources/EntitiesMP/Player.es"
en_plViewpoint  . pl_PositionVector  (2) = plr_fViewHeightStand ;
#line 4099 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerAnimator  &) * m_penAnimator ) . Fall  ();
#line 4100 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4101 "C:/MyMod/Sources/EntitiesMP/Player.es"
}break ;
#line 4102 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4103 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4106 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_pstState  != pstOld ){
#line 4108 "C:/MyMod/Sources/EntitiesMP/Player.es"
BOOL bWasInWater  = (pstOld  == PST_SWIM  || pstOld  == PST_DIVE );
#line 4109 "C:/MyMod/Sources/EntitiesMP/Player.es"
BOOL bIsInWater  = (m_pstState  == PST_SWIM  || m_pstState  == PST_DIVE );
#line 4111 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(bIsInWater  && ! bWasInWater ){
#line 4112 "C:/MyMod/Sources/EntitiesMP/Player.es"
PlaySound  (m_soBody  , GenderSound  (SOUND_WATER_ENTER ) , SOF_3D );
#line 4114 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else if(! bIsInWater  && bWasInWater ){
#line 4115 "C:/MyMod/Sources/EntitiesMP/Player.es"
PlaySound  (m_soBody  , GenderSound  (SOUND_WATER_LEAVE ) , SOF_3D );
#line 4116 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_tmOutOfWater  = _pTimer  -> CurrentTick  ();
#line 4119 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else if(bIsInWater ){
#line 4121 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(pstOld  == PST_SWIM  && m_pstState  == PST_DIVE ){
#line 4122 "C:/MyMod/Sources/EntitiesMP/Player.es"
PlaySound  (m_soFootL  , GenderSound  (SOUND_DIVEIN ) , SOF_3D );
#line 4123 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(_pNetwork  -> IsPlayerLocal  (this )){IFeel_PlayEffect  ("DiveIn");}
#line 4124 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_bMoveSoundLeft  = TRUE ;
#line 4125 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_tmMoveSound  = _pTimer  -> CurrentTick  ();
#line 4127 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else if(m_pstState  == PST_SWIM  && pstOld  == PST_DIVE ){
#line 4128 "C:/MyMod/Sources/EntitiesMP/Player.es"
PlaySound  (m_soFootL  , GenderSound  (SOUND_DIVEOUT ) , SOF_3D );
#line 4129 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_bMoveSoundLeft  = TRUE ;
#line 4130 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_tmMoveSound  = _pTimer  -> CurrentTick  ();
#line 4131 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4132 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4134 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(pstOld  == PST_FALL  && (m_pstState  == PST_STAND  || m_pstState  == PST_CROUCH )){
#line 4135 "C:/MyMod/Sources/EntitiesMP/Player.es"
PlaySound  (m_soFootL  , GenderSound  (SOUND_LAND ) , SOF_3D );
#line 4136 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(_pNetwork  -> IsPlayerLocal  (this )){IFeel_PlayEffect  ("Land");}
#line 4137 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4139 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_pstState  == PST_DIVE ){
#line 4140 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_soLocalAmbientLoop  . Set3DParameters  (50.0f , 10.0f , 0.25f , 1.0f);
#line 4141 "C:/MyMod/Sources/EntitiesMP/Player.es"
PlaySound  (m_soLocalAmbientLoop  , SOUND_WATERAMBIENT  , 
#line 4142 "C:/MyMod/Sources/EntitiesMP/Player.es"
SOF_LOOP  | SOF_3D  | SOF_VOLUMETRIC  | SOF_LOCAL );
#line 4143 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else if(pstOld  == PST_DIVE ){
#line 4144 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_soLocalAmbientLoop  . Stop  ();
#line 4145 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4146 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4148 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(en_tmJumped  + _pTimer  -> TickQuantum  >= _pTimer  -> CurrentTick  () && 
#line 4149 "C:/MyMod/Sources/EntitiesMP/Player.es"
en_tmJumped  <= _pTimer  -> CurrentTick  () && en_penReference  == NULL ){
#line 4151 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetDefaultMouthPitch  ();
#line 4152 "C:/MyMod/Sources/EntitiesMP/Player.es"
PlaySound  (m_soMouth  , GenderSound  (SOUND_JUMP ) , SOF_3D );
#line 4153 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(_pNetwork  -> IsPlayerLocal  (this )){IFeel_PlayEffect  ("Jump");}
#line 4155 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_ulFlags  &= ~ PLF_JUMPALLOWED ;
#line 4156 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4159 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_pstState  == PST_SWIM  || pstWanted  == PST_SWIM  
#line 4160 "C:/MyMod/Sources/EntitiesMP/Player.es"
|| (pstWanted  == PST_DIVE  && m_pstState  != pstWanted )){
#line 4161 "C:/MyMod/Sources/EntitiesMP/Player.es"
en_fDensity  = 500.0f;
#line 4162 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 4163 "C:/MyMod/Sources/EntitiesMP/Player.es"
en_fDensity  = 1000.0f;
#line 4164 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4166 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(_pTimer  -> CurrentTick  () >= m_tmNextAmbientOnce )
#line 4167 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 4168 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_pstState  == PST_DIVE )
#line 4169 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 4170 "C:/MyMod/Sources/EntitiesMP/Player.es"
PlaySound  (m_soLocalAmbientOnce  , SOUND_WATERBUBBLES  , 
#line 4171 "C:/MyMod/Sources/EntitiesMP/Player.es"
SOF_3D  | SOF_VOLUMETRIC  | SOF_LOCAL );
#line 4172 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_soLocalAmbientOnce  . Set3DParameters  (25.0f , 5.0f , 2.0f , Lerp  (0.5f , 1.5f , FRnd  ()));
#line 4173 "C:/MyMod/Sources/EntitiesMP/Player.es"
SpawnBubbles  (5 + INDEX (FRnd  () * 5));
#line 4174 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4175 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_tmNextAmbientOnce  = _pTimer  -> CurrentTick  () + 5.0f + FRnd  ();
#line 4176 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4180 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_pstState  == PST_CROUCH ){
#line 4182 "C:/MyMod/Sources/EntitiesMP/Player.es"
vTranslation  /= 2.5f;
#line 4184 "C:/MyMod/Sources/EntitiesMP/Player.es"
vTranslation  (2) = 0.0f;
#line 4185 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4188 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_pstState  == PST_DIVE ){
#line 4190 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOATmatrix3D mPitch ;
#line 4191 "C:/MyMod/Sources/EntitiesMP/Player.es"
MakeRotationMatrixFast  (mPitch  , FLOAT3D (0 , en_plViewpoint  . pl_OrientationAngle  (2) , 0));
#line 4192 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fZ  = vTranslation  (3);
#line 4193 "C:/MyMod/Sources/EntitiesMP/Player.es"
vTranslation  (3) = 0.0f;
#line 4194 "C:/MyMod/Sources/EntitiesMP/Player.es"
vTranslation  += FLOAT3D (0 , 0 , fZ ) * mPitch ;
#line 4196 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else if(m_pstState  == PST_SWIM ){
#line 4198 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOATmatrix3D mPitch ;
#line 4199 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fPitch  = en_plViewpoint  . pl_OrientationAngle  (2);
#line 4200 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(fPitch  > - 30.0f){
#line 4201 "C:/MyMod/Sources/EntitiesMP/Player.es"
fPitch  = 0;
#line 4202 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4203 "C:/MyMod/Sources/EntitiesMP/Player.es"
MakeRotationMatrixFast  (mPitch  , FLOAT3D (0 , fPitch  , 0));
#line 4204 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fZ  = vTranslation  (3);
#line 4205 "C:/MyMod/Sources/EntitiesMP/Player.es"
vTranslation  (3) = 0.0f;
#line 4206 "C:/MyMod/Sources/EntitiesMP/Player.es"
vTranslation  += FLOAT3D (0 , 0 , fZ ) * mPitch ;
#line 4207 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4210 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_pstState  == PST_SWIM  || m_pstState  == PST_DIVE ){
#line 4212 "C:/MyMod/Sources/EntitiesMP/Player.es"
vTranslation  (2) *= 0.5f;
#line 4213 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4216 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_pstState  == PST_SWIM  && _pTimer  -> CurrentTick  () < m_fSwimTime  + 0.5f 
#line 4217 "C:/MyMod/Sources/EntitiesMP/Player.es"
|| _pTimer  -> CurrentTick  () < m_tmOutOfWater  + 0.5f){
#line 4219 "C:/MyMod/Sources/EntitiesMP/Player.es"
vTranslation  (2) = 0;
#line 4221 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4226 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(! (m_ulFlags  & PLF_JUMPALLOWED ) && vTranslation  (2) > 0){
#line 4227 "C:/MyMod/Sources/EntitiesMP/Player.es"
vTranslation  (2) = 0.0f;
#line 4228 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4231 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetDesiredTranslation  (vTranslation );
#line 4234 "C:/MyMod/Sources/EntitiesMP/Player.es"
en_plViewpoint  . Rotate_HPB  (ANGLE3D (
#line 4235 "C:/MyMod/Sources/EntitiesMP/Player.es"
(ANGLE) ((FLOAT) paAction  . pa_aRotation  (1) * _pTimer  -> TickQuantum ) , 
#line 4236 "C:/MyMod/Sources/EntitiesMP/Player.es"
(ANGLE) ((FLOAT) paAction  . pa_aRotation  (2) * _pTimer  -> TickQuantum ) , 
#line 4237 "C:/MyMod/Sources/EntitiesMP/Player.es"
(ANGLE) ((FLOAT) paAction  . pa_aRotation  (3) * _pTimer  -> TickQuantum )));
#line 4239 "C:/MyMod/Sources/EntitiesMP/Player.es"
RoundViewAngle  (en_plViewpoint  . pl_OrientationAngle  (2) , PITCH_MAX );
#line 4240 "C:/MyMod/Sources/EntitiesMP/Player.es"
RoundViewAngle  (en_plViewpoint  . pl_OrientationAngle  (3) , BANKING_MAX );
#line 4243 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(vTranslation  . Length  () > 0.1f){
#line 4244 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetDesiredRotation  (ANGLE3D (en_plViewpoint  . pl_OrientationAngle  (1) / _pTimer  -> TickQuantum  , 0.0f , 0.0f));
#line 4245 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_ulFlags  & PLF_VIEWROTATIONCHANGED ){
#line 4246 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_ulFlags  &= ~ PLF_VIEWROTATIONCHANGED ;
#line 4247 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOATmatrix3D mViewRot ;
#line 4248 "C:/MyMod/Sources/EntitiesMP/Player.es"
MakeRotationMatrixFast  (mViewRot  , ANGLE3D (en_plViewpoint  . pl_OrientationAngle  (1) , 0 , 0));
#line 4249 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT3D vTransRel  = vTranslation  * mViewRot ;
#line 4250 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetDesiredTranslation  (vTransRel );
#line 4251 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4252 "C:/MyMod/Sources/EntitiesMP/Player.es"
en_plViewpoint  . pl_OrientationAngle  (1) = 0.0f;
#line 4255 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 4256 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_ulFlags  |= PLF_VIEWROTATIONCHANGED ;
#line 4257 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetDesiredRotation  (ANGLE3D (0.0f , 0.0f , 0.0f));
#line 4258 "C:/MyMod/Sources/EntitiesMP/Player.es"
ANGLE aDiff  = en_plViewpoint  . pl_OrientationAngle  (1) - HEADING_MAX ;
#line 4259 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(aDiff  > 0.0f){
#line 4260 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetDesiredRotation  (ANGLE3D (aDiff  / _pTimer  -> TickQuantum  , 0.0f , 0.0f));
#line 4261 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4262 "C:/MyMod/Sources/EntitiesMP/Player.es"
aDiff  = en_plViewpoint  . pl_OrientationAngle  (1) + HEADING_MAX ;
#line 4263 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(aDiff  < 0.0f){
#line 4264 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetDesiredRotation  (ANGLE3D (aDiff  / _pTimer  -> TickQuantum  , 0.0f , 0.0f));
#line 4265 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4266 "C:/MyMod/Sources/EntitiesMP/Player.es"
RoundViewAngle  (en_plViewpoint  . pl_OrientationAngle  (1) , HEADING_MAX );
#line 4267 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4270 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fWantSpeed  = en_vDesiredTranslationRelative  . Length  ();
#line 4271 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fGoesSpeed  = en_vCurrentTranslationAbsolute  . Length  ();
#line 4272 "C:/MyMod/Sources/EntitiesMP/Player.es"
BOOL bOnGround  = (m_pstState  == PST_STAND ) || (m_pstState  == PST_CROUCH );
#line 4273 "C:/MyMod/Sources/EntitiesMP/Player.es"
BOOL bRunning  = bOnGround  && fWantSpeed  > 5.0f && fGoesSpeed  > 5.0f;
#line 4274 "C:/MyMod/Sources/EntitiesMP/Player.es"
BOOL bWalking  = bOnGround  && ! bRunning  && fWantSpeed  > 2.0f && fGoesSpeed  > 2.0f;
#line 4275 "C:/MyMod/Sources/EntitiesMP/Player.es"
BOOL bSwimming  = (m_pstState  == PST_SWIM ) && fWantSpeed  > 2.0f && fGoesSpeed  > 2.0f;
#line 4276 "C:/MyMod/Sources/EntitiesMP/Player.es"
BOOL bDiving  = (m_pstState  == PST_DIVE ) && fWantSpeed  > 2.0f && fGoesSpeed  > 2.0f;
#line 4277 "C:/MyMod/Sources/EntitiesMP/Player.es"
TIME  tmNow  = _pTimer  -> CurrentTick  ();
#line 4278 "C:/MyMod/Sources/EntitiesMP/Player.es"
INDEX iSoundWalkL  = SOUND_WALK_L ;
#line 4279 "C:/MyMod/Sources/EntitiesMP/Player.es"
INDEX iSoundWalkR  = SOUND_WALK_R ;
#line 4280 "C:/MyMod/Sources/EntitiesMP/Player.es"
if((ctDn  . ct_ulFlags  & CTF_SWIMABLE ) && en_fImmersionFactor  >= 0.1f){
#line 4281 "C:/MyMod/Sources/EntitiesMP/Player.es"
iSoundWalkL  = SOUND_WATERWALK_L ;
#line 4282 "C:/MyMod/Sources/EntitiesMP/Player.es"
iSoundWalkR  = SOUND_WATERWALK_R ;
#line 4283 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else if(en_pbpoStandOn  != NULL  && 
#line 4284 "C:/MyMod/Sources/EntitiesMP/Player.es"
en_pbpoStandOn  -> bpo_bppProperties  . bpp_ubSurfaceType  == SURFACE_SAND ){
#line 4285 "C:/MyMod/Sources/EntitiesMP/Player.es"
iSoundWalkL  = SOUND_WALK_SAND_L ;
#line 4286 "C:/MyMod/Sources/EntitiesMP/Player.es"
iSoundWalkR  = SOUND_WALK_SAND_R ;
#line 4287 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else if(en_pbpoStandOn  != NULL  && 
#line 4288 "C:/MyMod/Sources/EntitiesMP/Player.es"
en_pbpoStandOn  -> bpo_bppProperties  . bpp_ubSurfaceType  == SURFACE_RED_SAND ){
#line 4289 "C:/MyMod/Sources/EntitiesMP/Player.es"
iSoundWalkL  = SOUND_WALK_SAND_L ;
#line 4290 "C:/MyMod/Sources/EntitiesMP/Player.es"
iSoundWalkR  = SOUND_WALK_SAND_R ;
#line 4291 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else if(en_pbpoStandOn  != NULL  && 
#line 4292 "C:/MyMod/Sources/EntitiesMP/Player.es"
(en_pbpoStandOn  -> bpo_bppProperties  . bpp_ubSurfaceType  == SURFACE_GRASS  || 
#line 4293 "C:/MyMod/Sources/EntitiesMP/Player.es"
en_pbpoStandOn  -> bpo_bppProperties  . bpp_ubSurfaceType  == SURFACE_GRASS_SLIDING  || 
#line 4294 "C:/MyMod/Sources/EntitiesMP/Player.es"
en_pbpoStandOn  -> bpo_bppProperties  . bpp_ubSurfaceType  == SURFACE_GRASS_NOIMPACT )){
#line 4295 "C:/MyMod/Sources/EntitiesMP/Player.es"
iSoundWalkL  = SOUND_WALK_GRASS_L ;
#line 4296 "C:/MyMod/Sources/EntitiesMP/Player.es"
iSoundWalkR  = SOUND_WALK_GRASS_R ;
#line 4297 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else if(en_pbpoStandOn  != NULL  && 
#line 4298 "C:/MyMod/Sources/EntitiesMP/Player.es"
en_pbpoStandOn  -> bpo_bppProperties  . bpp_ubSurfaceType  == SURFACE_WOOD ){
#line 4299 "C:/MyMod/Sources/EntitiesMP/Player.es"
iSoundWalkL  = SOUND_WALK_WOOD_L ;
#line 4300 "C:/MyMod/Sources/EntitiesMP/Player.es"
iSoundWalkR  = SOUND_WALK_WOOD_R ;
#line 4301 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else if(en_pbpoStandOn  != NULL  && 
#line 4302 "C:/MyMod/Sources/EntitiesMP/Player.es"
en_pbpoStandOn  -> bpo_bppProperties  . bpp_ubSurfaceType  == SURFACE_SNOW ){
#line 4303 "C:/MyMod/Sources/EntitiesMP/Player.es"
iSoundWalkL  = SOUND_WALK_SNOW_L ;
#line 4304 "C:/MyMod/Sources/EntitiesMP/Player.es"
iSoundWalkR  = SOUND_WALK_SNOW_R ;
#line 4305 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4306 "C:/MyMod/Sources/EntitiesMP/Player.es"
else {
#line 4307 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4308 "C:/MyMod/Sources/EntitiesMP/Player.es"
iSoundWalkL  += m_iGender  * GENDEROFFSET ;
#line 4309 "C:/MyMod/Sources/EntitiesMP/Player.es"
iSoundWalkR  += m_iGender  * GENDEROFFSET ;
#line 4310 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(bRunning ){
#line 4311 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(tmNow  > m_tmMoveSound  + plr_fRunSoundDelay ){
#line 4312 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_tmMoveSound  = tmNow ;
#line 4313 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_bMoveSoundLeft  = ! m_bMoveSoundLeft ;
#line 4314 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_bMoveSoundLeft ){
#line 4315 "C:/MyMod/Sources/EntitiesMP/Player.es"
PlaySound  (m_soFootL  , iSoundWalkL  , SOF_3D );
#line 4316 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 4317 "C:/MyMod/Sources/EntitiesMP/Player.es"
PlaySound  (m_soFootR  , iSoundWalkR  , SOF_3D );
#line 4318 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4319 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4320 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else if(bWalking ){
#line 4321 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(tmNow  > m_tmMoveSound  + plr_fWalkSoundDelay ){
#line 4322 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_tmMoveSound  = tmNow ;
#line 4323 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_bMoveSoundLeft  = ! m_bMoveSoundLeft ;
#line 4324 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_bMoveSoundLeft ){
#line 4325 "C:/MyMod/Sources/EntitiesMP/Player.es"
PlaySound  (m_soFootL  , iSoundWalkL  , SOF_3D );
#line 4326 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 4327 "C:/MyMod/Sources/EntitiesMP/Player.es"
PlaySound  (m_soFootR  , iSoundWalkR  , SOF_3D );
#line 4328 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4329 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4330 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else if(bDiving ){
#line 4331 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(tmNow  > m_tmMoveSound  + plr_fDiveSoundDelay ){
#line 4332 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_tmMoveSound  = tmNow ;
#line 4333 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_bMoveSoundLeft  = ! m_bMoveSoundLeft ;
#line 4334 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_bMoveSoundLeft ){
#line 4335 "C:/MyMod/Sources/EntitiesMP/Player.es"
PlaySound  (m_soFootL  , GenderSound  (SOUND_DIVE_L ) , SOF_3D );
#line 4336 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 4337 "C:/MyMod/Sources/EntitiesMP/Player.es"
PlaySound  (m_soFootR  , GenderSound  (SOUND_DIVE_R ) , SOF_3D );
#line 4338 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4339 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4340 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else if(bSwimming ){
#line 4341 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(tmNow  > m_tmMoveSound  + plr_fSwimSoundDelay ){
#line 4342 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_tmMoveSound  = tmNow ;
#line 4343 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_bMoveSoundLeft  = ! m_bMoveSoundLeft ;
#line 4344 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_bMoveSoundLeft ){
#line 4345 "C:/MyMod/Sources/EntitiesMP/Player.es"
PlaySound  (m_soFootL  , GenderSound  (SOUND_SWIM_L ) , SOF_3D );
#line 4346 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 4347 "C:/MyMod/Sources/EntitiesMP/Player.es"
PlaySound  (m_soFootR  , GenderSound  (SOUND_SWIM_R ) , SOF_3D );
#line 4348 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4349 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4350 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4353 "C:/MyMod/Sources/EntitiesMP/Player.es"
TIME  tmBreathDelay  = tmNow  - en_tmLastBreathed ;
#line 4354 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(en_tmMaxHoldBreath  - tmBreathDelay  < 20.0f){
#line 4356 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_tmMouthSoundLast  + 2.0f < tmNow ){
#line 4357 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_tmMouthSoundLast  = tmNow ;
#line 4358 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetRandomMouthPitch  (0.9f , 1.1f);
#line 4359 "C:/MyMod/Sources/EntitiesMP/Player.es"
PlaySound  (m_soMouth  , GenderSound  (SOUND_DROWN ) , SOF_3D );
#line 4360 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4361 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4364 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerAnimator  &) * m_penAnimator ) . AnimatePlayer  ();
#line 4365 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4366 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 4369 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::RoundViewAngle(ANGLE & aViewAngle,ANGLE aRound) {
#line 4370 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(aViewAngle  > aRound ){
#line 4371 "C:/MyMod/Sources/EntitiesMP/Player.es"
aViewAngle  = aRound ;
#line 4372 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4373 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(aViewAngle  < - aRound ){
#line 4374 "C:/MyMod/Sources/EntitiesMP/Player.es"
aViewAngle  = - aRound ;
#line 4375 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4376 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 4379 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::DeathActions(const CPlayerAction & paAction) {
#line 4381 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_penView  != NULL ){
#line 4382 "C:/MyMod/Sources/EntitiesMP/Player.es"
ASSERT  (IsPredicted  () && m_penView  -> IsPredicted  () || IsPredictor  () && m_penView  -> IsPredictor  () || ! IsPredicted  () && ! m_penView  -> IsPredicted  () && ! IsPredictor  () && ! m_penView  -> IsPredictor  ());
#line 4383 "C:/MyMod/Sources/EntitiesMP/Player.es"
en_plViewpoint  . pl_PositionVector  = FLOAT3D (0 , 1 , 0);
#line 4384 "C:/MyMod/Sources/EntitiesMP/Player.es"
en_plViewpoint  . pl_OrientationAngle  += (ANGLE3D (
#line 4385 "C:/MyMod/Sources/EntitiesMP/Player.es"
(ANGLE) ((FLOAT) paAction  . pa_aRotation  (1) * _pTimer  -> TickQuantum ) , 
#line 4386 "C:/MyMod/Sources/EntitiesMP/Player.es"
(ANGLE) ((FLOAT) paAction  . pa_aRotation  (2) * _pTimer  -> TickQuantum ) , 
#line 4387 "C:/MyMod/Sources/EntitiesMP/Player.es"
(ANGLE) ((FLOAT) paAction  . pa_aRotation  (3) * _pTimer  -> TickQuantum )));
#line 4388 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4391 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_iMayRespawn  == 2 && (ulReleasedButtons  & PLACT_FIRE ) && ! IsPredictor  ()){
#line 4393 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(GetSP  () -> sp_bSinglePlayer ){
#line 4395 "C:/MyMod/Sources/EntitiesMP/Player.es"
_pShell  -> Execute  ("gam_bQuickLoad=1;");
#line 4397 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else if(! GetSP  () -> sp_bCooperative ){
#line 4399 "C:/MyMod/Sources/EntitiesMP/Player.es"
SendEvent  (EEnd  ());
#line 4401 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 4403 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_ulLastButtons  & PLACT_RELOAD ){
#line 4405 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_ulFlags  &= ~ PLF_RESPAWNINPLACE ;
#line 4406 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4408 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(GetSP  () -> sp_ctCredits  != 0){
#line 4410 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(GetSP  () -> sp_ctCredits  == - 1 || GetSP  () -> sp_ctCreditsLeft  != 0){
#line 4412 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(GetSP  () -> sp_ctCredits  != - 1){
#line 4413 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CSessionProperties  *) GetSP  ()) -> sp_ctCreditsLeft  --;
#line 4414 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4417 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPrintF  (TRANS  ("%s is riding the gun again\n") , GetPlayerName  ());
#line 4418 "C:/MyMod/Sources/EntitiesMP/Player.es"
SendEvent  (EEnd  ());
#line 4421 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(GetSP  () -> sp_ctCredits  > 0){
#line 4422 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(GetSP  () -> sp_ctCreditsLeft  == 0){
#line 4423 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPrintF  (TRANS  ("  no more credits left!\n"));
#line 4424 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 4425 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPrintF  (TRANS  ("  %d credits left\n") , GetSP  () -> sp_ctCreditsLeft );
#line 4426 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4427 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4429 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 4431 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPrintF  (TRANS  ("%s rests in peace - out of credits\n") , GetPlayerName  ());
#line 4432 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4433 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4434 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4435 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4437 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_iMayRespawn  == 1 && ! (ulButtonsNow  & PLACT_FIRE )){
#line 4438 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_iMayRespawn  = 2;
#line 4439 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4440 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 4444 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::ButtonsActions(CPlayerAction & paAction) 
#line 4445 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 4447 "C:/MyMod/Sources/EntitiesMP/Player.es"
if((ulNewButtons  & PLACT_SELECT_WEAPON_MASK ) != 0){
#line 4448 "C:/MyMod/Sources/EntitiesMP/Player.es"
ESelectWeapon  eSelect ;
#line 4449 "C:/MyMod/Sources/EntitiesMP/Player.es"
eSelect  . iWeapon  = (ulNewButtons  & PLACT_SELECT_WEAPON_MASK ) >> PLACT_SELECT_WEAPON_SHIFT ;
#line 4450 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerWeapons  &) * m_penWeapons ) . SendEvent  (eSelect );
#line 4451 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4454 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(ulNewButtons  & PLACT_WEAPON_NEXT ){
#line 4455 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(((CPlayerWeapons  &) * m_penWeapons ) . m_bSniping ){
#line 4456 "C:/MyMod/Sources/EntitiesMP/Player.es"
ApplySniperZoom  (0);
#line 4457 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else if(TRUE ){
#line 4458 "C:/MyMod/Sources/EntitiesMP/Player.es"
ESelectWeapon  eSelect ;
#line 4459 "C:/MyMod/Sources/EntitiesMP/Player.es"
eSelect  . iWeapon  = - 1;
#line 4460 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerWeapons  &) * m_penWeapons ) . SendEvent  (eSelect );
#line 4461 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4462 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4465 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(ulNewButtons  & PLACT_WEAPON_PREV ){
#line 4466 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(((CPlayerWeapons  &) * m_penWeapons ) . m_bSniping ){
#line 4467 "C:/MyMod/Sources/EntitiesMP/Player.es"
ApplySniperZoom  (1);
#line 4468 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else if(TRUE ){
#line 4469 "C:/MyMod/Sources/EntitiesMP/Player.es"
ESelectWeapon  eSelect ;
#line 4470 "C:/MyMod/Sources/EntitiesMP/Player.es"
eSelect  . iWeapon  = - 2;
#line 4471 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerWeapons  &) * m_penWeapons ) . SendEvent  (eSelect );
#line 4472 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4473 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4474 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(ulNewButtons  & PLACT_WEAPON_FLIP ){
#line 4475 "C:/MyMod/Sources/EntitiesMP/Player.es"
ESelectWeapon  eSelect ;
#line 4476 "C:/MyMod/Sources/EntitiesMP/Player.es"
eSelect  . iWeapon  = - 3;
#line 4477 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerWeapons  &) * m_penWeapons ) . SendEvent  (eSelect );
#line 4478 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4481 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(ulNewButtons  & PLACT_FIRE ){
#line 4482 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerWeapons  &) * m_penWeapons ) . SendEvent  (EFireWeapon  ());
#line 4483 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4485 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(ulReleasedButtons  & PLACT_FIRE ){
#line 4486 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerWeapons  &) * m_penWeapons ) . SendEvent  (EReleaseWeapon  ());
#line 4487 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4489 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(ulReleasedButtons  & PLACT_RELOAD ){
#line 4490 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerWeapons  &) * m_penWeapons ) . SendEvent  (EReloadWeapon  ());
#line 4491 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4493 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(ulNewButtons  & PLACT_FIREBOMB ){
#line 4494 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_iSeriousBombCount  > 0 && m_tmSeriousBombFired  + 4.0f < _pTimer  -> CurrentTick  ()){
#line 4495 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_iLastSeriousBombCount  = m_iSeriousBombCount ;
#line 4496 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_iSeriousBombCount  --;
#line 4497 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_tmSeriousBombFired  = _pTimer  -> CurrentTick  ();
#line 4499 "C:/MyMod/Sources/EntitiesMP/Player.es"
ESeriousBomb  esb ;
#line 4500 "C:/MyMod/Sources/EntitiesMP/Player.es"
esb  . penOwner  = this ;
#line 4501 "C:/MyMod/Sources/EntitiesMP/Player.es"
CEntityPointer penBomb  = CreateEntity  (GetPlacement  () , CLASS_SERIOUSBOMB );
#line 4502 "C:/MyMod/Sources/EntitiesMP/Player.es"
penBomb  -> Initialize  (esb );
#line 4503 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4504 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4509 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(ulNewButtons  & PLACT_USE ){
#line 4510 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(((CPlayerWeapons  &) * m_penWeapons ) . m_iCurrentWeapon  == WEAPON_SNIPER ){
#line 4511 "C:/MyMod/Sources/EntitiesMP/Player.es"
UsePressed  (FALSE );
#line 4512 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 4513 "C:/MyMod/Sources/EntitiesMP/Player.es"
UsePressed  (ulNewButtons  & PLACT_COMPUTER );
#line 4514 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4516 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else if(ulNewButtons  & PLACT_SNIPER_USE  && ((CPlayerWeapons  &) * m_penWeapons ) . m_iCurrentWeapon  == WEAPON_SNIPER ){
#line 4517 "C:/MyMod/Sources/EntitiesMP/Player.es"
UsePressed  (FALSE );
#line 4519 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else if(ulNewButtons  & PLACT_COMPUTER ){
#line 4520 "C:/MyMod/Sources/EntitiesMP/Player.es"
ComputerPressed  ();
#line 4521 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4524 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(ulNewButtons  & PLACT_USE_HELD ){
#line 4525 "C:/MyMod/Sources/EntitiesMP/Player.es"
bUseButtonHeld  = TRUE ;
#line 4526 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4529 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(ulReleasedButtons  & PLACT_USE_HELD ){
#line 4530 "C:/MyMod/Sources/EntitiesMP/Player.es"
bUseButtonHeld  = FALSE ;
#line 4531 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4534 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(ulNewButtons  & PLACT_SNIPER_ZOOMIN ){
#line 4535 "C:/MyMod/Sources/EntitiesMP/Player.es"
ApplySniperZoom  (1);
#line 4536 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4539 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(ulNewButtons  & PLACT_SNIPER_ZOOMOUT ){
#line 4540 "C:/MyMod/Sources/EntitiesMP/Player.es"
ApplySniperZoom  (0);
#line 4541 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4544 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(ulNewButtons  & PLACT_3RD_PERSON_VIEW ){
#line 4545 "C:/MyMod/Sources/EntitiesMP/Player.es"
ChangePlayerView  ();
#line 4546 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4549 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(ulButtonsNow  & PLACT_CENTER_VIEW ){
#line 4551 "C:/MyMod/Sources/EntitiesMP/Player.es"
paAction  . pa_aRotation  (2) += Clamp  (- en_plViewpoint  . pl_OrientationAngle  (2) / _pTimer  -> TickQuantum  , - 900.0f , + 900.0f);
#line 4552 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4553 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 4555 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::ApplySniperZoom(BOOL bZoomIn) 
#line 4556 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 4558 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(((CPlayerWeapons  &) * m_penWeapons ) . m_iCurrentWeapon  != WEAPON_SNIPER  || 
#line 4559 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerWeapons  &) * m_penWeapons ) . m_bSniping  == FALSE ){
#line 4560 "C:/MyMod/Sources/EntitiesMP/Player.es"
return ;
#line 4561 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4562 "C:/MyMod/Sources/EntitiesMP/Player.es"
BOOL bZoomChanged ;
#line 4563 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(((CPlayerWeapons  &) * m_penWeapons ) . SniperZoomDiscrete  (bZoomIn  , bZoomChanged )){
#line 4564 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(bZoomChanged ){
#line 4565 "C:/MyMod/Sources/EntitiesMP/Player.es"
PlaySound  (m_soSniperZoom  , SOUND_SNIPER_QZOOM  , SOF_3D );
#line 4566 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4567 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_ulFlags  |= PLF_ISZOOMING ;
#line 4568 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4569 "C:/MyMod/Sources/EntitiesMP/Player.es"
else 
#line 4570 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 4571 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_ulFlags  &= ~ PLF_ISZOOMING ;
#line 4572 "C:/MyMod/Sources/EntitiesMP/Player.es"
PlaySound  (m_soSniperZoom  , SOUND_SILENCE  , SOF_3D );
#line 4573 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(_pNetwork  -> IsPlayerLocal  (this )){IFeel_StopEffect  ("SniperZoom");}
#line 4574 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4575 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 4578 "C:/MyMod/Sources/EntitiesMP/Player.es"
BOOL CPlayer::CheatsEnabled(void) 
#line 4579 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 4580 "C:/MyMod/Sources/EntitiesMP/Player.es"
return (GetSP  () -> sp_ctMaxPlayers  == 1 || GetSP  () -> sp_bQuickTest ) && m_penActionMarker  == NULL  && ! _SE_DEMO ;
#line 4581 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 4584 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::Cheats(void) 
#line 4585 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 4586 "C:/MyMod/Sources/EntitiesMP/Player.es"
BOOL bFlyOn  = cht_bFly  || cht_bGhost ;
#line 4588 "C:/MyMod/Sources/EntitiesMP/Player.es"
BOOL bIsFlying  = ! (GetPhysicsFlags  () & EPF_TRANSLATEDBYGRAVITY );
#line 4589 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(bFlyOn  && ! bIsFlying ){
#line 4590 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetPhysicsFlags  (GetPhysicsFlags  () & ~ (EPF_TRANSLATEDBYGRAVITY  | EPF_ORIENTEDBYGRAVITY ));
#line 4591 "C:/MyMod/Sources/EntitiesMP/Player.es"
en_plViewpoint  . pl_OrientationAngle  = ANGLE3D (0 , 0 , 0);
#line 4592 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else if(! bFlyOn  && bIsFlying ){
#line 4593 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetPhysicsFlags  (GetPhysicsFlags  () | EPF_TRANSLATEDBYGRAVITY  | EPF_ORIENTEDBYGRAVITY );
#line 4594 "C:/MyMod/Sources/EntitiesMP/Player.es"
en_plViewpoint  . pl_OrientationAngle  = ANGLE3D (0 , 0 , 0);
#line 4595 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4598 "C:/MyMod/Sources/EntitiesMP/Player.es"
BOOL bIsGhost  = ! (GetCollisionFlags  () & ((ECBI_BRUSH  | ECBI_MODEL ) << ECB_TEST ));
#line 4599 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(cht_bGhost  && ! bIsGhost ){
#line 4600 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetCollisionFlags  (GetCollisionFlags  () & ~ ((ECBI_BRUSH  | ECBI_MODEL ) << ECB_TEST ));
#line 4601 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else if(! cht_bGhost  && bIsGhost ){
#line 4602 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetCollisionFlags  (GetCollisionFlags  () | ((ECBI_BRUSH  | ECBI_MODEL ) << ECB_TEST ));
#line 4603 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4606 "C:/MyMod/Sources/EntitiesMP/Player.es"
const TIME  tmDelta  = m_tmInvisibility  - _pTimer  -> CurrentTick  ();
#line 4607 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(cht_bInvisible  || tmDelta  > 0){
#line 4608 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetFlags  (GetFlags  () | ENF_INVISIBLE );
#line 4609 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 4610 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetFlags  (GetFlags  () & ~ ENF_INVISIBLE );
#line 4611 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4614 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(cht_bGiveAll ){
#line 4615 "C:/MyMod/Sources/EntitiesMP/Player.es"
cht_bGiveAll  = FALSE ;
#line 4616 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerWeapons  &) * m_penWeapons ) . CheatGiveAll  ();
#line 4617 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4619 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(cht_bKillAll ){
#line 4620 "C:/MyMod/Sources/EntitiesMP/Player.es"
cht_bKillAll  = FALSE ;
#line 4621 "C:/MyMod/Sources/EntitiesMP/Player.es"
KillAllEnemies  (this );
#line 4622 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4624 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(cht_bOpen ){
#line 4625 "C:/MyMod/Sources/EntitiesMP/Player.es"
cht_bOpen  = FALSE ;
#line 4626 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerWeapons  &) * m_penWeapons ) . CheatOpen  ();
#line 4627 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4629 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(cht_bAllMessages ){
#line 4630 "C:/MyMod/Sources/EntitiesMP/Player.es"
cht_bAllMessages  = FALSE ;
#line 4631 "C:/MyMod/Sources/EntitiesMP/Player.es"
CheatAllMessages  ();
#line 4632 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4634 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(cht_bRefresh ){
#line 4635 "C:/MyMod/Sources/EntitiesMP/Player.es"
cht_bRefresh  = FALSE ;
#line 4636 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetHealth  (TopHealth  ());
#line 4637 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4638 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 4647 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::GetLerpedAbsoluteViewPlacement(CPlacement3D & plView) {
#line 4648 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(! (m_ulFlags  & PLF_INITIALIZED )){
#line 4649 "C:/MyMod/Sources/EntitiesMP/Player.es"
plView  = GetPlacement  ();
#line 4650 "C:/MyMod/Sources/EntitiesMP/Player.es"
_bDiscard3rdView  = FALSE ;
#line 4651 "C:/MyMod/Sources/EntitiesMP/Player.es"
return ;
#line 4652 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4654 "C:/MyMod/Sources/EntitiesMP/Player.es"
BOOL bSharpTurning  = 
#line 4655 "C:/MyMod/Sources/EntitiesMP/Player.es"
(GetSettings  () -> ps_ulFlags  & PSF_SHARPTURNING ) && 
#line 4656 "C:/MyMod/Sources/EntitiesMP/Player.es"
_pNetwork  -> IsPlayerLocal  ((CPlayer  *) GetPredictionTail  ());
#line 4659 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fLerpFactor  = _pTimer  -> GetLerpFactor  ();
#line 4660 "C:/MyMod/Sources/EntitiesMP/Player.es"
plView  . Lerp  (en_plLastViewpoint  , en_plViewpoint  , fLerpFactor );
#line 4663 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerAnimator  &) * m_penAnimator ) . ChangeView  (plView );
#line 4665 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerAnimator  &) * m_penAnimator ) . BodyAndHeadOrientation  (plView );
#line 4668 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_iViewState  == PVT_PLAYEREYES  || _bDiscard3rdView ){
#line 4669 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlacement3D plPosLerped  = GetLerpedPlacement  ();
#line 4670 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(bSharpTurning ){
#line 4672 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlayer  * pen  = (CPlayer  *) GetPredictionTail  ();
#line 4674 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_ulFlags  & PLF_ISZOOMING ){
#line 4675 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fRotationDamping  = ((CPlayerWeapons  &) * m_penWeapons ) . m_fSniperFOV  / ((CPlayerWeapons  &) * m_penWeapons ) . m_fSniperMaxFOV ;
#line 4676 "C:/MyMod/Sources/EntitiesMP/Player.es"
plView  . pl_OrientationAngle  = pen  -> en_plViewpoint  . pl_OrientationAngle  + (pen  -> m_aLocalRotation  - pen  -> m_aLastRotation ) * fRotationDamping ;
#line 4677 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 4678 "C:/MyMod/Sources/EntitiesMP/Player.es"
plView  . pl_OrientationAngle  = pen  -> en_plViewpoint  . pl_OrientationAngle  + (pen  -> m_aLocalRotation  - pen  -> m_aLastRotation );
#line 4679 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4681 "C:/MyMod/Sources/EntitiesMP/Player.es"
RoundViewAngle  (plView  . pl_OrientationAngle  (2) , PITCH_MAX );
#line 4682 "C:/MyMod/Sources/EntitiesMP/Player.es"
RoundViewAngle  (plView  . pl_OrientationAngle  (3) , BANKING_MAX );
#line 4687 "C:/MyMod/Sources/EntitiesMP/Player.es"
ANGLE3D aCurr  = pen  -> GetPlacement  () . pl_OrientationAngle ;
#line 4688 "C:/MyMod/Sources/EntitiesMP/Player.es"
ANGLE3D aLast  = pen  -> en_plLastPlacement  . pl_OrientationAngle ;
#line 4689 "C:/MyMod/Sources/EntitiesMP/Player.es"
ANGLE3D aDesired  = pen  -> en_aDesiredRotationRelative  * _pTimer  -> TickQuantum ;
#line 4690 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOATmatrix3D mCurr ;MakeRotationMatrixFast  (mCurr  , aCurr );
#line 4691 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOATmatrix3D mLast ;MakeRotationMatrixFast  (mLast  , aLast );
#line 4692 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOATmatrix3D mDesired ;MakeRotationMatrixFast  (mDesired  , aDesired );
#line 4693 "C:/MyMod/Sources/EntitiesMP/Player.es"
mDesired  = en_mRotation  * (mDesired  * ! en_mRotation );
#line 4694 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOATmatrix3D mForced  = ! mDesired  * mCurr  * ! mLast ;
#line 4695 "C:/MyMod/Sources/EntitiesMP/Player.es"
ANGLE3D aForced ;DecomposeRotationMatrixNoSnap  (aForced  , mForced );
#line 4696 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(aForced  . MaxNorm  () < 1E-2){
#line 4697 "C:/MyMod/Sources/EntitiesMP/Player.es"
aForced  = ANGLE3D (0 , 0 , 0);
#line 4698 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4699 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOATquat3D qForced ;qForced  . FromEuler  (aForced );
#line 4700 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOATquat3D qZero ;qZero  . FromEuler  (ANGLE3D (0 , 0 , 0));
#line 4701 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOATquat3D qLerped  = Slerp  (fLerpFactor  , qZero  , qForced );
#line 4702 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOATmatrix3D m ;
#line 4703 "C:/MyMod/Sources/EntitiesMP/Player.es"
qLerped  . ToMatrix  (m );
#line 4704 "C:/MyMod/Sources/EntitiesMP/Player.es"
m  = m  * mDesired  * mLast ;
#line 4705 "C:/MyMod/Sources/EntitiesMP/Player.es"
DecomposeRotationMatrixNoSnap  (plPosLerped  . pl_OrientationAngle  , m );
#line 4706 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4707 "C:/MyMod/Sources/EntitiesMP/Player.es"
plView  . RelativeToAbsoluteSmooth  (plPosLerped );
#line 4709 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else if(m_iViewState  == PVT_3RDPERSONVIEW ){
#line 4710 "C:/MyMod/Sources/EntitiesMP/Player.es"
plView  = m_pen3rdPersonView  -> GetLerpedPlacement  ();
#line 4712 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else if(m_iViewState  == PVT_PLAYERAUTOVIEW ){
#line 4713 "C:/MyMod/Sources/EntitiesMP/Player.es"
plView  = m_penView  -> GetLerpedPlacement  ();
#line 4715 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 4716 "C:/MyMod/Sources/EntitiesMP/Player.es"
ASSERTALWAYS  ("Unknown player view");
#line 4717 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4718 "C:/MyMod/Sources/EntitiesMP/Player.es"
_bDiscard3rdView  = FALSE ;
#line 4719 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 4722 "C:/MyMod/Sources/EntitiesMP/Player.es"
CEntity * CPlayer::GetViewEntity(void) {
#line 4724 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_iViewState  == PVT_PLAYEREYES ){
#line 4725 "C:/MyMod/Sources/EntitiesMP/Player.es"
return this ;
#line 4727 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else if(m_iViewState  == PVT_3RDPERSONVIEW ){
#line 4728 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_ulFlags  & PLF_ISZOOMING ){
#line 4729 "C:/MyMod/Sources/EntitiesMP/Player.es"
return this ;
#line 4730 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4731 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(((CPlayerView  &) * m_pen3rdPersonView ) . m_fDistance  > 2.0f){
#line 4732 "C:/MyMod/Sources/EntitiesMP/Player.es"
return m_pen3rdPersonView ;
#line 4733 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 4734 "C:/MyMod/Sources/EntitiesMP/Player.es"
return this ;
#line 4735 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4737 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else if(m_iViewState  == PVT_PLAYERAUTOVIEW ){
#line 4738 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(((CPlayerView  &) * m_penView ) . m_fDistance  > 2.0f){
#line 4739 "C:/MyMod/Sources/EntitiesMP/Player.es"
return m_penView ;
#line 4740 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 4741 "C:/MyMod/Sources/EntitiesMP/Player.es"
return this ;
#line 4742 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4744 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 4745 "C:/MyMod/Sources/EntitiesMP/Player.es"
ASSERTALWAYS  ("Unknown player view");
#line 4746 "C:/MyMod/Sources/EntitiesMP/Player.es"
return NULL ;
#line 4747 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4748 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 4750 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::RenderChainsawParticles(BOOL bThird) 
#line 4751 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 4752 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fStretch  = 1.0f;
#line 4753 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(bThird )
#line 4754 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 4755 "C:/MyMod/Sources/EntitiesMP/Player.es"
fStretch  = 0.4f;
#line 4756 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4758 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT tmNow  = _pTimer  -> GetLerpedCurrentTick  ();
#line 4759 "C:/MyMod/Sources/EntitiesMP/Player.es"
for(INDEX iSpray  = 0;iSpray  < MAX_BULLET_SPRAYS ;iSpray  ++)
#line 4760 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 4761 "C:/MyMod/Sources/EntitiesMP/Player.es"
BulletSprayLaunchData  & bsld  = m_absldData  [ iSpray  ];
#line 4762 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fLife  = 1.25f;
#line 4763 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(tmNow  > (bsld  . bsld_tmLaunch  + fLife )){continue ;}
#line 4764 "C:/MyMod/Sources/EntitiesMP/Player.es"
Particles_BulletSpray  (bsld  . bsld_iRndBase  , bsld  . bsld_vPos  , bsld  . bsld_vG  , 
#line 4765 "C:/MyMod/Sources/EntitiesMP/Player.es"
bsld  . bsld_eptType  , bsld  . bsld_tmLaunch  , bsld  . bsld_vStretch  * fStretch  , 1.0f);
#line 4766 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4769 "C:/MyMod/Sources/EntitiesMP/Player.es"
for(INDEX iGore  = 0;iGore  < MAX_GORE_SPRAYS ;iGore  ++)
#line 4770 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 4771 "C:/MyMod/Sources/EntitiesMP/Player.es"
GoreSprayLaunchData  & gsld  = m_agsldData  [ iGore  ];
#line 4772 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fLife  = 2.0f;
#line 4773 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(tmNow  > (gsld  . gsld_tmLaunch  + fLife )){continue ;}
#line 4774 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT3D vPos  = gsld  . gsld_vPos ;
#line 4775 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(bThird )
#line 4776 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 4777 "C:/MyMod/Sources/EntitiesMP/Player.es"
vPos  = gsld  . gsld_v3rdPos ;
#line 4778 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4779 "C:/MyMod/Sources/EntitiesMP/Player.es"
Particles_BloodSpray  (gsld  . gsld_sptType  , vPos  , gsld  . gsld_vG  , gsld  . gsld_fGA  , 
#line 4780 "C:/MyMod/Sources/EntitiesMP/Player.es"
gsld  . gsld_boxHitted  , gsld  . gsld_vSpilDirection  , 
#line 4781 "C:/MyMod/Sources/EntitiesMP/Player.es"
gsld  . gsld_tmLaunch  , gsld  . gsld_fDamagePower  * fStretch  , gsld  . gsld_colParticles );
#line 4782 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4783 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 4786 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::RenderHUD(CPerspectiveProjection3D & prProjection,CDrawPort * pdp,
#line 4787 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT3D vViewerLightDirection,COLOR colViewerLight,COLOR colViewerAmbient,
#line 4788 "C:/MyMod/Sources/EntitiesMP/Player.es"
BOOL bRenderWeapon,INDEX iEye) 
#line 4789 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 4790 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlacement3D plViewOld  = prProjection  . ViewerPlacementR  ();
#line 4791 "C:/MyMod/Sources/EntitiesMP/Player.es"
BOOL bSniping  = ((CPlayerWeapons  &) * m_penWeapons ) . m_bSniping ;
#line 4794 "C:/MyMod/Sources/EntitiesMP/Player.es"
BOOL bRenderModels  = _pShell  -> GetINDEX  ("gfx_bRenderModels");
#line 4795 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(hud_bShowWeapon  && bRenderModels  && ! bSniping ){
#line 4797 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerWeapons  &) * m_penWeapons ) . RenderWeaponModel  (prProjection  , pdp  , 
#line 4798 "C:/MyMod/Sources/EntitiesMP/Player.es"
vViewerLightDirection  , colViewerLight  , colViewerAmbient  , bRenderWeapon  , iEye );
#line 4799 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4802 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_iViewState  == PVT_PLAYEREYES )
#line 4803 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 4804 "C:/MyMod/Sources/EntitiesMP/Player.es"
prProjection  . ViewerPlacementL  () = plViewOld ;
#line 4805 "C:/MyMod/Sources/EntitiesMP/Player.es"
prProjection  . Prepare  ();
#line 4806 "C:/MyMod/Sources/EntitiesMP/Player.es"
CAnyProjection3D  apr ;
#line 4807 "C:/MyMod/Sources/EntitiesMP/Player.es"
apr  = prProjection ;
#line 4808 "C:/MyMod/Sources/EntitiesMP/Player.es"
Stereo_AdjustProjection  (* apr  , iEye  , 1);
#line 4809 "C:/MyMod/Sources/EntitiesMP/Player.es"
Particle_PrepareSystem  (pdp  , apr );
#line 4810 "C:/MyMod/Sources/EntitiesMP/Player.es"
Particle_PrepareEntity  (2.0f , FALSE  , FALSE  , this );
#line 4811 "C:/MyMod/Sources/EntitiesMP/Player.es"
RenderChainsawParticles  (FALSE );
#line 4812 "C:/MyMod/Sources/EntitiesMP/Player.es"
Particle_EndSystem  ();
#line 4813 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4816 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlacement3D plView ;
#line 4817 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_iViewState  == PVT_PLAYEREYES ){
#line 4819 "C:/MyMod/Sources/EntitiesMP/Player.es"
plView  = en_plViewpoint ;
#line 4820 "C:/MyMod/Sources/EntitiesMP/Player.es"
plView  . RelativeToAbsolute  (GetPlacement  ());
#line 4821 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else if(m_iViewState  == PVT_3RDPERSONVIEW ){
#line 4823 "C:/MyMod/Sources/EntitiesMP/Player.es"
plView  = ((CPlayerView  &) * m_pen3rdPersonView ) . GetPlacement  ();
#line 4824 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4825 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(! bSniping ){
#line 4826 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerWeapons  &) * m_penWeapons ) . RenderCrosshair  (prProjection  , pdp  , plView );
#line 4827 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4830 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlayer  * pen  = (CPlayer  *) GetPredictionTail  ();
#line 4869 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(hud_bShowInfo ){
#line 4871 "C:/MyMod/Sources/EntitiesMP/Player.es"
BOOL bSnooping  = FALSE ;
#line 4872 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlayer  * penHUDPlayer  = this ;
#line 4873 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlayer  * penHUDOwner  = this ;
#line 4875 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(penHUDPlayer  -> IsPredicted  ()){
#line 4876 "C:/MyMod/Sources/EntitiesMP/Player.es"
penHUDPlayer  = (CPlayer  *) penHUDPlayer  -> GetPredictor  ();
#line 4877 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4880 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlayerWeapons  * pen  = (CPlayerWeapons  *) & * penHUDPlayer  -> m_penWeapons ;
#line 4881 "C:/MyMod/Sources/EntitiesMP/Player.es"
TIME  tmDelta  = _pTimer  -> CurrentTick  () - pen  -> m_tmSnoopingStarted ;
#line 4882 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(tmDelta  < plr_tmSnoopingTime ){
#line 4883 "C:/MyMod/Sources/EntitiesMP/Player.es"
ASSERT  (pen  -> m_penTargeting  != NULL );
#line 4884 "C:/MyMod/Sources/EntitiesMP/Player.es"
penHUDPlayer  = (CPlayer  *) & * pen  -> m_penTargeting ;
#line 4885 "C:/MyMod/Sources/EntitiesMP/Player.es"
bSnooping  = TRUE ;
#line 4886 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4887 "C:/MyMod/Sources/EntitiesMP/Player.es"
DrawHUD  (penHUDPlayer  , pdp  , bSnooping  , penHUDOwner );
#line 4888 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4889 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 4896 "C:/MyMod/Sources/EntitiesMP/Player.es"
CEntity * CPlayer::GetDeathmatchStartMarker(void) 
#line 4897 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 4899 "C:/MyMod/Sources/EntitiesMP/Player.es"
CTString strPlayerStart  = "Player Start - ";
#line 4900 "C:/MyMod/Sources/EntitiesMP/Player.es"
INDEX ctMarkers  = _pNetwork  -> GetNumberOfEntitiesWithName  (strPlayerStart );
#line 4902 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(ctMarkers  == 0){
#line 4904 "C:/MyMod/Sources/EntitiesMP/Player.es"
return NULL ;
#line 4905 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4907 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(ctMarkers  == 1){
#line 4909 "C:/MyMod/Sources/EntitiesMP/Player.es"
return _pNetwork  -> GetEntityWithName  (strPlayerStart  , 0);
#line 4910 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4914 "C:/MyMod/Sources/EntitiesMP/Player.es"
CStaticArray  < MarkerDistance  > amdMarkers ;
#line 4915 "C:/MyMod/Sources/EntitiesMP/Player.es"
amdMarkers  . New  (ctMarkers );
#line 4917 "C:/MyMod/Sources/EntitiesMP/Player.es"
{for(INDEX iMarker  = 0;iMarker  < ctMarkers ;iMarker  ++){
#line 4918 "C:/MyMod/Sources/EntitiesMP/Player.es"
amdMarkers  [ iMarker  ] . md_ppm  = (CPlayerMarker  *) _pNetwork  -> GetEntityWithName  (strPlayerStart  , iMarker );
#line 4919 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(amdMarkers  [ iMarker  ] . md_ppm  == NULL ){
#line 4920 "C:/MyMod/Sources/EntitiesMP/Player.es"
return NULL ;
#line 4921 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4923 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fMinD  = UpperLimit  (0.0f);
#line 4924 "C:/MyMod/Sources/EntitiesMP/Player.es"
for(INDEX iPlayer  = 0;iPlayer  < GetMaxPlayers  ();iPlayer  ++){
#line 4925 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlayer  * ppl  = (CPlayer  *) & * GetPlayerEntity  (iPlayer );
#line 4926 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(ppl  == NULL ){
#line 4927 "C:/MyMod/Sources/EntitiesMP/Player.es"
continue ;
#line 4928 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4929 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fD  = 
#line 4930 "C:/MyMod/Sources/EntitiesMP/Player.es"
(amdMarkers  [ iMarker  ] . md_ppm  -> GetPlacement  () . pl_PositionVector  - 
#line 4931 "C:/MyMod/Sources/EntitiesMP/Player.es"
ppl  -> GetPlacement  () . pl_PositionVector ) . Length  ();
#line 4932 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(fD  < fMinD ){
#line 4933 "C:/MyMod/Sources/EntitiesMP/Player.es"
fMinD  = fD ;
#line 4934 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4935 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4936 "C:/MyMod/Sources/EntitiesMP/Player.es"
amdMarkers  [ iMarker  ] . md_fMinD  = fMinD ;
#line 4937 "C:/MyMod/Sources/EntitiesMP/Player.es"
}}
#line 4940 "C:/MyMod/Sources/EntitiesMP/Player.es"
qsort  (& amdMarkers  [ 0 ] , ctMarkers  , sizeof  (amdMarkers  [ 0 ]) , & qsort_CompareMarkerDistance );
#line 4941 "C:/MyMod/Sources/EntitiesMP/Player.es"
ASSERT  (amdMarkers  [ 0 ] . md_fMinD  >= amdMarkers  [ ctMarkers  - 1 ] . md_fMinD );
#line 4943 "C:/MyMod/Sources/EntitiesMP/Player.es"
INDEX ctFarMarkers  = ctMarkers  / 2;
#line 4944 "C:/MyMod/Sources/EntitiesMP/Player.es"
ASSERT  (ctFarMarkers  > 0);
#line 4945 "C:/MyMod/Sources/EntitiesMP/Player.es"
INDEX iStartMarker  = IRnd  () % ctFarMarkers ;
#line 4947 "C:/MyMod/Sources/EntitiesMP/Player.es"
INDEX iMarker  = iStartMarker ;
#line 4948 "C:/MyMod/Sources/EntitiesMP/Player.es"
FOREVER {
#line 4949 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(_pTimer  -> CurrentTick  () > amdMarkers  [ iMarker  ] . md_ppm  -> m_tmLastSpawned  + 1.0f){
#line 4950 "C:/MyMod/Sources/EntitiesMP/Player.es"
break ;
#line 4951 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4952 "C:/MyMod/Sources/EntitiesMP/Player.es"
iMarker  = (iMarker  + 1) % ctMarkers ;
#line 4953 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(iMarker  == iStartMarker ){
#line 4954 "C:/MyMod/Sources/EntitiesMP/Player.es"
break ;
#line 4955 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4956 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 4958 "C:/MyMod/Sources/EntitiesMP/Player.es"
return amdMarkers  [ iMarker  ] . md_ppm ;
#line 4959 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 4965 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::InitializePlayer() 
#line 4966 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 4968 "C:/MyMod/Sources/EntitiesMP/Player.es"
en_plViewpoint  . pl_OrientationAngle  = ANGLE3D (0 , 0 , 0);
#line 4969 "C:/MyMod/Sources/EntitiesMP/Player.es"
en_plViewpoint  . pl_PositionVector  = FLOAT3D (0.0f , plr_fViewHeightStand  , 0.0f);
#line 4970 "C:/MyMod/Sources/EntitiesMP/Player.es"
en_plLastViewpoint  = en_plViewpoint ;
#line 4973 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_ulFlags  &= PLF_INITIALIZED  | PLF_LEVELSTARTED  | PLF_RESPAWNINPLACE ;
#line 4974 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_fFallTime  = 0.0f;
#line 4975 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_pstState  = PST_STAND ;
#line 4976 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_fDamageAmmount  = 0.0f;
#line 4977 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_tmWoundedTime  = 0.0f;
#line 4978 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_tmInvisibility  = 0.0f , 
#line 4979 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_tmInvulnerability  = 0.0f , 
#line 4980 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_tmSeriousDamage  = 0.0f , 
#line 4981 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_tmSeriousSpeed  = 0.0f , 
#line 4984 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerAnimator  &) * m_penAnimator ) . Initialize  ();
#line 4986 "C:/MyMod/Sources/EntitiesMP/Player.es"
GetPlayerWeapons  () -> SendEvent  (EStart  ());
#line 4989 "C:/MyMod/Sources/EntitiesMP/Player.es"
Particles_AfterBurner_Prepare  (this );
#line 4992 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetPhysicsFlags  (EPF_MODEL_WALKING  | EPF_HASLUNGS );
#line 4993 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetCollisionFlags  (ECF_MODEL  | ((ECBI_PLAYER ) << ECB_IS ));
#line 4994 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetFlags  (GetFlags  () | ENF_ALIVE );
#line 4996 "C:/MyMod/Sources/EntitiesMP/Player.es"
StartModelAnim  (PLAYER_ANIM_STAND  , AOF_LOOPING );
#line 4997 "C:/MyMod/Sources/EntitiesMP/Player.es"
TeleportPlayer  (WLT_FIXED );
#line 4998 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 5001 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT3D CPlayer::GetTeleportingOffset(void) 
#line 5002 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 5004 "C:/MyMod/Sources/EntitiesMP/Player.es"
INDEX iPlayer  = GetMyPlayerIndex  ();
#line 5007 "C:/MyMod/Sources/EntitiesMP/Player.es"
const FLOAT fOffsetY  = 0.1f;
#line 5008 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT3D vOffsetRel  = FLOAT3D (0 , fOffsetY  , 0);
#line 5009 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(GetSP  () -> sp_bCooperative  && ! GetSP  () -> sp_bSinglePlayer ){
#line 5010 "C:/MyMod/Sources/EntitiesMP/Player.es"
INDEX iRow  = iPlayer  / 4;
#line 5011 "C:/MyMod/Sources/EntitiesMP/Player.es"
INDEX iCol  = iPlayer  % 4;
#line 5012 "C:/MyMod/Sources/EntitiesMP/Player.es"
vOffsetRel  = FLOAT3D (- 3.0f + iCol  * 2.0f , fOffsetY  , - 3.0f + iRow  * 2.0f);
#line 5013 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5015 "C:/MyMod/Sources/EntitiesMP/Player.es"
return vOffsetRel ;
#line 5016 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 5019 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::RemapLevelNames(INDEX & iLevel) 
#line 5020 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 5021 "C:/MyMod/Sources/EntitiesMP/Player.es"
switch(iLevel ){
#line 5022 "C:/MyMod/Sources/EntitiesMP/Player.es"
case 10: 
#line 5023 "C:/MyMod/Sources/EntitiesMP/Player.es"
iLevel  = 1;
#line 5024 "C:/MyMod/Sources/EntitiesMP/Player.es"
break ;
#line 5025 "C:/MyMod/Sources/EntitiesMP/Player.es"
case 11: 
#line 5026 "C:/MyMod/Sources/EntitiesMP/Player.es"
iLevel  = 2;
#line 5027 "C:/MyMod/Sources/EntitiesMP/Player.es"
break ;
#line 5028 "C:/MyMod/Sources/EntitiesMP/Player.es"
case 12: 
#line 5029 "C:/MyMod/Sources/EntitiesMP/Player.es"
iLevel  = 3;
#line 5030 "C:/MyMod/Sources/EntitiesMP/Player.es"
break ;
#line 5031 "C:/MyMod/Sources/EntitiesMP/Player.es"
case 13: 
#line 5032 "C:/MyMod/Sources/EntitiesMP/Player.es"
iLevel  = 4;
#line 5033 "C:/MyMod/Sources/EntitiesMP/Player.es"
break ;
#line 5034 "C:/MyMod/Sources/EntitiesMP/Player.es"
case 14: 
#line 5035 "C:/MyMod/Sources/EntitiesMP/Player.es"
iLevel  = 5;
#line 5036 "C:/MyMod/Sources/EntitiesMP/Player.es"
break ;
#line 5037 "C:/MyMod/Sources/EntitiesMP/Player.es"
case 15: 
#line 5038 "C:/MyMod/Sources/EntitiesMP/Player.es"
iLevel  = 6;
#line 5039 "C:/MyMod/Sources/EntitiesMP/Player.es"
break ;
#line 5040 "C:/MyMod/Sources/EntitiesMP/Player.es"
case 21: 
#line 5041 "C:/MyMod/Sources/EntitiesMP/Player.es"
iLevel  = 7;
#line 5042 "C:/MyMod/Sources/EntitiesMP/Player.es"
break ;
#line 5043 "C:/MyMod/Sources/EntitiesMP/Player.es"
case 22: 
#line 5044 "C:/MyMod/Sources/EntitiesMP/Player.es"
iLevel  = 8;
#line 5045 "C:/MyMod/Sources/EntitiesMP/Player.es"
break ;
#line 5046 "C:/MyMod/Sources/EntitiesMP/Player.es"
case 23: 
#line 5047 "C:/MyMod/Sources/EntitiesMP/Player.es"
iLevel  = 9;
#line 5048 "C:/MyMod/Sources/EntitiesMP/Player.es"
break ;
#line 5049 "C:/MyMod/Sources/EntitiesMP/Player.es"
case 24: 
#line 5050 "C:/MyMod/Sources/EntitiesMP/Player.es"
iLevel  = 10;
#line 5051 "C:/MyMod/Sources/EntitiesMP/Player.es"
break ;
#line 5052 "C:/MyMod/Sources/EntitiesMP/Player.es"
case 31: 
#line 5053 "C:/MyMod/Sources/EntitiesMP/Player.es"
iLevel  = 11;
#line 5054 "C:/MyMod/Sources/EntitiesMP/Player.es"
break ;
#line 5055 "C:/MyMod/Sources/EntitiesMP/Player.es"
case 32: 
#line 5056 "C:/MyMod/Sources/EntitiesMP/Player.es"
iLevel  = 12;
#line 5057 "C:/MyMod/Sources/EntitiesMP/Player.es"
break ;
#line 5058 "C:/MyMod/Sources/EntitiesMP/Player.es"
case 33: 
#line 5059 "C:/MyMod/Sources/EntitiesMP/Player.es"
iLevel  = 13;
#line 5060 "C:/MyMod/Sources/EntitiesMP/Player.es"
break ;
#line 5061 "C:/MyMod/Sources/EntitiesMP/Player.es"
default  : 
#line 5062 "C:/MyMod/Sources/EntitiesMP/Player.es"
iLevel  = - 1;
#line 5063 "C:/MyMod/Sources/EntitiesMP/Player.es"
break ;
#line 5064 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5065 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 5068 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::TeleportPlayer(enum WorldLinkType EwltType) 
#line 5069 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 5070 "C:/MyMod/Sources/EntitiesMP/Player.es"
INDEX iLevel  = - 1;
#line 5071 "C:/MyMod/Sources/EntitiesMP/Player.es"
CTString strLevelName  = GetWorld  () -> wo_fnmFileName  . FileName  ();
#line 5074 "C:/MyMod/Sources/EntitiesMP/Player.es"
INDEX u  , v ;
#line 5075 "C:/MyMod/Sources/EntitiesMP/Player.es"
u  = v  = - 1;
#line 5076 "C:/MyMod/Sources/EntitiesMP/Player.es"
strLevelName  . ScanF  ("%01d_%01d_" , & u  , & v );
#line 5077 "C:/MyMod/Sources/EntitiesMP/Player.es"
iLevel  = u  * 10 + v ;
#line 5079 "C:/MyMod/Sources/EntitiesMP/Player.es"
RemapLevelNames  (iLevel );
#line 5081 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(iLevel  > 0){
#line 5082 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CSessionProperties  *) GetSP  ()) -> sp_ulLevelsMask  |= 1 << (iLevel  - 1);
#line 5083 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5086 "C:/MyMod/Sources/EntitiesMP/Player.es"
INDEX iPlayer  = GetMyPlayerIndex  ();
#line 5088 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlacement3D plSet  = GetPlacement  ();
#line 5090 "C:/MyMod/Sources/EntitiesMP/Player.es"
Teleport  (CPlacement3D (FLOAT3D (32000.0f + 100.0f * iPlayer  , 32000.0f , 0) , ANGLE3D (0 , 0 , 0)));
#line 5092 "C:/MyMod/Sources/EntitiesMP/Player.es"
ForceCollisionBoxIndexChange  (PLAYER_COLLISION_BOX_STAND );
#line 5093 "C:/MyMod/Sources/EntitiesMP/Player.es"
en_plViewpoint  . pl_PositionVector  (2) = plr_fViewHeightStand ;
#line 5094 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerAnimator  &) * m_penAnimator ) . m_bDisableAnimating  = FALSE ;
#line 5095 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerAnimator  &) * m_penAnimator ) . Stand  ();
#line 5096 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_pstState  = PST_STAND ;
#line 5099 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT3D vOffsetRel  = GetTeleportingOffset  ();
#line 5102 "C:/MyMod/Sources/EntitiesMP/Player.es"
BOOL bSetHealth  = FALSE ;
#line 5103 "C:/MyMod/Sources/EntitiesMP/Player.es"
BOOL bAdjustHealth  = FALSE ;
#line 5104 "C:/MyMod/Sources/EntitiesMP/Player.es"
CEntity  * pen  = NULL ;
#line 5105 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(GetSP  () -> sp_bCooperative ){
#line 5106 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(cht_iGoToMarker  >= 0){
#line 5108 "C:/MyMod/Sources/EntitiesMP/Player.es"
CTString strPlayerStart ;
#line 5109 "C:/MyMod/Sources/EntitiesMP/Player.es"
strPlayerStart  . PrintF  ("Player Start - %d" , (INDEX) cht_iGoToMarker );
#line 5110 "C:/MyMod/Sources/EntitiesMP/Player.es"
pen  = _pNetwork  -> GetEntityWithName  (strPlayerStart  , 0);
#line 5111 "C:/MyMod/Sources/EntitiesMP/Player.es"
pen  -> SendEvent  (ETrigger  ());
#line 5112 "C:/MyMod/Sources/EntitiesMP/Player.es"
cht_iGoToMarker  = - 1;
#line 5113 "C:/MyMod/Sources/EntitiesMP/Player.es"
bSetHealth  = TRUE ;
#line 5114 "C:/MyMod/Sources/EntitiesMP/Player.es"
bAdjustHealth  = FALSE ;
#line 5116 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else if(m_penMainMusicHolder  != NULL  && ! (m_ulFlags  & PLF_CHANGINGLEVEL )){
#line 5117 "C:/MyMod/Sources/EntitiesMP/Player.es"
CMusicHolder  * pmh  = (CMusicHolder  *) & * m_penMainMusicHolder ;
#line 5118 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(pmh  -> m_penRespawnMarker  != NULL ){
#line 5120 "C:/MyMod/Sources/EntitiesMP/Player.es"
pen  = pmh  -> m_penRespawnMarker ;
#line 5121 "C:/MyMod/Sources/EntitiesMP/Player.es"
bSetHealth  = TRUE ;
#line 5122 "C:/MyMod/Sources/EntitiesMP/Player.es"
bAdjustHealth  = FALSE ;
#line 5123 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5124 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5127 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(pen  == NULL  && GetSP  () -> sp_bQuickTest  && m_strGroup  == ""){
#line 5129 "C:/MyMod/Sources/EntitiesMP/Player.es"
CTString strPlayerStart ;
#line 5130 "C:/MyMod/Sources/EntitiesMP/Player.es"
strPlayerStart  . PrintF  ("Player Quick Start");
#line 5131 "C:/MyMod/Sources/EntitiesMP/Player.es"
pen  = _pNetwork  -> GetEntityWithName  (strPlayerStart  , 0);
#line 5132 "C:/MyMod/Sources/EntitiesMP/Player.es"
bSetHealth  = TRUE ;
#line 5133 "C:/MyMod/Sources/EntitiesMP/Player.es"
bAdjustHealth  = FALSE ;
#line 5134 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5136 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(pen  == NULL ){
#line 5138 "C:/MyMod/Sources/EntitiesMP/Player.es"
CTString strPlayerStart ;
#line 5139 "C:/MyMod/Sources/EntitiesMP/Player.es"
strPlayerStart  . PrintF  ("Player Start - %s" , m_strGroup );
#line 5140 "C:/MyMod/Sources/EntitiesMP/Player.es"
pen  = _pNetwork  -> GetEntityWithName  (strPlayerStart  , 0);
#line 5141 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_strGroup  == ""){
#line 5142 "C:/MyMod/Sources/EntitiesMP/Player.es"
bSetHealth  = TRUE ;
#line 5143 "C:/MyMod/Sources/EntitiesMP/Player.es"
bAdjustHealth  = FALSE ;
#line 5144 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 5145 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(EwltType  == WLT_FIXED ){
#line 5146 "C:/MyMod/Sources/EntitiesMP/Player.es"
bSetHealth  = FALSE ;
#line 5147 "C:/MyMod/Sources/EntitiesMP/Player.es"
bAdjustHealth  = TRUE ;
#line 5148 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 5149 "C:/MyMod/Sources/EntitiesMP/Player.es"
bSetHealth  = FALSE ;
#line 5150 "C:/MyMod/Sources/EntitiesMP/Player.es"
bAdjustHealth  = FALSE ;
#line 5151 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5152 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5153 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5155 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(pen  == NULL ){
#line 5157 "C:/MyMod/Sources/EntitiesMP/Player.es"
CTString strPlayerStart ;
#line 5158 "C:/MyMod/Sources/EntitiesMP/Player.es"
strPlayerStart  . PrintF  ("Player Start - ");
#line 5159 "C:/MyMod/Sources/EntitiesMP/Player.es"
pen  = _pNetwork  -> GetEntityWithName  (strPlayerStart  , 0);
#line 5160 "C:/MyMod/Sources/EntitiesMP/Player.es"
bSetHealth  = TRUE ;
#line 5161 "C:/MyMod/Sources/EntitiesMP/Player.es"
bAdjustHealth  = FALSE ;
#line 5162 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5163 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 5164 "C:/MyMod/Sources/EntitiesMP/Player.es"
bSetHealth  = TRUE ;
#line 5165 "C:/MyMod/Sources/EntitiesMP/Player.es"
bAdjustHealth  = FALSE ;
#line 5167 "C:/MyMod/Sources/EntitiesMP/Player.es"
pen  = GetDeathmatchStartMarker  ();
#line 5168 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(pen  != NULL ){
#line 5169 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerMarker  &) * pen ) . m_tmLastSpawned  = _pTimer  -> CurrentTick  ();
#line 5170 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5171 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5174 "C:/MyMod/Sources/EntitiesMP/Player.es"
if((m_ulFlags  & PLF_RESPAWNINPLACE ) && pen  != NULL  && ! ((CPlayerMarker  *) & * pen ) -> m_bNoRespawnInPlace ){
#line 5175 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_ulFlags  &= ~ PLF_RESPAWNINPLACE ;
#line 5177 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetHealth  (TopHealth  ());
#line 5178 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_iMana  = GetSP  () -> sp_iInitialMana ;
#line 5179 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_fArmor  = 0.0f;
#line 5181 "C:/MyMod/Sources/EntitiesMP/Player.es"
Teleport  (CPlacement3D (m_vDied  , m_aDied ));
#line 5184 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else if(pen  != NULL ){
#line 5186 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_penMainMusicHolder  != NULL ){
#line 5187 "C:/MyMod/Sources/EntitiesMP/Player.es"
CMusicHolder  * pmh  = (CMusicHolder  *) & * m_penMainMusicHolder ;
#line 5188 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(pmh  -> m_penRespawnMarker  == NULL ){
#line 5190 "C:/MyMod/Sources/EntitiesMP/Player.es"
pmh  -> m_penRespawnMarker  = pen ;
#line 5191 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5192 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5194 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlayerMarker  & CpmStart  = (CPlayerMarker  &) * pen ;
#line 5196 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(bSetHealth ){
#line 5197 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetHealth  (CpmStart  . m_fHealth  / 100.0f * TopHealth  ());
#line 5198 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_iMana  = GetSP  () -> sp_iInitialMana ;
#line 5199 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_fArmor  = CpmStart  . m_fShield ;
#line 5200 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else if(bAdjustHealth ){
#line 5201 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fHealth  = GetHealth  ();
#line 5202 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fTopHealth  = TopHealth  ();
#line 5203 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(fHealth  < fTopHealth ){
#line 5204 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetHealth  (ClampUp  (fHealth  + fTopHealth  / 2.0f , fTopHealth ));
#line 5205 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5206 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5209 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(CpmStart  . m_bStartInComputer  && GetSP  () -> sp_bSinglePlayer ){
#line 5211 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(_pNetwork  -> IsPlayerLocal  (this )){
#line 5212 "C:/MyMod/Sources/EntitiesMP/Player.es"
cmp_ppenPlayer  = this ;
#line 5213 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5214 "C:/MyMod/Sources/EntitiesMP/Player.es"
cmp_bInitialStart  = TRUE ;
#line 5215 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5218 "C:/MyMod/Sources/EntitiesMP/Player.es"
CMessageHolder  * penMessage  = (CMessageHolder  *) & * CpmStart  . m_penMessage ;
#line 5220 "C:/MyMod/Sources/EntitiesMP/Player.es"
while(penMessage  != NULL  && IsOfClass  (penMessage  , "MessageHolder")){
#line 5221 "C:/MyMod/Sources/EntitiesMP/Player.es"
const CTFileName & fnmMessage  = penMessage  -> m_fnmMessage ;
#line 5223 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(! HasMessage  (fnmMessage )){
#line 5225 "C:/MyMod/Sources/EntitiesMP/Player.es"
ReceiveComputerMessage  (fnmMessage  , 0);
#line 5226 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5228 "C:/MyMod/Sources/EntitiesMP/Player.es"
penMessage  = (CMessageHolder  *) & * penMessage  -> m_penNext ;
#line 5229 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5232 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(! GetSP  () -> sp_bCooperative ){
#line 5233 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerWeapons  &) * m_penWeapons ) . InitializeWeapons  (CpmStart  . m_iGiveWeapons  , 0 , 0 , 
#line 5234 "C:/MyMod/Sources/EntitiesMP/Player.es"
CpmStart  . m_fMaxAmmoRatio );
#line 5235 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 5236 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerWeapons  &) * m_penWeapons ) . InitializeWeapons  (CpmStart  . m_iGiveWeapons  , CpmStart  . m_iTakeWeapons  , 
#line 5237 "C:/MyMod/Sources/EntitiesMP/Player.es"
GetSP  () -> sp_bInfiniteAmmo  ? 0 : CpmStart  . m_iTakeAmmo  , CpmStart  . m_fMaxAmmoRatio );
#line 5238 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5240 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(EwltType  == WLT_RELATIVE ){
#line 5241 "C:/MyMod/Sources/EntitiesMP/Player.es"
plSet  . AbsoluteToRelative  (_SwcWorldChange  . plLink );
#line 5242 "C:/MyMod/Sources/EntitiesMP/Player.es"
plSet  . RelativeToAbsolute  (CpmStart  . GetPlacement  ());
#line 5243 "C:/MyMod/Sources/EntitiesMP/Player.es"
Teleport  (plSet );
#line 5245 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else if(EwltType  == WLT_FIXED ){
#line 5246 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlacement3D plNew  = CpmStart  . GetPlacement  ();
#line 5247 "C:/MyMod/Sources/EntitiesMP/Player.es"
vOffsetRel  *= CpmStart  . en_mRotation ;
#line 5248 "C:/MyMod/Sources/EntitiesMP/Player.es"
plNew  . pl_PositionVector  += vOffsetRel ;
#line 5249 "C:/MyMod/Sources/EntitiesMP/Player.es"
Teleport  (plNew );
#line 5251 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 5252 "C:/MyMod/Sources/EntitiesMP/Player.es"
ASSERTALWAYS  ("Unknown world link type");
#line 5253 "C:/MyMod/Sources/EntitiesMP/Player.es"
Teleport  (CPlacement3D (FLOAT3D (0 , 0 , 0) + vOffsetRel  , ANGLE3D (0 , 0 , 0)));
#line 5254 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5256 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(CpmStart  . m_penTarget  != NULL ){
#line 5257 "C:/MyMod/Sources/EntitiesMP/Player.es"
SendToTarget  (CpmStart  . m_penTarget  , EET_TRIGGER  , this );
#line 5258 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5261 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 5263 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetHealth  (TopHealth  ());
#line 5264 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_iMana  = GetSP  () -> sp_iInitialMana ;
#line 5265 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_fArmor  = 0.0f;
#line 5267 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerWeapons  &) * m_penWeapons ) . InitializeWeapons  (0 , 0 , 0 , 0);
#line 5269 "C:/MyMod/Sources/EntitiesMP/Player.es"
Teleport  (CPlacement3D (FLOAT3D (0 , 0 , 0) + vOffsetRel  , ANGLE3D (0 , 0 , 0)));
#line 5270 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5272 "C:/MyMod/Sources/EntitiesMP/Player.es"
SendEventInRange  (ETeleport  () , FLOATaabbox3D (GetPlacement  () . pl_PositionVector  , 200.0f));
#line 5274 "C:/MyMod/Sources/EntitiesMP/Player.es"
ForceFullStop  ();
#line 5277 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_fMaxHealth  = TopHealth  ();
#line 5280 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(GetSP  () -> sp_bSinglePlayer  && GetSP  () -> sp_gmGameMode  != CSessionProperties  :: GM_FLYOVER ){
#line 5281 "C:/MyMod/Sources/EntitiesMP/Player.es"
CWorldSettingsController  * pwsc  = GetWSC  (this );
#line 5282 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(pwsc  != NULL  && pwsc  -> m_bNoSaveGame ){
#line 5283 "C:/MyMod/Sources/EntitiesMP/Player.es"
NOTHING ;
#line 5284 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 5286 "C:/MyMod/Sources/EntitiesMP/Player.es"
_pShell  -> Execute  ("gam_bQuickSave=1;");
#line 5287 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5288 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5290 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(! (m_ulFlags  & PLF_LEVELSTARTED )){
#line 5291 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_ulFlags  |= PLF_LEVELSTARTED ;
#line 5292 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_tmLevelStarted  = _pNetwork  -> GetGameTime  ();
#line 5293 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5295 "C:/MyMod/Sources/EntitiesMP/Player.es"
CTString strDummy ;
#line 5296 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetPlayerAppearance  (GetModelObject  () , NULL  , strDummy  , FALSE );
#line 5297 "C:/MyMod/Sources/EntitiesMP/Player.es"
ValidateCharacter  ();
#line 5298 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetPlayerAppearance  (& m_moRender  , & en_pcCharacter  , strDummy  , FALSE );
#line 5299 "C:/MyMod/Sources/EntitiesMP/Player.es"
ParseGender  (strDummy );
#line 5300 "C:/MyMod/Sources/EntitiesMP/Player.es"
GetPlayerAnimator  () -> SetWeapon  ();
#line 5301 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_ulFlags  |= PLF_SYNCWEAPON ;
#line 5304 "C:/MyMod/Sources/EntitiesMP/Player.es"
SpawnTeleport  ();
#line 5306 "C:/MyMod/Sources/EntitiesMP/Player.es"
SwitchToModel  ();
#line 5307 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_tmSpawned  = _pTimer  -> CurrentTick  ();
#line 5309 "C:/MyMod/Sources/EntitiesMP/Player.es"
en_tmLastBreathed  = _pTimer  -> CurrentTick  () + 0.1f;
#line 5310 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 5313 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::RecordEndOfLevelData(void) 
#line 5314 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 5316 "C:/MyMod/Sources/EntitiesMP/Player.es"
ASSERT  (! m_bEndOfLevel );
#line 5318 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_tmAnalyseEnd  = 0;
#line 5319 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_bPendingMessage  = FALSE ;
#line 5320 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_tmMessagePlay  = 0;
#line 5322 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_iMayRespawn  = 0;
#line 5323 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_bEndOfLevel  = TRUE ;
#line 5325 "C:/MyMod/Sources/EntitiesMP/Player.es"
time  (& m_iEndTime );
#line 5327 "C:/MyMod/Sources/EntitiesMP/Player.es"
TIME  tmLevelTime  = _pTimer  -> CurrentTick  () - m_tmLevelStarted ;
#line 5328 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_psLevelStats  . ps_tmTime  = tmLevelTime ;
#line 5329 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_psGameStats  . ps_tmTime  += tmLevelTime ;
#line 5330 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fTimeDelta  = ClampDn  (floor  (m_tmEstTime ) - floor  (tmLevelTime ) , 0.0);
#line 5331 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_iTimeScore  = floor  (fTimeDelta  * 100.0f);
#line 5332 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_psLevelStats  . ps_iScore  += m_iTimeScore ;
#line 5333 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_psGameStats  . ps_iScore  += m_iTimeScore ;
#line 5336 "C:/MyMod/Sources/EntitiesMP/Player.es"
CTString strStats ;
#line 5337 "C:/MyMod/Sources/EntitiesMP/Player.es"
strStats  . PrintF  (TRANS  ("%s\n  Time:   %s\n  Score: %9d\n  Kills:   %03d/%03d\n  Secrets:   %02d/%02d\n") , 
#line 5338 "C:/MyMod/Sources/EntitiesMP/Player.es"
TranslateConst  (en_pwoWorld  -> GetName  () , 0) , TimeToString  (tmLevelTime ) , 
#line 5339 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_psLevelStats  . ps_iScore  , 
#line 5340 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_psLevelStats  . ps_iKills  , m_psLevelTotal  . ps_iKills  , 
#line 5341 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_psLevelStats  . ps_iSecrets  , m_psLevelTotal  . ps_iSecrets );
#line 5342 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_strLevelStats  += strStats ;
#line 5343 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 5346 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::SpawnTeleport(void) 
#line 5347 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 5349 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(GetSP  () -> sp_bSinglePlayer ){
#line 5351 "C:/MyMod/Sources/EntitiesMP/Player.es"
return ;
#line 5352 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5353 "C:/MyMod/Sources/EntitiesMP/Player.es"
ESpawnEffect  ese ;
#line 5354 "C:/MyMod/Sources/EntitiesMP/Player.es"
ese  . colMuliplier  = C_WHITE  | CT_OPAQUE ;
#line 5355 "C:/MyMod/Sources/EntitiesMP/Player.es"
ese  . betType  = BET_TELEPORT ;
#line 5356 "C:/MyMod/Sources/EntitiesMP/Player.es"
ese  . vNormal  = FLOAT3D (0 , 1 , 0);
#line 5357 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOATaabbox3D box ;
#line 5358 "C:/MyMod/Sources/EntitiesMP/Player.es"
GetBoundingBox  (box );
#line 5359 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fEntitySize  = box  . Size  () . MaxNorm  () * 2;
#line 5360 "C:/MyMod/Sources/EntitiesMP/Player.es"
ese  . vStretch  = FLOAT3D (fEntitySize  , fEntitySize  , fEntitySize );
#line 5361 "C:/MyMod/Sources/EntitiesMP/Player.es"
CEntityPointer penEffect  = CreateEntity  (GetPlacement  () , CLASS_BASIC_EFFECT );
#line 5362 "C:/MyMod/Sources/EntitiesMP/Player.es"
penEffect  -> Initialize  (ese );
#line 5363 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 5368 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::RenderParticles(void) 
#line 5369 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 5370 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT tmNow  = _pTimer  -> GetLerpedCurrentTick  ();
#line 5373 "C:/MyMod/Sources/EntitiesMP/Player.es"
Particles_EmptyShells  (this  , m_asldData );
#line 5375 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(Particle_GetViewer  () == this ){
#line 5376 "C:/MyMod/Sources/EntitiesMP/Player.es"
Particles_ViewerLocal  (this );
#line 5377 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5378 "C:/MyMod/Sources/EntitiesMP/Player.es"
else 
#line 5379 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 5381 "C:/MyMod/Sources/EntitiesMP/Player.es"
RenderChainsawParticles  (TRUE );
#line 5383 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(GetFlags  () & ENF_ALIVE ){
#line 5384 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_tmSeriousDamage  > tmNow  && m_tmInvulnerability  > tmNow ){
#line 5385 "C:/MyMod/Sources/EntitiesMP/Player.es"
Particles_ModelGlow  (this  , Max  (m_tmSeriousDamage  , m_tmInvulnerability ) , PT_STAR08  , 0.15f , 2 , 0.03f , 0xff00ff00);
#line 5386 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else if(m_tmInvulnerability  > tmNow ){
#line 5387 "C:/MyMod/Sources/EntitiesMP/Player.es"
Particles_ModelGlow  (this  , m_tmInvulnerability  , PT_STAR05  , 0.15f , 2 , 0.03f , 0x3333ff00);
#line 5388 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else if(m_tmSeriousDamage  > tmNow ){
#line 5389 "C:/MyMod/Sources/EntitiesMP/Player.es"
Particles_ModelGlow  (this  , m_tmSeriousDamage  , PT_STAR08  , 0.15f , 2 , 0.03f , 0xff777700);
#line 5390 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5391 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_tmSeriousSpeed  > tmNow ){
#line 5392 "C:/MyMod/Sources/EntitiesMP/Player.es"
Particles_RunAfterBurner  (this  , m_tmSeriousSpeed  , 0.3f , 0);
#line 5393 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5394 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(! GetSP  () -> sp_bCooperative ){
#line 5395 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlayerWeapons  * wpn  = GetPlayerWeapons  ();
#line 5396 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(wpn  -> m_tmLastSniperFire  == _pTimer  -> CurrentTick  ())
#line 5397 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 5398 "C:/MyMod/Sources/EntitiesMP/Player.es"
CAttachmentModelObject  & amoBody  = * GetModelObject  () -> GetAttachmentModel  (PLAYER_ATTACHMENT_TORSO );
#line 5399 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOATmatrix3D m ;
#line 5400 "C:/MyMod/Sources/EntitiesMP/Player.es"
MakeRotationMatrix  (m  , amoBody  . amo_plRelative  . pl_OrientationAngle );
#line 5401 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT3D vSource  = wpn  -> m_vBulletSource  + FLOAT3D (0.0f , 0.1f , - 0.4f) * GetRotationMatrix  () * m ;
#line 5402 "C:/MyMod/Sources/EntitiesMP/Player.es"
Particles_SniperResidue  (this  , vSource  , wpn  -> m_vBulletTarget );
#line 5403 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5404 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5405 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5406 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5409 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_tmSpiritStart  != 0.0f)
#line 5410 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 5411 "C:/MyMod/Sources/EntitiesMP/Player.es"
Particles_Appearing  (this  , m_tmSpiritStart );
#line 5412 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5413 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 5415 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::TeleportToAutoMarker(CPlayerActionMarker * ppam) 
#line 5416 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 5418 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(GetSP  () -> sp_bCooperative  && ! GetSP  () -> sp_bSinglePlayer ){
#line 5420 "C:/MyMod/Sources/EntitiesMP/Player.es"
for(INDEX iPlayer  = 0;iPlayer  < GetMaxPlayers  ();iPlayer  ++){
#line 5421 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlayer  * ppl  = (CPlayer  *) GetPlayerEntity  (iPlayer );
#line 5422 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(ppl  != NULL ){
#line 5424 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlacement3D pl  = ppam  -> GetPlacement  ();
#line 5425 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT3D vOffsetRel  = ppl  -> GetTeleportingOffset  ();
#line 5426 "C:/MyMod/Sources/EntitiesMP/Player.es"
pl  . pl_PositionVector  += vOffsetRel  * ppam  -> en_mRotation ;
#line 5427 "C:/MyMod/Sources/EntitiesMP/Player.es"
ppl  -> Teleport  (pl  , FALSE );
#line 5429 "C:/MyMod/Sources/EntitiesMP/Player.es"
ppl  -> m_vDied  = pl  . pl_PositionVector ;
#line 5430 "C:/MyMod/Sources/EntitiesMP/Player.es"
ppl  -> m_aDied  = pl  . pl_OrientationAngle ;
#line 5431 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5432 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5435 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 5437 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlacement3D pl  = ppam  -> GetPlacement  ();
#line 5438 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT3D vOffsetRel  = GetTeleportingOffset  ();
#line 5439 "C:/MyMod/Sources/EntitiesMP/Player.es"
pl  . pl_PositionVector  += vOffsetRel  * ppam  -> en_mRotation ;
#line 5440 "C:/MyMod/Sources/EntitiesMP/Player.es"
Teleport  (pl  , FALSE );
#line 5441 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5442 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
  
#line 5445 "C:/MyMod/Sources/EntitiesMP/Player.es"
void CPlayer::CheckDeathForRespawnInPlace(EDeath eDeath) 
#line 5446 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 5448 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(! GetSP  () -> sp_bRespawnInPlace ){
#line 5450 "C:/MyMod/Sources/EntitiesMP/Player.es"
return ;
#line 5451 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5453 "C:/MyMod/Sources/EntitiesMP/Player.es"
CEntity  * penKiller  = eDeath  . eLastDamage  . penInflictor ;
#line 5454 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(IsOfClass  (penKiller  , "Player") || IsDerivedFromClass  (penKiller  , "Enemy Base")){
#line 5456 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_ulFlags  |= PLF_RESPAWNINPLACE ;
#line 5457 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_vDied  = GetPlacement  () . pl_PositionVector ;
#line 5458 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_aDied  = GetPlacement  () . pl_OrientationAngle ;
#line 5459 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5460 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
BOOL CPlayer::
#line 5466 "C:/MyMod/Sources/EntitiesMP/Player.es"
Wounded(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT STATE_CPlayer_Wounded
  ASSERTMSG(__eeInput.ee_slEvent==EVENTCODE_EDamage, "CPlayer::Wounded expects 'EDamage' as input!");  const EDamage &eDamage = (const EDamage &)__eeInput;
#line 5467 "C:/MyMod/Sources/EntitiesMP/Player.es"
Return(STATE_CURRENT,EVoid());
#line 5467 "C:/MyMod/Sources/EntitiesMP/Player.es"
return TRUE; ASSERT(FALSE); return TRUE;};BOOL CPlayer::
#line 5474 "C:/MyMod/Sources/EntitiesMP/Player.es"
WorldChange(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT STATE_CPlayer_WorldChange
  ASSERTMSG(__eeInput.ee_slEvent==EVENTCODE_EVoid, "CPlayer::WorldChange expects 'EVoid' as input!");  const EVoid &e = (const EVoid &)__eeInput;
#line 5476 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(GetSP  () -> sp_bSinglePlayer ){
#line 5478 "C:/MyMod/Sources/EntitiesMP/Player.es"
CTString strDummy  ("1");
#line 5479 "C:/MyMod/Sources/EntitiesMP/Player.es"
SaveStringVar  (GetWorld  () -> wo_fnmFileName  . NoExt  () + ".vis" , strDummy );
#line 5480 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5482 "C:/MyMod/Sources/EntitiesMP/Player.es"
FindMusicHolder  ();
#line 5484 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_strGroup  = _SwcWorldChange  . strGroup ;
#line 5485 "C:/MyMod/Sources/EntitiesMP/Player.es"
TeleportPlayer  ((WorldLinkType ) _SwcWorldChange  . iType );
#line 5487 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetupLightSource  ();
#line 5490 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlayerWeapons  * penWeapon  = GetPlayerWeapons  ();
#line 5491 "C:/MyMod/Sources/EntitiesMP/Player.es"
penWeapon  -> m_fSniperFOVlast  = penWeapon  -> m_fSniperFOV  = penWeapon  -> m_fSniperMaxFOV ;
#line 5492 "C:/MyMod/Sources/EntitiesMP/Player.es"
penWeapon  -> m_bSniping  = FALSE ;
#line 5493 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_ulFlags  &= ~ PLF_ISZOOMING ;
#line 5496 "C:/MyMod/Sources/EntitiesMP/Player.es"
PlaySound  (m_soWeaponAmbient  , SOUND_SILENCE  , SOF_3D );
#line 5499 "C:/MyMod/Sources/EntitiesMP/Player.es"
UpdateLevelStats  ();
#line 5500 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_ulFlags  |= PLF_INITIALIZED ;
#line 5501 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_ulFlags  &= ~ PLF_CHANGINGLEVEL ;
#line 5502 "C:/MyMod/Sources/EntitiesMP/Player.es"
Return(STATE_CURRENT,EVoid());
#line 5502 "C:/MyMod/Sources/EntitiesMP/Player.es"
return TRUE; ASSERT(FALSE); return TRUE;};BOOL CPlayer::
#line 5505 "C:/MyMod/Sources/EntitiesMP/Player.es"
WorldChangeDead(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT STATE_CPlayer_WorldChangeDead
  ASSERTMSG(__eeInput.ee_slEvent==EVENTCODE_EVoid, "CPlayer::WorldChangeDead expects 'EVoid' as input!");  const EVoid &e = (const EVoid &)__eeInput;
#line 5508 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_ulFlags  &= ~ PLF_RESPAWNINPLACE ;
#line 5511 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(GetSP  () -> sp_bSinglePlayer ){
#line 5513 "C:/MyMod/Sources/EntitiesMP/Player.es"
CTString strDummy  ("1");
#line 5514 "C:/MyMod/Sources/EntitiesMP/Player.es"
SaveStringVar  (GetWorld  () -> wo_fnmFileName  . NoExt  () + ".vis" , strDummy );
#line 5515 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5517 "C:/MyMod/Sources/EntitiesMP/Player.es"
FindMusicHolder  ();
#line 5520 "C:/MyMod/Sources/EntitiesMP/Player.es"
STATE_CPlayer_Rebirth, TRUE;
Jump(STATE_CURRENT, 0x01910008, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x01910008_WorldChangeDead_01(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910008
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: Call(STATE_CURRENT, STATE_CPlayer_Rebirth, TRUE, EVoid());return TRUE;case EVENTCODE_EReturn: Jump(STATE_CURRENT,0x01910009, FALSE, __eeInput); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x01910009_WorldChangeDead_02(const CEntityEvent &__eeInput){
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910009
const EReturn&__e= (EReturn&)__eeInput;
;
#line 5523 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetupLightSource  ();
#line 5526 "C:/MyMod/Sources/EntitiesMP/Player.es"
UpdateLevelStats  ();
#line 5527 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_ulFlags  |= PLF_INITIALIZED ;
#line 5528 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_ulFlags  &= ~ PLF_CHANGINGLEVEL ;
#line 5529 "C:/MyMod/Sources/EntitiesMP/Player.es"
Return(STATE_CURRENT,EVoid());
#line 5529 "C:/MyMod/Sources/EntitiesMP/Player.es"
return TRUE; ASSERT(FALSE); return TRUE;};BOOL CPlayer::
#line 5536 "C:/MyMod/Sources/EntitiesMP/Player.es"
Death(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT STATE_CPlayer_Death
  ASSERTMSG(__eeInput.ee_slEvent==EVENTCODE_EDeath, "CPlayer::Death expects 'EDeath' as input!");  const EDeath &eDeath = (const EDeath &)__eeInput;
#line 5539 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerWeapons  &) * m_penWeapons ) . SendEvent  (EReleaseWeapon  ());
#line 5541 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(_pNetwork  -> IsPlayerLocal  (this ))
#line 5542 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 5543 "C:/MyMod/Sources/EntitiesMP/Player.es"
IFeel_StopEffect  ("ChainsawFire");
#line 5544 "C:/MyMod/Sources/EntitiesMP/Player.es"
IFeel_StopEffect  ("FlamethrowerFire");
#line 5545 "C:/MyMod/Sources/EntitiesMP/Player.es"
IFeel_StopEffect  ("ChainsawIdle");
#line 5546 "C:/MyMod/Sources/EntitiesMP/Player.es"
IFeel_StopEffect  ("SniperZoom");
#line 5547 "C:/MyMod/Sources/EntitiesMP/Player.es"
IFeel_StopEffect  ("Minigun_rotate");
#line 5548 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5551 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlayerWeapons  * penWeapon  = GetPlayerWeapons  ();
#line 5552 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_ulFlags  &= ~ PLF_ISZOOMING ;
#line 5553 "C:/MyMod/Sources/EntitiesMP/Player.es"
penWeapon  -> m_bSniping  = FALSE ;
#line 5554 "C:/MyMod/Sources/EntitiesMP/Player.es"
penWeapon  -> m_fSniperFOVlast  = penWeapon  -> m_fSniperFOV  = penWeapon  -> m_fSniperMaxFOV ;
#line 5557 "C:/MyMod/Sources/EntitiesMP/Player.es"
PlaySound  (m_soSniperZoom  , SOUND_SILENCE  , SOF_3D );
#line 5558 "C:/MyMod/Sources/EntitiesMP/Player.es"
PlaySound  (m_soWeaponAmbient  , SOUND_SILENCE  , SOF_3D );
#line 5561 "C:/MyMod/Sources/EntitiesMP/Player.es"
penWeapon  -> m_aMiniGunLast  = penWeapon  -> m_aMiniGun ;
#line 5564 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(GetSP  () -> sp_bSinglePlayer  || IsPredictor  ()){
#line 5566 "C:/MyMod/Sources/EntitiesMP/Player.es"
NOTHING ;
#line 5568 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else if(GetSP  () -> sp_bCooperative ){
#line 5570 "C:/MyMod/Sources/EntitiesMP/Player.es"
PrintPlayerDeathMessage  (this  , eDeath );
#line 5572 "C:/MyMod/Sources/EntitiesMP/Player.es"
CheckDeathForRespawnInPlace  (eDeath );
#line 5574 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_psLevelStats  . ps_iDeaths  += 1;
#line 5575 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_psGameStats  . ps_iDeaths  += 1;
#line 5577 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 5579 "C:/MyMod/Sources/EntitiesMP/Player.es"
PrintPlayerDeathMessage  (this  , eDeath );
#line 5581 "C:/MyMod/Sources/EntitiesMP/Player.es"
CEntity  * penKiller  = eDeath  . eLastDamage  . penInflictor ;
#line 5583 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlayer  * pplKillerPlayer  = NULL ;
#line 5586 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(penKiller  != NULL ){
#line 5588 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(IsOfClass  (penKiller  , "Player")){
#line 5590 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(penKiller  != this ){
#line 5591 "C:/MyMod/Sources/EntitiesMP/Player.es"
pplKillerPlayer  = (CPlayer  *) penKiller ;
#line 5592 "C:/MyMod/Sources/EntitiesMP/Player.es"
EReceiveScore  eScore ;
#line 5593 "C:/MyMod/Sources/EntitiesMP/Player.es"
eScore  . iPoints  = m_iMana ;
#line 5594 "C:/MyMod/Sources/EntitiesMP/Player.es"
eDeath  . eLastDamage  . penInflictor  -> SendEvent  (eScore );
#line 5595 "C:/MyMod/Sources/EntitiesMP/Player.es"
eDeath  . eLastDamage  . penInflictor  -> SendEvent  (EKilledEnemy  ());
#line 5597 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 5598 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_psLevelStats  . ps_iScore  -= m_iMana ;
#line 5599 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_psGameStats  . ps_iScore  -= m_iMana ;
#line 5600 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_psLevelStats  . ps_iKills  -= 1;
#line 5601 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_psGameStats  . ps_iKills  -= 1;
#line 5602 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5604 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 5605 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_psLevelStats  . ps_iScore  -= m_iMana ;
#line 5606 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_psGameStats  . ps_iScore  -= m_iMana ;
#line 5607 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_psLevelStats  . ps_iKills  -= 1;
#line 5608 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_psGameStats  . ps_iKills  -= 1;
#line 5609 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5611 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 5612 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_psLevelStats  . ps_iScore  -= m_iMana ;
#line 5613 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_psGameStats  . ps_iScore  -= m_iMana ;
#line 5614 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_psLevelStats  . ps_iKills  -= 1;
#line 5615 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_psGameStats  . ps_iKills  -= 1;
#line 5616 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5619 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(! GetSP  () -> sp_bUseFrags ){
#line 5621 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(pplKillerPlayer  != NULL ){
#line 5623 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPrintF  (TRANS  ("  %s: +%d points\n") , pplKillerPlayer  -> GetPlayerName  () , m_iMana );
#line 5625 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 5627 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPrintF  (TRANS  ("  %s: -%d points\n") , GetPlayerName  () , m_iMana );
#line 5628 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5629 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5632 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_psLevelStats  . ps_iDeaths  += 1;
#line 5633 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_psGameStats  . ps_iDeaths  += 1;
#line 5634 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5637 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_iLastViewState  = m_iViewState ;
#line 5640 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetFlags  (GetFlags  () & ~ ENF_ALIVE );
#line 5642 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetDesiredTranslation  (FLOAT3D (0.0f , 0.0f , 0.0f));
#line 5643 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetDesiredRotation  (ANGLE3D (0.0f , 0.0f , 0.0f));
#line 5646 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerAnimator  &) * m_penAnimator ) . RemoveWeapon  ();
#line 5648 "C:/MyMod/Sources/EntitiesMP/Player.es"
GetPlayerWeapons  () -> SendEvent  (EStop  ());
#line 5651 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(! GetSP  () -> sp_bCooperative ){
#line 5653 "C:/MyMod/Sources/EntitiesMP/Player.es"
GetPlayerWeapons  () -> DropWeapon  ();
#line 5654 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5658 "C:/MyMod/Sources/EntitiesMP/Player.es"
INDEX iAnim1 ;
#line 5659 "C:/MyMod/Sources/EntitiesMP/Player.es"
INDEX iAnim2 ;
#line 5660 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_pstState  == PST_SWIM  || m_pstState  == PST_DIVE ){
#line 5661 "C:/MyMod/Sources/EntitiesMP/Player.es"
iAnim1  = PLAYER_ANIM_DEATH_UNDERWATER ;
#line 5662 "C:/MyMod/Sources/EntitiesMP/Player.es"
iAnim2  = BODY_ANIM_DEATH_UNDERWATER ;
#line 5663 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else if(eDeath  . eLastDamage  . dmtType  == DMT_SPIKESTAB ){
#line 5664 "C:/MyMod/Sources/EntitiesMP/Player.es"
iAnim1  = PLAYER_ANIM_DEATH_SPIKES ;
#line 5665 "C:/MyMod/Sources/EntitiesMP/Player.es"
iAnim2  = BODY_ANIM_DEATH_SPIKES ;
#line 5666 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else if(eDeath  . eLastDamage  . dmtType  == DMT_ABYSS ){
#line 5667 "C:/MyMod/Sources/EntitiesMP/Player.es"
iAnim1  = PLAYER_ANIM_ABYSSFALL ;
#line 5668 "C:/MyMod/Sources/EntitiesMP/Player.es"
iAnim2  = BODY_ANIM_ABYSSFALL ;
#line 5669 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 5670 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT3D vFront ;
#line 5671 "C:/MyMod/Sources/EntitiesMP/Player.es"
GetHeadingDirection  (0 , vFront );
#line 5672 "C:/MyMod/Sources/EntitiesMP/Player.es"
FLOAT fDamageDir  = m_vDamage  % vFront ;
#line 5673 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(fDamageDir  < 0){
#line 5674 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(Abs  (fDamageDir ) < 10.0f){
#line 5675 "C:/MyMod/Sources/EntitiesMP/Player.es"
iAnim1  = PLAYER_ANIM_DEATH_EASYFALLBACK ;
#line 5676 "C:/MyMod/Sources/EntitiesMP/Player.es"
iAnim2  = BODY_ANIM_DEATH_EASYFALLBACK ;
#line 5677 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 5678 "C:/MyMod/Sources/EntitiesMP/Player.es"
iAnim1  = PLAYER_ANIM_DEATH_BACK ;
#line 5679 "C:/MyMod/Sources/EntitiesMP/Player.es"
iAnim2  = BODY_ANIM_DEATH_BACK ;
#line 5680 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5681 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 5682 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(Abs  (fDamageDir ) < 10.0f){
#line 5683 "C:/MyMod/Sources/EntitiesMP/Player.es"
iAnim1  = PLAYER_ANIM_DEATH_EASYFALLFORWARD ;
#line 5684 "C:/MyMod/Sources/EntitiesMP/Player.es"
iAnim2  = BODY_ANIM_DEATH_EASYFALLFORWARD ;
#line 5685 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 5686 "C:/MyMod/Sources/EntitiesMP/Player.es"
iAnim1  = PLAYER_ANIM_DEATH_FORWARD ;
#line 5687 "C:/MyMod/Sources/EntitiesMP/Player.es"
iAnim2  = BODY_ANIM_DEATH_FORWARD ;
#line 5688 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5689 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5690 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5691 "C:/MyMod/Sources/EntitiesMP/Player.es"
en_plViewpoint  . pl_OrientationAngle  = ANGLE3D (0 , 0 , 0);
#line 5692 "C:/MyMod/Sources/EntitiesMP/Player.es"
StartModelAnim  (iAnim1  , 0);
#line 5693 "C:/MyMod/Sources/EntitiesMP/Player.es"
CModelObject & moBody  = GetModelObject  () -> GetAttachmentModel  (PLAYER_ATTACHMENT_TORSO ) -> amo_moModelObject ;
#line 5694 "C:/MyMod/Sources/EntitiesMP/Player.es"
moBody  . PlayAnim  (iAnim2  , 0);
#line 5697 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetPhysicsFlags  (EPF_MODEL_CORPSE );
#line 5698 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetCollisionFlags  (ECF_CORPSE );
#line 5701 "C:/MyMod/Sources/EntitiesMP/Player.es"
en_fDensity  = 400.0f;
#line 5704 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_pstState  == PST_DIVE ){
#line 5705 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetDefaultMouthPitch  ();
#line 5706 "C:/MyMod/Sources/EntitiesMP/Player.es"
PlaySound  (m_soMouth  , GenderSound  (SOUND_DEATHWATER ) , SOF_3D );
#line 5707 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(_pNetwork  -> IsPlayerLocal  (this )){IFeel_PlayEffect  ("DeathWater");}
#line 5708 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 5709 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetDefaultMouthPitch  ();
#line 5710 "C:/MyMod/Sources/EntitiesMP/Player.es"
PlaySound  (m_soMouth  , GenderSound  (SOUND_DEATH ) , SOF_3D );
#line 5711 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(_pNetwork  -> IsPlayerLocal  (this )){IFeel_PlayEffect  ("Death");}
#line 5712 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5715 "C:/MyMod/Sources/EntitiesMP/Player.es"
ASSERT  (m_penView  == NULL );
#line 5716 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_penView  == NULL ){
#line 5717 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_penView  = CreateEntity  (GetPlacement  () , CLASS_PLAYER_VIEW );
#line 5718 "C:/MyMod/Sources/EntitiesMP/Player.es"
EViewInit  eInit ;
#line 5719 "C:/MyMod/Sources/EntitiesMP/Player.es"
eInit  . penOwner  = this ;
#line 5720 "C:/MyMod/Sources/EntitiesMP/Player.es"
eInit  . penCamera  = NULL ;
#line 5721 "C:/MyMod/Sources/EntitiesMP/Player.es"
eInit  . vtView  = VT_PLAYERDEATH ;
#line 5722 "C:/MyMod/Sources/EntitiesMP/Player.es"
eInit  . bDeathFixed  = eDeath  . eLastDamage  . dmtType  == DMT_ABYSS ;
#line 5723 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_penView  -> Initialize  (eInit );
#line 5724 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5726 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(ShouldBlowUp  ()){
#line 5727 "C:/MyMod/Sources/EntitiesMP/Player.es"
BlowUp  ();
#line 5728 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 5730 "C:/MyMod/Sources/EntitiesMP/Player.es"
LeaveStain  (TRUE );
#line 5731 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5733 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_iMayRespawn  = 0;
#line 5735 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetTimerAfter(1.2f);
Jump(STATE_CURRENT, 0x0191000b, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x0191000b_Death_01(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191000b
switch(__eeInput.ee_slEvent){case(EVENTCODE_EBegin):{const EBegin&e= (EBegin&)__eeInput;

#line 5738 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_iViewState  = PVT_PLAYERAUTOVIEW ;
#line 5739 "C:/MyMod/Sources/EntitiesMP/Player.es"
return TRUE;
#line 5740 "C:/MyMod/Sources/EntitiesMP/Player.es"
}ASSERT(FALSE);break;case(EVENTCODE_ETimer):{const ETimer&e= (ETimer&)__eeInput;

#line 5744 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_iMayRespawn  = 1;
#line 5745 "C:/MyMod/Sources/EntitiesMP/Player.es"
return TRUE;
#line 5746 "C:/MyMod/Sources/EntitiesMP/Player.es"
}ASSERT(FALSE);break;case(EVENTCODE_EDamage):{const EDamage&eDamage= (EDamage&)__eeInput;

#line 5749 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(eDamage  . dmtType  == DMT_ABYSS ){
#line 5750 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_penView  != NULL ){
#line 5751 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerView  *) & * m_penView ) -> m_bFixed  = TRUE ;
#line 5752 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5753 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5755 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(ShouldBlowUp  ()){
#line 5757 "C:/MyMod/Sources/EntitiesMP/Player.es"
BlowUp  ();
#line 5758 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5759 "C:/MyMod/Sources/EntitiesMP/Player.es"
return TRUE;
#line 5760 "C:/MyMod/Sources/EntitiesMP/Player.es"
}ASSERT(FALSE);break;case(EVENTCODE_EDeath):{const EDeath&e= (EDeath&)__eeInput;
return TRUE;}ASSERT(FALSE);break;case(EVENTCODE_EEnd):{const EEnd&e= (EEnd&)__eeInput;

#line 5766 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(! IsPredictor  ()){
#line 5768 "C:/MyMod/Sources/EntitiesMP/Player.es"
UnsetTimer();Jump(STATE_CURRENT,0x0191000c, FALSE, EInternal());return TRUE;
#line 5769 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5770 "C:/MyMod/Sources/EntitiesMP/Player.es"
}ASSERT(FALSE);break;case(EVENTCODE_EAutoAction):{const EAutoAction&eAutoAction= (EAutoAction&)__eeInput;

#line 5774 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(GetSP  () -> sp_bCooperative  && ! GetSP  () -> sp_bSinglePlayer ){
#line 5776 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(eAutoAction  . penFirstMarker  != NULL  && 
#line 5777 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerActionMarker  *) & * eAutoAction  . penFirstMarker ) -> m_paaAction  == PAA_TELEPORT ){
#line 5779 "C:/MyMod/Sources/EntitiesMP/Player.es"
TeleportToAutoMarker  ((CPlayerActionMarker  *) & * eAutoAction  . penFirstMarker );
#line 5780 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5781 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5783 "C:/MyMod/Sources/EntitiesMP/Player.es"
return TRUE;
#line 5784 "C:/MyMod/Sources/EntitiesMP/Player.es"
}ASSERT(FALSE);break;case(EVENTCODE_EDisconnected):{const EDisconnected&e= (EDisconnected&)__eeInput;
return FALSE;}ASSERT(FALSE);break;case(EVENTCODE_EReceiveScore):{const EReceiveScore&e= (EReceiveScore&)__eeInput;
return FALSE;}ASSERT(FALSE);break;case(EVENTCODE_EKilledEnemy):{const EKilledEnemy&e= (EKilledEnemy&)__eeInput;
return FALSE;}ASSERT(FALSE);break;case(EVENTCODE_EPreLevelChange):{const EPreLevelChange&e= (EPreLevelChange&)__eeInput;
return FALSE;}ASSERT(FALSE);break;case(EVENTCODE_EPostLevelChange):{const EPostLevelChange&e= (EPostLevelChange&)__eeInput;
return FALSE;}ASSERT(FALSE);break;default:{return TRUE;}ASSERT(FALSE);break;
#line 5791 "C:/MyMod/Sources/EntitiesMP/Player.es"
}return TRUE;}BOOL CPlayer::H0x0191000c_Death_02(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191000c

#line 5793 "C:/MyMod/Sources/EntitiesMP/Player.es"
Return(STATE_CURRENT,ERebirth  ());
#line 5793 "C:/MyMod/Sources/EntitiesMP/Player.es"
return TRUE; ASSERT(FALSE); return TRUE;};BOOL CPlayer::
#line 5796 "C:/MyMod/Sources/EntitiesMP/Player.es"
TheEnd(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT STATE_CPlayer_TheEnd
  ASSERTMSG(__eeInput.ee_slEvent==EVENTCODE_EVoid, "CPlayer::TheEnd expects 'EVoid' as input!");  const EVoid &e = (const EVoid &)__eeInput;
#line 5798 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(! _pNetwork  -> IsPlayingDemo  ()){
#line 5800 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(GetSP  () -> sp_bSinglePlayer ){
#line 5801 "C:/MyMod/Sources/EntitiesMP/Player.es"
_pShell  -> Execute  ("gam_iRecordHighScore=0;");
#line 5802 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5803 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5805 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(GetSP  () -> sp_gdGameDifficulty  == CSessionProperties  :: GD_EXTREME ){
#line 5807 "C:/MyMod/Sources/EntitiesMP/Player.es"
_pShell  -> Execute  ("sam_bMentalActivated=1;");
#line 5808 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5811 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerWeapons  &) * m_penWeapons ) . SendEvent  (EReleaseWeapon  ());
#line 5814 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetFlags  (GetFlags  () & ~ ENF_ALIVE );
#line 5816 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetDesiredTranslation  (FLOAT3D (0.0f , 0.0f , 0.0f));
#line 5817 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetDesiredRotation  (ANGLE3D (0.0f , 0.0f , 0.0f));
#line 5820 "C:/MyMod/Sources/EntitiesMP/Player.es"
StartModelAnim  (PLAYER_ANIM_STAND  , 0);
#line 5821 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerAnimator  &) * m_penAnimator ) . BodyAnimationTemplate  (
#line 5822 "C:/MyMod/Sources/EntitiesMP/Player.es"
BODY_ANIM_NORMALWALK  , BODY_ANIM_COLT_STAND  , BODY_ANIM_SHOTGUN_STAND  , BODY_ANIM_MINIGUN_STAND  , 
#line 5823 "C:/MyMod/Sources/EntitiesMP/Player.es"
AOF_LOOPING  | AOF_NORESTART );
#line 5825 "C:/MyMod/Sources/EntitiesMP/Player.es"
en_plViewpoint  . pl_OrientationAngle  = ANGLE3D (0 , 0 , 0);
#line 5828 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_bEndOfGame  = TRUE ;
#line 5829 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetGameEnd  ();
#line 5831 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetTimerAt(THINKTIME_NEVER);
Jump(STATE_CURRENT, 0x0191000e, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x0191000e_TheEnd_01(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191000e
switch(__eeInput.ee_slEvent){case(EVENTCODE_EBegin):{const EBegin&e= (EBegin&)__eeInput;
return TRUE;}ASSERT(FALSE);break;case(EVENTCODE_EReceiveScore):{const EReceiveScore&e= (EReceiveScore&)__eeInput;
return FALSE;}ASSERT(FALSE);break;case(EVENTCODE_EKilledEnemy):{const EKilledEnemy&e= (EKilledEnemy&)__eeInput;
return FALSE;}ASSERT(FALSE);break;case(EVENTCODE_ECenterMessage):{const ECenterMessage&e= (ECenterMessage&)__eeInput;
return FALSE;}ASSERT(FALSE);break;default:{return TRUE;}ASSERT(FALSE);break;
#line 5837 "C:/MyMod/Sources/EntitiesMP/Player.es"
}return TRUE;}BOOL CPlayer::H0x0191000f_TheEnd_02(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191000f
 ASSERT(FALSE); return TRUE;};BOOL CPlayer::
#line 5843 "C:/MyMod/Sources/EntitiesMP/Player.es"
FirstInit(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT STATE_CPlayer_FirstInit
  ASSERTMSG(__eeInput.ee_slEvent==EVENTCODE_EVoid, "CPlayer::FirstInit expects 'EVoid' as input!");  const EVoid &e = (const EVoid &)__eeInput;
#line 5845 "C:/MyMod/Sources/EntitiesMP/Player.es"
bUseButtonHeld  = FALSE ;
#line 5848 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_iViewState  = m_iLastViewState ;
#line 5851 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_penView  != NULL ){
#line 5852 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerView  &) * m_penView ) . SendEvent  (EEnd  ());
#line 5853 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_penView  = NULL ;
#line 5854 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5856 "C:/MyMod/Sources/EntitiesMP/Player.es"
FindMusicHolder  ();
#line 5859 "C:/MyMod/Sources/EntitiesMP/Player.es"
UpdateLevelStats  ();
#line 5862 "C:/MyMod/Sources/EntitiesMP/Player.es"
InitializePlayer  ();
#line 5865 "C:/MyMod/Sources/EntitiesMP/Player.es"
ReceiveComputerMessage  (CTFILENAME  ("Data\\Messages\\Statistics\\Statistics.txt") , CMF_READ );
#line 5867 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(GetSettings  () -> ps_ulFlags  & PSF_PREFER3RDPERSON ){
#line 5868 "C:/MyMod/Sources/EntitiesMP/Player.es"
ChangePlayerView  ();
#line 5869 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5871 "C:/MyMod/Sources/EntitiesMP/Player.es"
Return(STATE_CURRENT,EVoid());
#line 5871 "C:/MyMod/Sources/EntitiesMP/Player.es"
return TRUE; ASSERT(FALSE); return TRUE;};BOOL CPlayer::
#line 5874 "C:/MyMod/Sources/EntitiesMP/Player.es"
Rebirth(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT STATE_CPlayer_Rebirth
  ASSERTMSG(__eeInput.ee_slEvent==EVENTCODE_EVoid, "CPlayer::Rebirth expects 'EVoid' as input!");  const EVoid &e = (const EVoid &)__eeInput;
#line 5876 "C:/MyMod/Sources/EntitiesMP/Player.es"
bUseButtonHeld  = FALSE ;
#line 5879 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_iViewState  = m_iLastViewState ;
#line 5881 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(! (m_ulFlags  & PLF_RESPAWNINPLACE )){
#line 5882 "C:/MyMod/Sources/EntitiesMP/Player.es"
GetPlayerWeapons  () -> ClearWeapons  ();
#line 5883 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5886 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_penView  != NULL ){
#line 5887 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerView  &) * m_penView ) . SendEvent  (EEnd  ());
#line 5888 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_penView  = NULL ;
#line 5889 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5892 "C:/MyMod/Sources/EntitiesMP/Player.es"
CEntityPointer penFlame  = GetChildOfClass  ("Flame");
#line 5893 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(penFlame  != NULL )
#line 5894 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 5896 "C:/MyMod/Sources/EntitiesMP/Player.es"
EStopFlaming  esf ;
#line 5897 "C:/MyMod/Sources/EntitiesMP/Player.es"
esf  . m_bNow  = TRUE ;
#line 5898 "C:/MyMod/Sources/EntitiesMP/Player.es"
penFlame  -> SendEvent  (esf );
#line 5899 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5901 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_penView  != NULL ){
#line 5902 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerView  &) * m_penView ) . SendEvent  (EEnd  ());
#line 5903 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_penView  = NULL ;
#line 5904 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5906 "C:/MyMod/Sources/EntitiesMP/Player.es"
FindMusicHolder  ();
#line 5909 "C:/MyMod/Sources/EntitiesMP/Player.es"
InitializePlayer  ();
#line 5911 "C:/MyMod/Sources/EntitiesMP/Player.es"
Return(STATE_CURRENT,EReturn  ());
#line 5911 "C:/MyMod/Sources/EntitiesMP/Player.es"
return TRUE; ASSERT(FALSE); return TRUE;};BOOL CPlayer::
#line 5916 "C:/MyMod/Sources/EntitiesMP/Player.es"
AutoGoToMarker(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT STATE_CPlayer_AutoGoToMarker
  ASSERTMSG(__eeInput.ee_slEvent==EVENTCODE_EVoid, "CPlayer::AutoGoToMarker expects 'EVoid' as input!");  const EVoid &e = (const EVoid &)__eeInput;
#line 5918 "C:/MyMod/Sources/EntitiesMP/Player.es"
ULONG  ulFlags  = AOF_LOOPING  | AOF_NORESTART ;
#line 5920 "C:/MyMod/Sources/EntitiesMP/Player.es"
INDEX iAnim  = GetModelObject  () -> GetAnim  ();
#line 5921 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(iAnim  != PLAYER_ANIM_STAND )
#line 5922 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 5923 "C:/MyMod/Sources/EntitiesMP/Player.es"
ulFlags  |= AOF_SMOOTHCHANGE ;
#line 5924 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5926 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlayerAnimator  & plan  = (CPlayerAnimator  &) * m_penAnimator ;
#line 5927 "C:/MyMod/Sources/EntitiesMP/Player.es"
plan  . m_bAttacking  = FALSE ;
#line 5928 "C:/MyMod/Sources/EntitiesMP/Player.es"
plan  . BodyWalkAnimation  ();
#line 5929 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_fAutoSpeed  > plr_fSpeedForward  / 2){
#line 5930 "C:/MyMod/Sources/EntitiesMP/Player.es"
StartModelAnim  (PLAYER_ANIM_RUN  , ulFlags );
#line 5931 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 5932 "C:/MyMod/Sources/EntitiesMP/Player.es"
StartModelAnim  (PLAYER_ANIM_NORMALWALK  , ulFlags );
#line 5933 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5936 "C:/MyMod/Sources/EntitiesMP/Player.es"
Jump(STATE_CURRENT,0x01910015, FALSE, EInternal());return TRUE;}BOOL CPlayer::H0x01910015_AutoGoToMarker_03(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910015
if(!(
#line 5937 "C:/MyMod/Sources/EntitiesMP/Player.es"
(m_penActionMarker  -> GetPlacement  () . pl_PositionVector  - 
#line 5938 "C:/MyMod/Sources/EntitiesMP/Player.es"
GetPlacement  () . pl_PositionVector ) . Length  () > 1.0f)){ Jump(STATE_CURRENT,0x01910016, FALSE, EInternal());return TRUE;}
#line 5940 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetTimerAfter(_pTimer  -> TickQuantum );
Jump(STATE_CURRENT, 0x01910013, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x01910013_AutoGoToMarker_01(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910013
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: return TRUE;case EVENTCODE_ETimer: Jump(STATE_CURRENT,0x01910014, FALSE, EInternal()); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x01910014_AutoGoToMarker_02(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910014
;Jump(STATE_CURRENT,0x01910015, FALSE, EInternal());return TRUE;
#line 5941 "C:/MyMod/Sources/EntitiesMP/Player.es"
}BOOL CPlayer::H0x01910016_AutoGoToMarker_04(const CEntityEvent &__eeInput) {
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910016

#line 5944 "C:/MyMod/Sources/EntitiesMP/Player.es"
Return(STATE_CURRENT,EReturn  ());
#line 5944 "C:/MyMod/Sources/EntitiesMP/Player.es"
return TRUE; ASSERT(FALSE); return TRUE;};BOOL CPlayer::
#line 5948 "C:/MyMod/Sources/EntitiesMP/Player.es"
AutoGoToMarkerAndStop(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT STATE_CPlayer_AutoGoToMarkerAndStop
  ASSERTMSG(__eeInput.ee_slEvent==EVENTCODE_EVoid, "CPlayer::AutoGoToMarkerAndStop expects 'EVoid' as input!");  const EVoid &e = (const EVoid &)__eeInput;
#line 5950 "C:/MyMod/Sources/EntitiesMP/Player.es"
ULONG  ulFlags  = AOF_LOOPING  | AOF_NORESTART ;
#line 5952 "C:/MyMod/Sources/EntitiesMP/Player.es"
INDEX iAnim  = GetModelObject  () -> GetAnim  ();
#line 5953 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(iAnim  != PLAYER_ANIM_STAND )
#line 5954 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 5955 "C:/MyMod/Sources/EntitiesMP/Player.es"
ulFlags  |= AOF_SMOOTHCHANGE ;
#line 5956 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5958 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlayerAnimator  & plan  = (CPlayerAnimator  &) * m_penAnimator ;
#line 5959 "C:/MyMod/Sources/EntitiesMP/Player.es"
plan  . BodyWalkAnimation  ();
#line 5960 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_fAutoSpeed  > plr_fSpeedForward  / 2){
#line 5961 "C:/MyMod/Sources/EntitiesMP/Player.es"
StartModelAnim  (PLAYER_ANIM_RUN  , ulFlags );
#line 5962 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 5963 "C:/MyMod/Sources/EntitiesMP/Player.es"
StartModelAnim  (PLAYER_ANIM_NORMALWALK  , ulFlags );
#line 5964 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 5967 "C:/MyMod/Sources/EntitiesMP/Player.es"
Jump(STATE_CURRENT,0x0191001a, FALSE, EInternal());return TRUE;}BOOL CPlayer::H0x0191001a_AutoGoToMarkerAndStop_03(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191001a
if(!(
#line 5968 "C:/MyMod/Sources/EntitiesMP/Player.es"
(m_penActionMarker  -> GetPlacement  () . pl_PositionVector  - 
#line 5969 "C:/MyMod/Sources/EntitiesMP/Player.es"
GetPlacement  () . pl_PositionVector ) . Length  () > m_fAutoSpeed  * _pTimer  -> TickQuantum  * 2.00f)){ Jump(STATE_CURRENT,0x0191001b, FALSE, EInternal());return TRUE;}
#line 5971 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetTimerAfter(_pTimer  -> TickQuantum );
Jump(STATE_CURRENT, 0x01910018, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x01910018_AutoGoToMarkerAndStop_01(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910018
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: return TRUE;case EVENTCODE_ETimer: Jump(STATE_CURRENT,0x01910019, FALSE, EInternal()); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x01910019_AutoGoToMarkerAndStop_02(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910019
;Jump(STATE_CURRENT,0x0191001a, FALSE, EInternal());return TRUE;
#line 5972 "C:/MyMod/Sources/EntitiesMP/Player.es"
}BOOL CPlayer::H0x0191001b_AutoGoToMarkerAndStop_04(const CEntityEvent &__eeInput) {
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191001b

#line 5974 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_fAutoSpeed  = 0.0f;
#line 5976 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlayerAnimator  & plan  = (CPlayerAnimator  &) * m_penAnimator ;
#line 5977 "C:/MyMod/Sources/EntitiesMP/Player.es"
plan  . BodyStillAnimation  ();
#line 5978 "C:/MyMod/Sources/EntitiesMP/Player.es"
StartModelAnim  (PLAYER_ANIM_STAND  , AOF_LOOPING  | AOF_NORESTART );
#line 5981 "C:/MyMod/Sources/EntitiesMP/Player.es"
ForceFullStop  ();
#line 5984 "C:/MyMod/Sources/EntitiesMP/Player.es"
Return(STATE_CURRENT,EReturn  ());
#line 5984 "C:/MyMod/Sources/EntitiesMP/Player.es"
return TRUE; ASSERT(FALSE); return TRUE;};BOOL CPlayer::
#line 5988 "C:/MyMod/Sources/EntitiesMP/Player.es"
AutoUseItem(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT STATE_CPlayer_AutoUseItem
  ASSERTMSG(__eeInput.ee_slEvent==EVENTCODE_EVoid, "CPlayer::AutoUseItem expects 'EVoid' as input!");  const EVoid &e = (const EVoid &)__eeInput;
#line 5992 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlayerAnimator  & plan  = (CPlayerAnimator  &) * m_penAnimator ;
#line 5993 "C:/MyMod/Sources/EntitiesMP/Player.es"
plan  . BodyPullItemAnimation  ();
#line 5996 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetTimerAfter(0.2f);
Jump(STATE_CURRENT, 0x0191001d, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x0191001d_AutoUseItem_01(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191001d
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: return TRUE;case EVENTCODE_ETimer: Jump(STATE_CURRENT,0x0191001e, FALSE, EInternal()); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x0191001e_AutoUseItem_02(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191001e
;
#line 5999 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlayerActionMarker  * ppam  = GetActionMarker  ();
#line 6000 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(IsOfClass  (ppam  -> m_penItem  , "KeyItem")){
#line 6001 "C:/MyMod/Sources/EntitiesMP/Player.es"
CModelObject & moItem  = ppam  -> m_penItem  -> GetModelObject  () -> GetAttachmentModel  (0) -> amo_moModelObject ;
#line 6002 "C:/MyMod/Sources/EntitiesMP/Player.es"
GetPlayerAnimator  () -> SetItem  (& moItem );
#line 6003 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 6005 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetTimerAfter(2.20f - 0.2f);
Jump(STATE_CURRENT, 0x0191001f, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x0191001f_AutoUseItem_03(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191001f
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: return TRUE;case EVENTCODE_ETimer: Jump(STATE_CURRENT,0x01910020, FALSE, EInternal()); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x01910020_AutoUseItem_04(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910020
;
#line 6008 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlayerAnimator  & plan  = (CPlayerAnimator  &) * m_penAnimator ;
#line 6009 "C:/MyMod/Sources/EntitiesMP/Player.es"
plan  . BodyRemoveItem  ();
#line 6011 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(GetActionMarker  () -> m_penTrigger  != NULL ){
#line 6013 "C:/MyMod/Sources/EntitiesMP/Player.es"
SendToTarget  (GetActionMarker  () -> m_penTrigger  , EET_TRIGGER  , this );
#line 6014 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 6017 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(GetActionMarker  () -> m_penDoorController  != NULL ){
#line 6018 "C:/MyMod/Sources/EntitiesMP/Player.es"
EPass  ePass ;
#line 6019 "C:/MyMod/Sources/EntitiesMP/Player.es"
ePass  . penOther  = this ;
#line 6020 "C:/MyMod/Sources/EntitiesMP/Player.es"
GetActionMarker  () -> m_penDoorController  -> SendEvent  (ePass );
#line 6021 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 6023 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetTimerAfter(3.25f - 2.20f);
Jump(STATE_CURRENT, 0x01910021, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x01910021_AutoUseItem_05(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910021
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: return TRUE;case EVENTCODE_ETimer: Jump(STATE_CURRENT,0x01910022, FALSE, EInternal()); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x01910022_AutoUseItem_06(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910022
;
#line 6025 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlayerAnimator  & plan  = (CPlayerAnimator  &) * m_penAnimator ;
#line 6026 "C:/MyMod/Sources/EntitiesMP/Player.es"
plan  . BodyRemoveItem  ();
#line 6029 "C:/MyMod/Sources/EntitiesMP/Player.es"
Return(STATE_CURRENT,EReturn  ());
#line 6029 "C:/MyMod/Sources/EntitiesMP/Player.es"
return TRUE; ASSERT(FALSE); return TRUE;};BOOL CPlayer::
#line 6033 "C:/MyMod/Sources/EntitiesMP/Player.es"
AutoPickItem(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT STATE_CPlayer_AutoPickItem
  ASSERTMSG(__eeInput.ee_slEvent==EVENTCODE_EVoid, "CPlayer::AutoPickItem expects 'EVoid' as input!");  const EVoid &e = (const EVoid &)__eeInput;
#line 6037 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlayerAnimator  & plan  = (CPlayerAnimator  &) * m_penAnimator ;
#line 6038 "C:/MyMod/Sources/EntitiesMP/Player.es"
plan  . BodyPickItemAnimation  ();
#line 6039 "C:/MyMod/Sources/EntitiesMP/Player.es"
StartModelAnim  (PLAYER_ANIM_KEYLIFT  , 0);
#line 6041 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetTimerAfter(1.2f);
Jump(STATE_CURRENT, 0x01910024, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x01910024_AutoPickItem_01(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910024
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: return TRUE;case EVENTCODE_ETimer: Jump(STATE_CURRENT,0x01910025, FALSE, EInternal()); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x01910025_AutoPickItem_02(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910025
;
#line 6044 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(GetActionMarker  () -> m_penTrigger  != NULL ){
#line 6046 "C:/MyMod/Sources/EntitiesMP/Player.es"
SendToTarget  (GetActionMarker  () -> m_penTrigger  , EET_TRIGGER  , this );
#line 6047 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 6050 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlayerActionMarker  * ppam  = GetActionMarker  ();
#line 6051 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(IsOfClass  (ppam  -> m_penItem  , "KeyItem")){
#line 6052 "C:/MyMod/Sources/EntitiesMP/Player.es"
CModelObject & moItem  = ppam  -> m_penItem  -> GetModelObject  () -> GetAttachmentModel  (0) -> amo_moModelObject ;
#line 6053 "C:/MyMod/Sources/EntitiesMP/Player.es"
GetPlayerAnimator  () -> SetItem  (& moItem );
#line 6054 "C:/MyMod/Sources/EntitiesMP/Player.es"
EPass  ePass ;
#line 6055 "C:/MyMod/Sources/EntitiesMP/Player.es"
ePass  . penOther  = this ;
#line 6056 "C:/MyMod/Sources/EntitiesMP/Player.es"
ppam  -> m_penItem  -> SendEvent  (ePass );
#line 6057 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 6059 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetTimerAfter(3.6f - 1.2f + GetActionMarker  () -> m_tmWait );
Jump(STATE_CURRENT, 0x01910026, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x01910026_AutoPickItem_03(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910026
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: return TRUE;case EVENTCODE_ETimer: Jump(STATE_CURRENT,0x01910027, FALSE, EInternal()); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x01910027_AutoPickItem_04(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910027
;
#line 6061 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlayerAnimator  & plan  = (CPlayerAnimator  &) * m_penAnimator ;
#line 6062 "C:/MyMod/Sources/EntitiesMP/Player.es"
plan  . BodyRemoveItem  ();
#line 6065 "C:/MyMod/Sources/EntitiesMP/Player.es"
Return(STATE_CURRENT,EReturn  ());
#line 6065 "C:/MyMod/Sources/EntitiesMP/Player.es"
return TRUE; ASSERT(FALSE); return TRUE;};BOOL CPlayer::
#line 6068 "C:/MyMod/Sources/EntitiesMP/Player.es"
AutoFallDown(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT STATE_CPlayer_AutoFallDown
  ASSERTMSG(__eeInput.ee_slEvent==EVENTCODE_EVoid, "CPlayer::AutoFallDown expects 'EVoid' as input!");  const EVoid &e = (const EVoid &)__eeInput;
#line 6070 "C:/MyMod/Sources/EntitiesMP/Player.es"
StartModelAnim  (PLAYER_ANIM_BRIDGEFALLPOSE  , 0);
#line 6071 "C:/MyMod/Sources/EntitiesMP/Player.es"
CModelObject & moBody  = GetModelObject  () -> GetAttachmentModel  (PLAYER_ATTACHMENT_TORSO ) -> amo_moModelObject ;
#line 6072 "C:/MyMod/Sources/EntitiesMP/Player.es"
moBody  . PlayAnim  (BODY_ANIM_BRIDGEFALLPOSE  , 0);
#line 6074 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetTimerAfter(GetActionMarker  () -> m_tmWait );
Jump(STATE_CURRENT, 0x01910029, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x01910029_AutoFallDown_01(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910029
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: return TRUE;case EVENTCODE_ETimer: Jump(STATE_CURRENT,0x0191002a, FALSE, EInternal()); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x0191002a_AutoFallDown_02(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191002a
;
#line 6077 "C:/MyMod/Sources/EntitiesMP/Player.es"
Return(STATE_CURRENT,EReturn  ());
#line 6077 "C:/MyMod/Sources/EntitiesMP/Player.es"
return TRUE; ASSERT(FALSE); return TRUE;};BOOL CPlayer::
#line 6080 "C:/MyMod/Sources/EntitiesMP/Player.es"
AutoFallToAbys(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT STATE_CPlayer_AutoFallToAbys
  ASSERTMSG(__eeInput.ee_slEvent==EVENTCODE_EVoid, "CPlayer::AutoFallToAbys expects 'EVoid' as input!");  const EVoid &e = (const EVoid &)__eeInput;
#line 6082 "C:/MyMod/Sources/EntitiesMP/Player.es"
StartModelAnim  (PLAYER_ANIM_ABYSSFALL  , AOF_LOOPING );
#line 6083 "C:/MyMod/Sources/EntitiesMP/Player.es"
CModelObject & moBody  = GetModelObject  () -> GetAttachmentModel  (PLAYER_ATTACHMENT_TORSO ) -> amo_moModelObject ;
#line 6084 "C:/MyMod/Sources/EntitiesMP/Player.es"
moBody  . PlayAnim  (BODY_ANIM_ABYSSFALL  , AOF_LOOPING );
#line 6086 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetTimerAfter(GetActionMarker  () -> m_tmWait );
Jump(STATE_CURRENT, 0x0191002c, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x0191002c_AutoFallToAbys_01(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191002c
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: return TRUE;case EVENTCODE_ETimer: Jump(STATE_CURRENT,0x0191002d, FALSE, EInternal()); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x0191002d_AutoFallToAbys_02(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191002d
;
#line 6089 "C:/MyMod/Sources/EntitiesMP/Player.es"
Return(STATE_CURRENT,EReturn  ());
#line 6089 "C:/MyMod/Sources/EntitiesMP/Player.es"
return TRUE; ASSERT(FALSE); return TRUE;};BOOL CPlayer::
#line 6093 "C:/MyMod/Sources/EntitiesMP/Player.es"
AutoLookAround(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT STATE_CPlayer_AutoLookAround
  ASSERTMSG(__eeInput.ee_slEvent==EVENTCODE_EVoid, "CPlayer::AutoLookAround expects 'EVoid' as input!");  const EVoid &e = (const EVoid &)__eeInput;
#line 6095 "C:/MyMod/Sources/EntitiesMP/Player.es"
StartModelAnim  (PLAYER_ANIM_BACKPEDAL  , 0);
#line 6096 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_vAutoSpeed  = FLOAT3D (0 , 0 , plr_fSpeedForward  / 4 / 0.75f);
#line 6097 "C:/MyMod/Sources/EntitiesMP/Player.es"
CModelObject & moBody  = GetModelObject  () -> GetAttachmentModel  (PLAYER_ATTACHMENT_TORSO ) -> amo_moModelObject ;
#line 6098 "C:/MyMod/Sources/EntitiesMP/Player.es"
moBody  . PlayAnim  (BODY_ANIM_NORMALWALK  , 0);
#line 6100 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetTimerAfter(GetModelObject  () -> GetCurrentAnimLength  () / 2);
Jump(STATE_CURRENT, 0x0191002f, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x0191002f_AutoLookAround_01(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191002f
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: return TRUE;case EVENTCODE_ETimer: Jump(STATE_CURRENT,0x01910030, FALSE, EInternal()); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x01910030_AutoLookAround_02(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910030
;
#line 6102 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_vAutoSpeed  = FLOAT3D (0 , 0 , 0);
#line 6105 "C:/MyMod/Sources/EntitiesMP/Player.es"
StartModelAnim  (PLAYER_ANIM_STAND  , 0);
#line 6106 "C:/MyMod/Sources/EntitiesMP/Player.es"
CModelObject & moBody  = GetModelObject  () -> GetAttachmentModel  (PLAYER_ATTACHMENT_TORSO ) -> amo_moModelObject ;
#line 6107 "C:/MyMod/Sources/EntitiesMP/Player.es"
moBody  . PlayAnim  (BODY_ANIM_LOOKAROUND  , 0);
#line 6108 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlayerAnimator  & plan  = (CPlayerAnimator  &) * m_penAnimator ;
#line 6111 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetTimerAfter(moBody  . GetCurrentAnimLength  () + 0.1f);
Jump(STATE_CURRENT, 0x01910031, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x01910031_AutoLookAround_03(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910031
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: return TRUE;case EVENTCODE_ETimer: Jump(STATE_CURRENT,0x01910032, FALSE, EInternal()); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x01910032_AutoLookAround_04(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910032
;
#line 6114 "C:/MyMod/Sources/EntitiesMP/Player.es"
Return(STATE_CURRENT,EReturn  ());
#line 6114 "C:/MyMod/Sources/EntitiesMP/Player.es"
return TRUE; ASSERT(FALSE); return TRUE;};BOOL CPlayer::
#line 6117 "C:/MyMod/Sources/EntitiesMP/Player.es"
AutoTeleport(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT STATE_CPlayer_AutoTeleport
  ASSERTMSG(__eeInput.ee_slEvent==EVENTCODE_EVoid, "CPlayer::AutoTeleport expects 'EVoid' as input!");  const EVoid &e = (const EVoid &)__eeInput;
#line 6120 "C:/MyMod/Sources/EntitiesMP/Player.es"
TeleportToAutoMarker  (GetActionMarker  ());
#line 6123 "C:/MyMod/Sources/EntitiesMP/Player.es"
Return(STATE_CURRENT,EReturn  ());
#line 6123 "C:/MyMod/Sources/EntitiesMP/Player.es"
return TRUE; ASSERT(FALSE); return TRUE;};BOOL CPlayer::
#line 6126 "C:/MyMod/Sources/EntitiesMP/Player.es"
AutoAppear(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT STATE_CPlayer_AutoAppear
  ASSERTMSG(__eeInput.ee_slEvent==EVENTCODE_EVoid, "CPlayer::AutoAppear expects 'EVoid' as input!");  const EVoid &e = (const EVoid &)__eeInput;
#line 6129 "C:/MyMod/Sources/EntitiesMP/Player.es"
SwitchToEditorModel  ();
#line 6132 "C:/MyMod/Sources/EntitiesMP/Player.es"
Teleport  (GetActionMarker  () -> GetPlacement  ());
#line 6134 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetPhysicsFlags  (GetPhysicsFlags  () & ~ (EPF_TRANSLATEDBYGRAVITY  | EPF_ORIENTEDBYGRAVITY ));
#line 6135 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_ulFlags  |= PLF_AUTOMOVEMENTS ;
#line 6136 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetDesiredRotation  (ANGLE3D (60 , 0 , 0));
#line 6137 "C:/MyMod/Sources/EntitiesMP/Player.es"
StartModelAnim  (PLAYER_ANIM_SPAWNPOSE  , AOF_LOOPING );
#line 6138 "C:/MyMod/Sources/EntitiesMP/Player.es"
CModelObject & moBody  = GetModelObject  () -> GetAttachmentModel  (PLAYER_ATTACHMENT_TORSO ) -> amo_moModelObject ;
#line 6139 "C:/MyMod/Sources/EntitiesMP/Player.es"
moBody  . PlayAnim  (BODY_ANIM_SPAWNPOSE  , AOF_LOOPING );
#line 6142 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_tmSpiritStart  = _pTimer  -> CurrentTick  ();
#line 6144 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetTimerAfter(5);
Jump(STATE_CURRENT, 0x01910035, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x01910035_AutoAppear_01(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910035
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: return TRUE;case EVENTCODE_ETimer: Jump(STATE_CURRENT,0x01910036, FALSE, EInternal()); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x01910036_AutoAppear_02(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910036
;
#line 6147 "C:/MyMod/Sources/EntitiesMP/Player.es"
SwitchToModel  ();
#line 6148 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_tmFadeStart  = _pTimer  -> CurrentTick  ();
#line 6150 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetTimerAfter(5);
Jump(STATE_CURRENT, 0x01910037, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x01910037_AutoAppear_03(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910037
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: return TRUE;case EVENTCODE_ETimer: Jump(STATE_CURRENT,0x01910038, FALSE, EInternal()); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x01910038_AutoAppear_04(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910038
;
#line 6152 "C:/MyMod/Sources/EntitiesMP/Player.es"
COLOR colAlpha  = GetModelObject  () -> mo_colBlendColor ;
#line 6153 "C:/MyMod/Sources/EntitiesMP/Player.es"
GetModelObject  () -> mo_colBlendColor  = colAlpha  | 0xFF;
#line 6156 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetPhysicsFlags  (GetPhysicsFlags  () | EPF_TRANSLATEDBYGRAVITY  | EPF_ORIENTEDBYGRAVITY );
#line 6157 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetDesiredRotation  (ANGLE3D (0 , 0 , 0));
#line 6158 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_ulFlags  &= ~ PLF_AUTOMOVEMENTS ;
#line 6161 "C:/MyMod/Sources/EntitiesMP/Player.es"
StartModelAnim  (PLAYER_ANIM_SPAWN_FALLDOWN  , 0);
#line 6162 "C:/MyMod/Sources/EntitiesMP/Player.es"
CModelObject & moBody  = GetModelObject  () -> GetAttachmentModel  (PLAYER_ATTACHMENT_TORSO ) -> amo_moModelObject ;
#line 6163 "C:/MyMod/Sources/EntitiesMP/Player.es"
moBody  . PlayAnim  (BODY_ANIM_SPAWN_FALLDOWN  , 0);
#line 6165 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetTimerAfter(GetModelObject  () -> GetCurrentAnimLength  ());
Jump(STATE_CURRENT, 0x01910039, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x01910039_AutoAppear_05(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910039
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: return TRUE;case EVENTCODE_ETimer: Jump(STATE_CURRENT,0x0191003a, FALSE, EInternal()); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x0191003a_AutoAppear_06(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191003a
;
#line 6168 "C:/MyMod/Sources/EntitiesMP/Player.es"
StartModelAnim  (PLAYER_ANIM_SPAWN_GETUP  , AOF_SMOOTHCHANGE );
#line 6169 "C:/MyMod/Sources/EntitiesMP/Player.es"
CModelObject & moBody  = GetModelObject  () -> GetAttachmentModel  (PLAYER_ATTACHMENT_TORSO ) -> amo_moModelObject ;
#line 6170 "C:/MyMod/Sources/EntitiesMP/Player.es"
moBody  . PlayAnim  (BODY_ANIM_SPAWN_GETUP  , AOF_SMOOTHCHANGE );
#line 6172 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetTimerAfter(GetModelObject  () -> GetCurrentAnimLength  ());
Jump(STATE_CURRENT, 0x0191003b, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x0191003b_AutoAppear_07(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191003b
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: return TRUE;case EVENTCODE_ETimer: Jump(STATE_CURRENT,0x0191003c, FALSE, EInternal()); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x0191003c_AutoAppear_08(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191003c
;
#line 6175 "C:/MyMod/Sources/EntitiesMP/Player.es"
Return(STATE_CURRENT,EReturn  ());
#line 6175 "C:/MyMod/Sources/EntitiesMP/Player.es"
return TRUE; ASSERT(FALSE); return TRUE;};BOOL CPlayer::
#line 6178 "C:/MyMod/Sources/EntitiesMP/Player.es"
TravellingInBeam(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT STATE_CPlayer_TravellingInBeam
  ASSERTMSG(__eeInput.ee_slEvent==EVENTCODE_EVoid, "CPlayer::TravellingInBeam expects 'EVoid' as input!");  const EVoid &e = (const EVoid &)__eeInput;
#line 6181 "C:/MyMod/Sources/EntitiesMP/Player.es"
Teleport  (GetActionMarker  () -> GetPlacement  ());
#line 6183 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetPhysicsFlags  (GetPhysicsFlags  () & ~ (EPF_TRANSLATEDBYGRAVITY  | EPF_ORIENTEDBYGRAVITY ));
#line 6184 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_ulFlags  |= PLF_AUTOMOVEMENTS ;
#line 6185 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetDesiredRotation  (ANGLE3D (60 , 0 , 0));
#line 6186 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetDesiredTranslation  (ANGLE3D (0 , 20.0f , 0));
#line 6187 "C:/MyMod/Sources/EntitiesMP/Player.es"
StartModelAnim  (PLAYER_ANIM_SPAWNPOSE  , AOF_LOOPING );
#line 6188 "C:/MyMod/Sources/EntitiesMP/Player.es"
CModelObject & moBody  = GetModelObject  () -> GetAttachmentModel  (PLAYER_ATTACHMENT_TORSO ) -> amo_moModelObject ;
#line 6189 "C:/MyMod/Sources/EntitiesMP/Player.es"
moBody  . PlayAnim  (BODY_ANIM_SPAWNPOSE  , AOF_LOOPING );
#line 6191 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetTimerAfter(8.0f);
Jump(STATE_CURRENT, 0x0191003e, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x0191003e_TravellingInBeam_01(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191003e
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: return TRUE;case EVENTCODE_ETimer: Jump(STATE_CURRENT,0x0191003f, FALSE, EInternal()); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x0191003f_TravellingInBeam_02(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191003f
;
#line 6193 "C:/MyMod/Sources/EntitiesMP/Player.es"
SwitchToEditorModel  ();
#line 6195 "C:/MyMod/Sources/EntitiesMP/Player.es"
Return(STATE_CURRENT,EReturn  ());
#line 6195 "C:/MyMod/Sources/EntitiesMP/Player.es"
return TRUE; ASSERT(FALSE); return TRUE;};BOOL CPlayer::
#line 6198 "C:/MyMod/Sources/EntitiesMP/Player.es"
LogoFireMinigun(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT STATE_CPlayer_LogoFireMinigun
  ASSERTMSG(__eeInput.ee_slEvent==EVENTCODE_EVoid, "CPlayer::LogoFireMinigun expects 'EVoid' as input!");  const EVoid &e = (const EVoid &)__eeInput;
#line 6201 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlacement3D pl  = GetActionMarker  () -> GetPlacement  ();
#line 6202 "C:/MyMod/Sources/EntitiesMP/Player.es"
pl  . pl_PositionVector  += FLOAT3D (0 , 0.01f , 0) * GetActionMarker  () -> en_mRotation ;
#line 6203 "C:/MyMod/Sources/EntitiesMP/Player.es"
Teleport  (pl );
#line 6204 "C:/MyMod/Sources/EntitiesMP/Player.es"
en_plViewpoint  . pl_OrientationAngle  (1) = 20.0f;
#line 6205 "C:/MyMod/Sources/EntitiesMP/Player.es"
en_plLastViewpoint  . pl_OrientationAngle  = en_plViewpoint  . pl_OrientationAngle ;
#line 6208 "C:/MyMod/Sources/EntitiesMP/Player.es"
StartModelAnim  (PLAYER_ANIM_INTRO  , AOF_LOOPING );
#line 6210 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_tmMinigunAutoFireStart  = _pTimer  -> CurrentTick  ();
#line 6213 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerWeapons  &) * m_penWeapons ) . SendEvent  (EFireWeapon  ());
#line 6214 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetTimerAfter(2.5f);
Jump(STATE_CURRENT, 0x01910041, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x01910041_LogoFireMinigun_01(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910041
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: return TRUE;case EVENTCODE_ETimer: Jump(STATE_CURRENT,0x01910042, FALSE, EInternal()); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x01910042_LogoFireMinigun_02(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910042
;
#line 6215 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerWeapons  &) * m_penWeapons ) . SendEvent  (EReleaseWeapon  ());
#line 6218 "C:/MyMod/Sources/EntitiesMP/Player.es"
CModelObject & moBody  = GetModelObject  () -> GetAttachmentModel  (PLAYER_ATTACHMENT_TORSO ) -> amo_moModelObject ;
#line 6219 "C:/MyMod/Sources/EntitiesMP/Player.es"
moBody  . PlayAnim  (BODY_ANIM_MINIGUN_STAND  , 0);
#line 6221 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetTimerAfter(0.5f);
Jump(STATE_CURRENT, 0x01910043, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x01910043_LogoFireMinigun_03(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910043
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: return TRUE;case EVENTCODE_ETimer: Jump(STATE_CURRENT,0x01910044, FALSE, EInternal()); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x01910044_LogoFireMinigun_04(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910044
;
#line 6224 "C:/MyMod/Sources/EntitiesMP/Player.es"
CWorldSettingsController  * pwsc  = NULL ;
#line 6226 "C:/MyMod/Sources/EntitiesMP/Player.es"
CBackgroundViewer  * penBcgViewer  = (CBackgroundViewer  *) GetWorld  () -> GetBackgroundViewer  ();
#line 6227 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(penBcgViewer  != NULL )
#line 6228 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 6229 "C:/MyMod/Sources/EntitiesMP/Player.es"
pwsc  = (CWorldSettingsController  *) & * penBcgViewer  -> m_penWorldSettingsController ;
#line 6230 "C:/MyMod/Sources/EntitiesMP/Player.es"
pwsc  -> m_tmShakeStarted  = _pTimer  -> CurrentTick  ();
#line 6231 "C:/MyMod/Sources/EntitiesMP/Player.es"
pwsc  -> m_vShakePos  = GetPlacement  () . pl_PositionVector ;
#line 6232 "C:/MyMod/Sources/EntitiesMP/Player.es"
pwsc  -> m_fShakeFalloff  = 250.0f;
#line 6233 "C:/MyMod/Sources/EntitiesMP/Player.es"
pwsc  -> m_fShakeFade  = 3.0f;
#line 6235 "C:/MyMod/Sources/EntitiesMP/Player.es"
pwsc  -> m_fShakeIntensityZ  = 0.1f * 2.0f;
#line 6236 "C:/MyMod/Sources/EntitiesMP/Player.es"
pwsc  -> m_tmShakeFrequencyZ  = 5.0f;
#line 6237 "C:/MyMod/Sources/EntitiesMP/Player.es"
pwsc  -> m_fShakeIntensityY  = 0.0f;
#line 6238 "C:/MyMod/Sources/EntitiesMP/Player.es"
pwsc  -> m_fShakeIntensityB  = 0.0f;
#line 6240 "C:/MyMod/Sources/EntitiesMP/Player.es"
pwsc  -> m_bShakeFadeIn  = FALSE ;
#line 6248 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 6251 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_tmMinigunAutoFireStart  = - 1;
#line 6252 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetTimerAfter(5.0f);
Jump(STATE_CURRENT, 0x01910045, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x01910045_LogoFireMinigun_05(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910045
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: return TRUE;case EVENTCODE_ETimer: Jump(STATE_CURRENT,0x01910046, FALSE, EInternal()); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x01910046_LogoFireMinigun_06(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910046
;
#line 6253 "C:/MyMod/Sources/EntitiesMP/Player.es"
IFeel_StopEffect  (NULL );
#line 6254 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetTimerAfter(5.0f);
Jump(STATE_CURRENT, 0x01910047, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x01910047_LogoFireMinigun_07(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910047
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: return TRUE;case EVENTCODE_ETimer: Jump(STATE_CURRENT,0x01910048, FALSE, EInternal()); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x01910048_LogoFireMinigun_08(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910048
;
#line 6256 "C:/MyMod/Sources/EntitiesMP/Player.es"
Return(STATE_CURRENT,EReturn  ());
#line 6256 "C:/MyMod/Sources/EntitiesMP/Player.es"
return TRUE; ASSERT(FALSE); return TRUE;};BOOL CPlayer::
#line 6259 "C:/MyMod/Sources/EntitiesMP/Player.es"
AutoStoreWeapon(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT STATE_CPlayer_AutoStoreWeapon
  ASSERTMSG(__eeInput.ee_slEvent==EVENTCODE_EVoid, "CPlayer::AutoStoreWeapon expects 'EVoid' as input!");  const EVoid &e = (const EVoid &)__eeInput;
#line 6262 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlayerAnimator  & plan  = (CPlayerAnimator  &) * m_penAnimator ;
#line 6263 "C:/MyMod/Sources/EntitiesMP/Player.es"
plan  . BodyAnimationTemplate  (BODY_ANIM_WAIT  , 
#line 6264 "C:/MyMod/Sources/EntitiesMP/Player.es"
BODY_ANIM_COLT_REDRAWSLOW  , BODY_ANIM_SHOTGUN_REDRAWSLOW  , BODY_ANIM_MINIGUN_REDRAWSLOW  , 
#line 6265 "C:/MyMod/Sources/EntitiesMP/Player.es"
0);
#line 6266 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetTimerAfter(plan  . m_fBodyAnimTime );
Jump(STATE_CURRENT, 0x0191004a, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x0191004a_AutoStoreWeapon_01(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191004a
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: return TRUE;case EVENTCODE_ETimer: Jump(STATE_CURRENT,0x0191004b, FALSE, EInternal()); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x0191004b_AutoStoreWeapon_02(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191004b
;
#line 6268 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_iAutoOrgWeapon  = ((CPlayerWeapons  &) * m_penWeapons ) . m_iCurrentWeapon ;
#line 6269 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerWeapons  &) * m_penWeapons ) . m_iCurrentWeapon  = WEAPON_NONE ;
#line 6270 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerWeapons  &) * m_penWeapons ) . m_iWantedWeapon  = WEAPON_NONE ;
#line 6271 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_soWeaponAmbient  . Stop  ();
#line 6274 "C:/MyMod/Sources/EntitiesMP/Player.es"
GetPlayerAnimator  () -> SyncWeapon  ();
#line 6276 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlayerAnimator  & plan  = (CPlayerAnimator  &) * m_penAnimator ;
#line 6277 "C:/MyMod/Sources/EntitiesMP/Player.es"
plan  . m_iWeaponLast  = m_iAutoOrgWeapon ;
#line 6278 "C:/MyMod/Sources/EntitiesMP/Player.es"
plan  . RemoveWeapon  ();
#line 6279 "C:/MyMod/Sources/EntitiesMP/Player.es"
GetPlayerAnimator  () -> SyncWeapon  ();
#line 6281 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerWeapons  &) * m_penWeapons ) . m_iCurrentWeapon  = (WeaponType ) m_iAutoOrgWeapon ;
#line 6282 "C:/MyMod/Sources/EntitiesMP/Player.es"
plan  . BodyAnimationTemplate  (BODY_ANIM_WAIT  , BODY_ANIM_COLT_DEACTIVATETOWALK  , 
#line 6283 "C:/MyMod/Sources/EntitiesMP/Player.es"
BODY_ANIM_SHOTGUN_DEACTIVATETOWALK  , BODY_ANIM_MINIGUN_DEACTIVATETOWALK  , AOF_SMOOTHCHANGE );
#line 6284 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerWeapons  &) * m_penWeapons ) . m_iCurrentWeapon  = WEAPON_NONE ;
#line 6286 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetTimerAfter(plan  . m_fBodyAnimTime );
Jump(STATE_CURRENT, 0x0191004c, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x0191004c_AutoStoreWeapon_03(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191004c
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: return TRUE;case EVENTCODE_ETimer: Jump(STATE_CURRENT,0x0191004d, FALSE, EInternal()); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x0191004d_AutoStoreWeapon_04(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191004d
;
#line 6289 "C:/MyMod/Sources/EntitiesMP/Player.es"
Return(STATE_CURRENT,EReturn  ());
#line 6289 "C:/MyMod/Sources/EntitiesMP/Player.es"
return TRUE; ASSERT(FALSE); return TRUE;};BOOL CPlayer::
#line 6293 "C:/MyMod/Sources/EntitiesMP/Player.es"
DoAutoActions(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT STATE_CPlayer_DoAutoActions
  ASSERTMSG(__eeInput.ee_slEvent==EVENTCODE_EVoid, "CPlayer::DoAutoActions expects 'EVoid' as input!");  const EVoid &e = (const EVoid &)__eeInput;
#line 6296 "C:/MyMod/Sources/EntitiesMP/Player.es"
en_plViewpoint  . pl_OrientationAngle  = ANGLE3D (0 , 0 , 0);
#line 6298 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlayerAnimator  & plan  = (CPlayerAnimator  &) * m_penAnimator ;
#line 6299 "C:/MyMod/Sources/EntitiesMP/Player.es"
plan  . m_bDisableAnimating  = TRUE ;
#line 6302 "C:/MyMod/Sources/EntitiesMP/Player.es"
Jump(STATE_CURRENT,0x019100a2, FALSE, EInternal());return TRUE;}BOOL CPlayer::H0x019100a2_DoAutoActions_84(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x019100a2
if(!(m_penActionMarker  != NULL  && IsOfClass  (m_penActionMarker  , "PlayerActionMarker"))){ Jump(STATE_CURRENT,0x019100a3, FALSE, EInternal());return TRUE;}
#line 6305 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(!(GetActionMarker  () -> m_paaAction  == PAA_WAIT )){ Jump(STATE_CURRENT,0x019100a1, FALSE, EInternal());return TRUE;}
#line 6307 "C:/MyMod/Sources/EntitiesMP/Player.es"
CModelObject & moBody  = GetModelObject  () -> GetAttachmentModel  (PLAYER_ATTACHMENT_TORSO ) -> amo_moModelObject ;
#line 6308 "C:/MyMod/Sources/EntitiesMP/Player.es"
moBody  . PlayAnim  (BODY_ANIM_WAIT  , AOF_NORESTART  | AOF_LOOPING );
#line 6310 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetTimerAfter(GetActionMarker  () -> m_tmWait );
Jump(STATE_CURRENT, 0x0191004f, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x0191004f_DoAutoActions_01(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191004f
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: return TRUE;case EVENTCODE_ETimer: Jump(STATE_CURRENT,0x01910050, FALSE, EInternal()); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x01910050_DoAutoActions_02(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910050
;Jump(STATE_CURRENT,0x019100a0, FALSE, EInternal());return TRUE;}BOOL CPlayer::H0x019100a1_DoAutoActions_83(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x019100a1
if(!(GetActionMarker  () -> m_paaAction  == PAA_STOPANDWAIT )){ Jump(STATE_CURRENT,0x0191009f, FALSE, EInternal());return TRUE;}
#line 6313 "C:/MyMod/Sources/EntitiesMP/Player.es"
StartModelAnim  (PLAYER_ANIM_STAND  , 0);
#line 6314 "C:/MyMod/Sources/EntitiesMP/Player.es"
CModelObject & moBody  = GetModelObject  () -> GetAttachmentModel  (PLAYER_ATTACHMENT_TORSO ) -> amo_moModelObject ;
#line 6315 "C:/MyMod/Sources/EntitiesMP/Player.es"
moBody  . PlayAnim  (BODY_ANIM_WAIT  , AOF_NORESTART  | AOF_LOOPING );
#line 6317 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetTimerAfter(GetActionMarker  () -> m_tmWait );
Jump(STATE_CURRENT, 0x01910051, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x01910051_DoAutoActions_03(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910051
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: return TRUE;case EVENTCODE_ETimer: Jump(STATE_CURRENT,0x01910052, FALSE, EInternal()); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x01910052_DoAutoActions_04(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910052
;Jump(STATE_CURRENT,0x0191009e, FALSE, EInternal());return TRUE;}BOOL CPlayer::H0x0191009f_DoAutoActions_81(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191009f
if(!(GetActionMarker  () -> m_paaAction  == PAA_APPEARING )){ Jump(STATE_CURRENT,0x0191009d, FALSE, EInternal());return TRUE;}
#line 6321 "C:/MyMod/Sources/EntitiesMP/Player.es"
STATE_CPlayer_AutoAppear, TRUE;
Jump(STATE_CURRENT, 0x01910053, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x01910053_DoAutoActions_05(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910053
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: Call(STATE_CURRENT, STATE_CPlayer_AutoAppear, TRUE, EVoid());return TRUE;case EVENTCODE_EReturn: Jump(STATE_CURRENT,0x01910054, FALSE, __eeInput); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x01910054_DoAutoActions_06(const CEntityEvent &__eeInput){
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910054
const EReturn&__e= (EReturn&)__eeInput;
;Jump(STATE_CURRENT,0x0191009c, FALSE, EInternal());return TRUE;}BOOL CPlayer::H0x0191009d_DoAutoActions_79(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191009d
if(!(GetActionMarker  () -> m_paaAction  == PAA_TRAVELING_IN_BEAM )){ Jump(STATE_CURRENT,0x0191009b, FALSE, EInternal());return TRUE;}
#line 6323 "C:/MyMod/Sources/EntitiesMP/Player.es"
STATE_CPlayer_TravellingInBeam, TRUE;
Jump(STATE_CURRENT, 0x01910055, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x01910055_DoAutoActions_07(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910055
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: Call(STATE_CURRENT, STATE_CPlayer_TravellingInBeam, TRUE, EVoid());return TRUE;case EVENTCODE_EReturn: Jump(STATE_CURRENT,0x01910056, FALSE, __eeInput); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x01910056_DoAutoActions_08(const CEntityEvent &__eeInput){
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910056
const EReturn&__e= (EReturn&)__eeInput;
;Jump(STATE_CURRENT,0x0191009a, FALSE, EInternal());return TRUE;}BOOL CPlayer::H0x0191009b_DoAutoActions_77(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191009b
if(!(GetActionMarker  () -> m_paaAction  == PAA_INTROSE_SELECT_WEAPON )){ Jump(STATE_CURRENT,0x01910099, FALSE, EInternal());return TRUE;}
#line 6326 "C:/MyMod/Sources/EntitiesMP/Player.es"
ESelectWeapon  eSelect ;
#line 6327 "C:/MyMod/Sources/EntitiesMP/Player.es"
eSelect  . iWeapon  = 1;
#line 6328 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerWeapons  &) * m_penWeapons ) . SendEvent  (eSelect );Jump(STATE_CURRENT,0x01910098, FALSE, EInternal());return TRUE;}BOOL CPlayer::H0x01910099_DoAutoActions_75(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910099
if(!(GetActionMarker  () -> m_paaAction  == PAA_LOGO_FIRE_INTROSE )){ Jump(STATE_CURRENT,0x01910097, FALSE, EInternal());return TRUE;}
#line 6330 "C:/MyMod/Sources/EntitiesMP/Player.es"
STATE_CPlayer_LogoFireMinigun, TRUE;
Jump(STATE_CURRENT, 0x01910057, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x01910057_DoAutoActions_09(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910057
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: Call(STATE_CURRENT, STATE_CPlayer_LogoFireMinigun, TRUE, EVoid());return TRUE;case EVENTCODE_EReturn: Jump(STATE_CURRENT,0x01910058, FALSE, __eeInput); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x01910058_DoAutoActions_10(const CEntityEvent &__eeInput){
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910058
const EReturn&__e= (EReturn&)__eeInput;
;Jump(STATE_CURRENT,0x01910096, FALSE, EInternal());return TRUE;}BOOL CPlayer::H0x01910097_DoAutoActions_73(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910097
if(!(GetActionMarker  () -> m_paaAction  == PAA_LOGO_FIRE_MINIGUN )){ Jump(STATE_CURRENT,0x01910095, FALSE, EInternal());return TRUE;}
#line 6332 "C:/MyMod/Sources/EntitiesMP/Player.es"
STATE_CPlayer_LogoFireMinigun, TRUE;
Jump(STATE_CURRENT, 0x01910059, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x01910059_DoAutoActions_11(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910059
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: Call(STATE_CURRENT, STATE_CPlayer_LogoFireMinigun, TRUE, EVoid());return TRUE;case EVENTCODE_EReturn: Jump(STATE_CURRENT,0x0191005a, FALSE, __eeInput); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x0191005a_DoAutoActions_12(const CEntityEvent &__eeInput){
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191005a
const EReturn&__e= (EReturn&)__eeInput;
;Jump(STATE_CURRENT,0x01910094, FALSE, EInternal());return TRUE;}BOOL CPlayer::H0x01910095_DoAutoActions_71(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910095
if(!(GetActionMarker  () -> m_paaAction  == PAA_TELEPORT )){ Jump(STATE_CURRENT,0x01910093, FALSE, EInternal());return TRUE;}
#line 6335 "C:/MyMod/Sources/EntitiesMP/Player.es"
STATE_CPlayer_AutoTeleport, TRUE;
Jump(STATE_CURRENT, 0x0191005b, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x0191005b_DoAutoActions_13(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191005b
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: Call(STATE_CURRENT, STATE_CPlayer_AutoTeleport, TRUE, EVoid());return TRUE;case EVENTCODE_EReturn: Jump(STATE_CURRENT,0x0191005c, FALSE, __eeInput); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x0191005c_DoAutoActions_14(const CEntityEvent &__eeInput){
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191005c
const EReturn&__e= (EReturn&)__eeInput;
;Jump(STATE_CURRENT,0x01910092, FALSE, EInternal());return TRUE;}BOOL CPlayer::H0x01910093_DoAutoActions_69(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910093
if(!(GetActionMarker  () -> m_paaAction  == PAA_WAITFOREVER )){ Jump(STATE_CURRENT,0x01910091, FALSE, EInternal());return TRUE;}
#line 6340 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetTimerAt(THINKTIME_NEVER);
Jump(STATE_CURRENT, 0x0191005d, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x0191005d_DoAutoActions_15(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191005d
switch(__eeInput.ee_slEvent){case(EVENTCODE_EBegin):{const EBegin&e= (EBegin&)__eeInput;
return TRUE;}ASSERT(FALSE);break;default:{return FALSE;}ASSERT(FALSE);break;
#line 6343 "C:/MyMod/Sources/EntitiesMP/Player.es"
}return TRUE;}BOOL CPlayer::H0x0191005e_DoAutoActions_16(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191005e
Jump(STATE_CURRENT,0x01910090, FALSE, EInternal());return TRUE;}BOOL CPlayer::H0x01910091_DoAutoActions_67(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910091
if(!(GetActionMarker  () -> m_paaAction  == PAA_STOREWEAPON )){ Jump(STATE_CURRENT,0x0191008f, FALSE, EInternal());return TRUE;}
#line 6346 "C:/MyMod/Sources/EntitiesMP/Player.es"
STATE_CPlayer_AutoStoreWeapon, TRUE;
Jump(STATE_CURRENT, 0x0191005f, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x0191005f_DoAutoActions_17(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191005f
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: Call(STATE_CURRENT, STATE_CPlayer_AutoStoreWeapon, TRUE, EVoid());return TRUE;case EVENTCODE_EReturn: Jump(STATE_CURRENT,0x01910060, FALSE, __eeInput); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x01910060_DoAutoActions_18(const CEntityEvent &__eeInput){
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910060
const EReturn&__e= (EReturn&)__eeInput;
;Jump(STATE_CURRENT,0x0191008e, FALSE, EInternal());return TRUE;}BOOL CPlayer::H0x0191008f_DoAutoActions_65(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191008f
if(!(GetActionMarker  () -> m_paaAction  == PAA_DRAWWEAPON )){ Jump(STATE_CURRENT,0x0191008d, FALSE, EInternal());return TRUE;}
#line 6351 "C:/MyMod/Sources/EntitiesMP/Player.es"
ESelectWeapon  eSelect ;
#line 6352 "C:/MyMod/Sources/EntitiesMP/Player.es"
eSelect  . iWeapon  = - 4;
#line 6353 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerWeapons  &) * m_penWeapons ) . SendEvent  (eSelect );Jump(STATE_CURRENT,0x0191008c, FALSE, EInternal());return TRUE;}BOOL CPlayer::H0x0191008d_DoAutoActions_63(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191008d
if(!(GetActionMarker  () -> m_paaAction  == PAA_LOOKAROUND )){ Jump(STATE_CURRENT,0x0191008b, FALSE, EInternal());return TRUE;}
#line 6357 "C:/MyMod/Sources/EntitiesMP/Player.es"
STATE_CPlayer_AutoLookAround, TRUE;
Jump(STATE_CURRENT, 0x01910061, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x01910061_DoAutoActions_19(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910061
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: Call(STATE_CURRENT, STATE_CPlayer_AutoLookAround, TRUE, EVoid());return TRUE;case EVENTCODE_EReturn: Jump(STATE_CURRENT,0x01910062, FALSE, __eeInput); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x01910062_DoAutoActions_20(const CEntityEvent &__eeInput){
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910062
const EReturn&__e= (EReturn&)__eeInput;
;Jump(STATE_CURRENT,0x0191008a, FALSE, EInternal());return TRUE;}BOOL CPlayer::H0x0191008b_DoAutoActions_61(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191008b
if(!(GetActionMarker  () -> m_paaAction  == PAA_USEITEM )){ Jump(STATE_CURRENT,0x01910089, FALSE, EInternal());return TRUE;}
#line 6362 "C:/MyMod/Sources/EntitiesMP/Player.es"
STATE_CPlayer_AutoUseItem, TRUE;
Jump(STATE_CURRENT, 0x01910063, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x01910063_DoAutoActions_21(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910063
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: Call(STATE_CURRENT, STATE_CPlayer_AutoUseItem, TRUE, EVoid());return TRUE;case EVENTCODE_EReturn: Jump(STATE_CURRENT,0x01910064, FALSE, __eeInput); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x01910064_DoAutoActions_22(const CEntityEvent &__eeInput){
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910064
const EReturn&__e= (EReturn&)__eeInput;
;Jump(STATE_CURRENT,0x01910088, FALSE, EInternal());return TRUE;}BOOL CPlayer::H0x01910089_DoAutoActions_59(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910089
if(!(GetActionMarker  () -> m_paaAction  == PAA_PICKITEM )){ Jump(STATE_CURRENT,0x01910087, FALSE, EInternal());return TRUE;}
#line 6367 "C:/MyMod/Sources/EntitiesMP/Player.es"
STATE_CPlayer_AutoPickItem, TRUE;
Jump(STATE_CURRENT, 0x01910065, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x01910065_DoAutoActions_23(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910065
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: Call(STATE_CURRENT, STATE_CPlayer_AutoPickItem, TRUE, EVoid());return TRUE;case EVENTCODE_EReturn: Jump(STATE_CURRENT,0x01910066, FALSE, __eeInput); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x01910066_DoAutoActions_24(const CEntityEvent &__eeInput){
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910066
const EReturn&__e= (EReturn&)__eeInput;
;Jump(STATE_CURRENT,0x01910086, FALSE, EInternal());return TRUE;}BOOL CPlayer::H0x01910087_DoAutoActions_57(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910087
if(!(GetActionMarker  () -> m_paaAction  == PAA_FALLDOWN )){ Jump(STATE_CURRENT,0x01910085, FALSE, EInternal());return TRUE;}
#line 6372 "C:/MyMod/Sources/EntitiesMP/Player.es"
STATE_CPlayer_AutoFallDown, TRUE;
Jump(STATE_CURRENT, 0x01910067, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x01910067_DoAutoActions_25(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910067
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: Call(STATE_CURRENT, STATE_CPlayer_AutoFallDown, TRUE, EVoid());return TRUE;case EVENTCODE_EReturn: Jump(STATE_CURRENT,0x01910068, FALSE, __eeInput); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x01910068_DoAutoActions_26(const CEntityEvent &__eeInput){
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910068
const EReturn&__e= (EReturn&)__eeInput;
;Jump(STATE_CURRENT,0x01910084, FALSE, EInternal());return TRUE;}BOOL CPlayer::H0x01910085_DoAutoActions_55(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910085
if(!(GetActionMarker  () -> m_paaAction  == PAA_RELEASEPLAYER )){ Jump(STATE_CURRENT,0x01910083, FALSE, EInternal());return TRUE;}
#line 6376 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_penCamera  != NULL ){
#line 6377 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CCamera  *) & * m_penCamera ) -> m_bStopMoving  = TRUE ;
#line 6378 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 6379 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_penCamera  = NULL ;
#line 6381 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(GetPlayerWeapons  () -> m_iCurrentWeapon  == WEAPON_NONE ){
#line 6383 "C:/MyMod/Sources/EntitiesMP/Player.es"
ESelectWeapon  eSelect ;
#line 6384 "C:/MyMod/Sources/EntitiesMP/Player.es"
eSelect  . iWeapon  = - 4;
#line 6385 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerWeapons  &) * m_penWeapons ) . SendEvent  (eSelect );
#line 6386 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 6388 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_ulFlags  |= PLF_SYNCWEAPON ;
#line 6389 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_tmSpiritStart  = 0;Jump(STATE_CURRENT,0x01910082, FALSE, EInternal());return TRUE;}BOOL CPlayer::H0x01910083_DoAutoActions_53(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910083
if(!(GetActionMarker  () -> m_paaAction  == PAA_STARTCOMPUTER )){ Jump(STATE_CURRENT,0x01910081, FALSE, EInternal());return TRUE;}
#line 6394 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(_pNetwork  -> IsPlayerLocal  (this ) && GetSP  () -> sp_bSinglePlayer ){
#line 6395 "C:/MyMod/Sources/EntitiesMP/Player.es"
cmp_ppenPlayer  = this ;
#line 6396 "C:/MyMod/Sources/EntitiesMP/Player.es"
cmp_bInitialStart  = TRUE ;
#line 6397 "C:/MyMod/Sources/EntitiesMP/Player.es"
}Jump(STATE_CURRENT,0x01910080, FALSE, EInternal());return TRUE;}BOOL CPlayer::H0x01910081_DoAutoActions_51(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910081
if(!(GetActionMarker  () -> m_paaAction  == PAA_STARTINTROSCROLL )){ Jump(STATE_CURRENT,0x0191007f, FALSE, EInternal());return TRUE;}
#line 6401 "C:/MyMod/Sources/EntitiesMP/Player.es"
_pShell  -> Execute  ("sam_iStartCredits=1;");Jump(STATE_CURRENT,0x0191007e, FALSE, EInternal());return TRUE;}BOOL CPlayer::H0x0191007f_DoAutoActions_49(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191007f
if(!(GetActionMarker  () -> m_paaAction  == PAA_STARTCREDITS )){ Jump(STATE_CURRENT,0x0191007d, FALSE, EInternal());return TRUE;}
#line 6405 "C:/MyMod/Sources/EntitiesMP/Player.es"
_pShell  -> Execute  ("sam_iStartCredits=2;");Jump(STATE_CURRENT,0x0191007c, FALSE, EInternal());return TRUE;}BOOL CPlayer::H0x0191007d_DoAutoActions_47(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191007d
if(!(GetActionMarker  () -> m_paaAction  == PAA_STOPSCROLLER )){ Jump(STATE_CURRENT,0x0191007b, FALSE, EInternal());return TRUE;}
#line 6409 "C:/MyMod/Sources/EntitiesMP/Player.es"
_pShell  -> Execute  ("sam_iStartCredits=-1;");Jump(STATE_CURRENT,0x0191007a, FALSE, EInternal());return TRUE;}BOOL CPlayer::H0x0191007b_DoAutoActions_45(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191007b
if(!(GetActionMarker  () -> m_paaAction  == PAA_RUN )){ Jump(STATE_CURRENT,0x01910079, FALSE, EInternal());return TRUE;}
#line 6414 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_fAutoSpeed  = plr_fSpeedForward  * GetActionMarker  () -> m_fSpeed ;
#line 6415 "C:/MyMod/Sources/EntitiesMP/Player.es"
STATE_CPlayer_AutoGoToMarker, TRUE;
Jump(STATE_CURRENT, 0x01910069, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x01910069_DoAutoActions_27(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910069
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: Call(STATE_CURRENT, STATE_CPlayer_AutoGoToMarker, TRUE, EVoid());return TRUE;case EVENTCODE_EReturn: Jump(STATE_CURRENT,0x0191006a, FALSE, __eeInput); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x0191006a_DoAutoActions_28(const CEntityEvent &__eeInput){
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191006a
const EReturn&__e= (EReturn&)__eeInput;
;Jump(STATE_CURRENT,0x01910078, FALSE, EInternal());return TRUE;}BOOL CPlayer::H0x01910079_DoAutoActions_43(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910079
if(!(GetActionMarker  () -> m_paaAction  == PAA_RUNANDSTOP )){ Jump(STATE_CURRENT,0x01910077, FALSE, EInternal());return TRUE;}
#line 6420 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_fAutoSpeed  = plr_fSpeedForward  * GetActionMarker  () -> m_fSpeed ;
#line 6421 "C:/MyMod/Sources/EntitiesMP/Player.es"
STATE_CPlayer_AutoGoToMarkerAndStop, TRUE;
Jump(STATE_CURRENT, 0x0191006b, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x0191006b_DoAutoActions_29(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191006b
switch(__eeInput.ee_slEvent) {case EVENTCODE_EBegin: Call(STATE_CURRENT, STATE_CPlayer_AutoGoToMarkerAndStop, TRUE, EVoid());return TRUE;case EVENTCODE_EReturn: Jump(STATE_CURRENT,0x0191006c, FALSE, __eeInput); return TRUE;default: return FALSE; }}BOOL CPlayer::H0x0191006c_DoAutoActions_30(const CEntityEvent &__eeInput){
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191006c
const EReturn&__e= (EReturn&)__eeInput;
;Jump(STATE_CURRENT,0x01910076, FALSE, EInternal());return TRUE;}BOOL CPlayer::H0x01910077_DoAutoActions_41(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910077
if(!(GetActionMarker  () -> m_paaAction  == PAA_RECORDSTATS )){ Jump(STATE_CURRENT,0x01910075, FALSE, EInternal());return TRUE;}
#line 6426 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(GetSP  () -> sp_bSinglePlayer  || GetSP  () -> sp_bPlayEntireGame ){
#line 6428 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_tmEstTime  = GetActionMarker  () -> m_tmWait ;
#line 6430 "C:/MyMod/Sources/EntitiesMP/Player.es"
RecordEndOfLevelData  ();
#line 6431 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 6432 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetGameEnd  ();
#line 6433 "C:/MyMod/Sources/EntitiesMP/Player.es"
}Jump(STATE_CURRENT,0x01910074, FALSE, EInternal());return TRUE;}BOOL CPlayer::H0x01910075_DoAutoActions_39(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910075
if(!(GetActionMarker  () -> m_paaAction  == PAA_SHOWSTATS )){ Jump(STATE_CURRENT,0x01910073, FALSE, EInternal());return TRUE;}
#line 6438 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(!(cmp_ppenPlayer  == NULL  && _pNetwork  -> IsPlayerLocal  (this ) && GetSP  () -> sp_bSinglePlayer )){ Jump(STATE_CURRENT,0x01910071, FALSE, EInternal());return TRUE;}
#line 6439 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_bEndOfLevel  = TRUE ;
#line 6440 "C:/MyMod/Sources/EntitiesMP/Player.es"
cmp_ppenPlayer  = this ;
#line 6441 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_ulFlags  |= PLF_DONTRENDER ;
#line 6442 "C:/MyMod/Sources/EntitiesMP/Player.es"
Jump(STATE_CURRENT,0x0191006f, FALSE, EInternal());return TRUE;}BOOL CPlayer::H0x0191006f_DoAutoActions_33(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191006f
if(!(m_bEndOfLevel )){ Jump(STATE_CURRENT,0x01910070, FALSE, EInternal());return TRUE;}
#line 6443 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetTimerAfter(_pTimer  -> TickQuantum );
Jump(STATE_CURRENT, 0x0191006d, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x0191006d_DoAutoActions_31(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191006d
switch(__eeInput.ee_slEvent){case(EVENTCODE_ETimer):{const ETimer&e= (ETimer&)__eeInput;
UnsetTimer();Jump(STATE_CURRENT,0x0191006e, FALSE, EInternal());return TRUE;}ASSERT(FALSE);break;case(EVENTCODE_EReceiveScore):{const EReceiveScore&e= (EReceiveScore&)__eeInput;
return FALSE;}ASSERT(FALSE);break;case(EVENTCODE_EKilledEnemy):{const EKilledEnemy&e= (EKilledEnemy&)__eeInput;
return FALSE;}ASSERT(FALSE);break;case(EVENTCODE_ECenterMessage):{const ECenterMessage&e= (ECenterMessage&)__eeInput;
return FALSE;}ASSERT(FALSE);break;case(EVENTCODE_EPostLevelChange):{const EPostLevelChange&e= (EPostLevelChange&)__eeInput;

#line 6449 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_ulFlags  &= ! PLF_DONTRENDER ;
#line 6450 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_bEndOfLevel  = FALSE ;
#line 6451 "C:/MyMod/Sources/EntitiesMP/Player.es"
return FALSE;
#line 6452 "C:/MyMod/Sources/EntitiesMP/Player.es"
}ASSERT(FALSE);break;default:{return TRUE;}ASSERT(FALSE);break;
#line 6454 "C:/MyMod/Sources/EntitiesMP/Player.es"
}return TRUE;}BOOL CPlayer::H0x0191006e_DoAutoActions_32(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191006e
Jump(STATE_CURRENT,0x0191006f, FALSE, EInternal());return TRUE;
#line 6455 "C:/MyMod/Sources/EntitiesMP/Player.es"
}BOOL CPlayer::H0x01910070_DoAutoActions_34(const CEntityEvent &__eeInput) {
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910070

#line 6456 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_ulFlags  &= ! PLF_DONTRENDER ;Jump(STATE_CURRENT,0x01910071, FALSE, EInternal());return TRUE;}BOOL CPlayer::H0x01910071_DoAutoActions_35(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910071
Jump(STATE_CURRENT,0x01910072, FALSE, EInternal());return TRUE;}BOOL CPlayer::H0x01910073_DoAutoActions_37(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910073
if(GetActionMarker  () -> m_paaAction  == PAA_ENDOFGAME ){
#line 6462 "C:/MyMod/Sources/EntitiesMP/Player.es"
Jump(STATE_CURRENT, STATE_CPlayer_TheEnd, TRUE, EVoid());return TRUE;
#line 6463 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else if(GetActionMarker  () -> m_paaAction  == PAA_NOGRAVITY ){
#line 6464 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetPhysicsFlags  (GetPhysicsFlags  () & ~ (EPF_TRANSLATEDBYGRAVITY  | EPF_ORIENTEDBYGRAVITY ));
#line 6465 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(GetActionMarker  () -> GetParent  () != NULL )
#line 6466 "C:/MyMod/Sources/EntitiesMP/Player.es"
{
#line 6467 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetParent  (GetActionMarker  () -> GetParent  ());
#line 6468 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 6469 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else if(GetActionMarker  () -> m_paaAction  == PAA_TURNONGRAVITY ){
#line 6470 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetPhysicsFlags  (GetPhysicsFlags  () | EPF_TRANSLATEDBYGRAVITY  | EPF_ORIENTEDBYGRAVITY );
#line 6471 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetParent  (NULL );
#line 6472 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 6473 "C:/MyMod/Sources/EntitiesMP/Player.es"
else if(TRUE ){
#line 6474 "C:/MyMod/Sources/EntitiesMP/Player.es"
ASSERT  (FALSE );
#line 6475 "C:/MyMod/Sources/EntitiesMP/Player.es"
}Jump(STATE_CURRENT,0x01910072, FALSE, EInternal());return TRUE;}
BOOL CPlayer::H0x01910072_DoAutoActions_36(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910072
Jump(STATE_CURRENT,0x01910074, FALSE, EInternal());return TRUE;}
BOOL CPlayer::H0x01910074_DoAutoActions_38(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910074
Jump(STATE_CURRENT,0x01910076, FALSE, EInternal());return TRUE;}
BOOL CPlayer::H0x01910076_DoAutoActions_40(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910076
Jump(STATE_CURRENT,0x01910078, FALSE, EInternal());return TRUE;}
BOOL CPlayer::H0x01910078_DoAutoActions_42(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910078
Jump(STATE_CURRENT,0x0191007a, FALSE, EInternal());return TRUE;}
BOOL CPlayer::H0x0191007a_DoAutoActions_44(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191007a
Jump(STATE_CURRENT,0x0191007c, FALSE, EInternal());return TRUE;}
BOOL CPlayer::H0x0191007c_DoAutoActions_46(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191007c
Jump(STATE_CURRENT,0x0191007e, FALSE, EInternal());return TRUE;}
BOOL CPlayer::H0x0191007e_DoAutoActions_48(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191007e
Jump(STATE_CURRENT,0x01910080, FALSE, EInternal());return TRUE;}
BOOL CPlayer::H0x01910080_DoAutoActions_50(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910080
Jump(STATE_CURRENT,0x01910082, FALSE, EInternal());return TRUE;}
BOOL CPlayer::H0x01910082_DoAutoActions_52(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910082
Jump(STATE_CURRENT,0x01910084, FALSE, EInternal());return TRUE;}
BOOL CPlayer::H0x01910084_DoAutoActions_54(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910084
Jump(STATE_CURRENT,0x01910086, FALSE, EInternal());return TRUE;}
BOOL CPlayer::H0x01910086_DoAutoActions_56(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910086
Jump(STATE_CURRENT,0x01910088, FALSE, EInternal());return TRUE;}
BOOL CPlayer::H0x01910088_DoAutoActions_58(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910088
Jump(STATE_CURRENT,0x0191008a, FALSE, EInternal());return TRUE;}
BOOL CPlayer::H0x0191008a_DoAutoActions_60(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191008a
Jump(STATE_CURRENT,0x0191008c, FALSE, EInternal());return TRUE;}
BOOL CPlayer::H0x0191008c_DoAutoActions_62(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191008c
Jump(STATE_CURRENT,0x0191008e, FALSE, EInternal());return TRUE;}
BOOL CPlayer::H0x0191008e_DoAutoActions_64(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191008e
Jump(STATE_CURRENT,0x01910090, FALSE, EInternal());return TRUE;}
BOOL CPlayer::H0x01910090_DoAutoActions_66(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910090
Jump(STATE_CURRENT,0x01910092, FALSE, EInternal());return TRUE;}
BOOL CPlayer::H0x01910092_DoAutoActions_68(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910092
Jump(STATE_CURRENT,0x01910094, FALSE, EInternal());return TRUE;}
BOOL CPlayer::H0x01910094_DoAutoActions_70(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910094
Jump(STATE_CURRENT,0x01910096, FALSE, EInternal());return TRUE;}
BOOL CPlayer::H0x01910096_DoAutoActions_72(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910096
Jump(STATE_CURRENT,0x01910098, FALSE, EInternal());return TRUE;}
BOOL CPlayer::H0x01910098_DoAutoActions_74(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x01910098
Jump(STATE_CURRENT,0x0191009a, FALSE, EInternal());return TRUE;}
BOOL CPlayer::H0x0191009a_DoAutoActions_76(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191009a
Jump(STATE_CURRENT,0x0191009c, FALSE, EInternal());return TRUE;}
BOOL CPlayer::H0x0191009c_DoAutoActions_78(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191009c
Jump(STATE_CURRENT,0x0191009e, FALSE, EInternal());return TRUE;}
BOOL CPlayer::H0x0191009e_DoAutoActions_80(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x0191009e
Jump(STATE_CURRENT,0x019100a0, FALSE, EInternal());return TRUE;}
BOOL CPlayer::H0x019100a0_DoAutoActions_82(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x019100a0

#line 6478 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(GetActionMarker  () -> m_penTrigger  != NULL  && 
#line 6479 "C:/MyMod/Sources/EntitiesMP/Player.es"
GetActionMarker  () -> m_paaAction  != PAA_PICKITEM ){
#line 6481 "C:/MyMod/Sources/EntitiesMP/Player.es"
SendToTarget  (GetActionMarker  () -> m_penTrigger  , EET_TRIGGER  , this );
#line 6482 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 6485 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_penActionMarker  = GetActionMarker  () -> m_penTarget ;Jump(STATE_CURRENT,0x019100a2, FALSE, EInternal());return TRUE;
#line 6486 "C:/MyMod/Sources/EntitiesMP/Player.es"
}BOOL CPlayer::H0x019100a3_DoAutoActions_85(const CEntityEvent &__eeInput) {
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x019100a3

#line 6489 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_fAutoSpeed  = 0.0f;
#line 6492 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_penActionMarker  = NULL ;
#line 6495 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlayerAnimator  & plan  = (CPlayerAnimator  &) * m_penAnimator ;
#line 6496 "C:/MyMod/Sources/EntitiesMP/Player.es"
plan  . m_bDisableAnimating  = FALSE ;
#line 6499 "C:/MyMod/Sources/EntitiesMP/Player.es"
Return(STATE_CURRENT,EVoid  ());
#line 6499 "C:/MyMod/Sources/EntitiesMP/Player.es"
return TRUE; ASSERT(FALSE); return TRUE;};BOOL CPlayer::
#line 6504 "C:/MyMod/Sources/EntitiesMP/Player.es"
Main(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT STATE_CPlayer_Main
  ASSERTMSG(__eeInput.ee_slEvent==EVENTCODE_EVoid, "CPlayer::Main expects 'EVoid' as input!");  const EVoid &evoid = (const EVoid &)__eeInput;
#line 6507 "C:/MyMod/Sources/EntitiesMP/Player.es"
time  (& m_iStartTime );
#line 6509 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_ctUnreadMessages  = 0;
#line 6510 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetFlags  (GetFlags  () | ENF_CROSSESLEVELS  | ENF_NOTIFYLEVELCHANGE );
#line 6511 "C:/MyMod/Sources/EntitiesMP/Player.es"
InitAsEditorModel  ();
#line 6514 "C:/MyMod/Sources/EntitiesMP/Player.es"
CTString strDummy ;
#line 6515 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetPlayerAppearance  (GetModelObject  () , NULL  , strDummy  , FALSE );
#line 6517 "C:/MyMod/Sources/EntitiesMP/Player.es"
ValidateCharacter  ();
#line 6518 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetPlayerAppearance  (& m_moRender  , & en_pcCharacter  , strDummy  , FALSE );
#line 6519 "C:/MyMod/Sources/EntitiesMP/Player.es"
ParseGender  (strDummy );
#line 6522 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(GetModelObject  () -> GetData  () == NULL ){
#line 6524 "C:/MyMod/Sources/EntitiesMP/Player.es"
Return(STATE_CURRENT,EVoid());
#line 6524 "C:/MyMod/Sources/EntitiesMP/Player.es"
return TRUE;
#line 6525 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 6529 "C:/MyMod/Sources/EntitiesMP/Player.es"
ModelChangeNotify  ();
#line 6532 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetTimerAfter(0.2f);
Jump(STATE_CURRENT, 0x019100a4, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x019100a4_Main_01(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x019100a4
switch(__eeInput.ee_slEvent){case(EVENTCODE_EBegin):{const EBegin&e= (EBegin&)__eeInput;
return TRUE;}ASSERT(FALSE);break;case(EVENTCODE_ETimer):{const ETimer&e= (ETimer&)__eeInput;
UnsetTimer();Jump(STATE_CURRENT,0x019100a5, FALSE, EInternal());return TRUE;}ASSERT(FALSE);break;case(EVENTCODE_EDisconnected):{const EDisconnected&e= (EDisconnected&)__eeInput;

#line 6536 "C:/MyMod/Sources/EntitiesMP/Player.es"
Destroy  ();
#line 6537 "C:/MyMod/Sources/EntitiesMP/Player.es"
Return(STATE_CURRENT,EVoid());
#line 6537 "C:/MyMod/Sources/EntitiesMP/Player.es"
return TRUE;
#line 6538 "C:/MyMod/Sources/EntitiesMP/Player.es"
}ASSERT(FALSE);break;default: return FALSE; break;
#line 6539 "C:/MyMod/Sources/EntitiesMP/Player.es"
}return TRUE;}BOOL CPlayer::H0x019100a5_Main_02(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x019100a5

#line 6542 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(IsPredictor  ()){
#line 6543 "C:/MyMod/Sources/EntitiesMP/Player.es"
Destroy  ();
#line 6544 "C:/MyMod/Sources/EntitiesMP/Player.es"
Return(STATE_CURRENT,EVoid());
#line 6544 "C:/MyMod/Sources/EntitiesMP/Player.es"
return TRUE;
#line 6545 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 6548 "C:/MyMod/Sources/EntitiesMP/Player.es"
SwitchToModel  ();
#line 6549 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_ulFlags  |= PLF_INITIALIZED ;
#line 6552 "C:/MyMod/Sources/EntitiesMP/Player.es"
en_tmMaxHoldBreath  = 60.0f;
#line 6553 "C:/MyMod/Sources/EntitiesMP/Player.es"
en_fDensity  = 1000.0f;
#line 6555 "C:/MyMod/Sources/EntitiesMP/Player.es"
ModelChangeNotify  ();
#line 6558 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_penWeapons  = CreateEntity  (GetPlacement  () , CLASS_PLAYER_WEAPONS );
#line 6559 "C:/MyMod/Sources/EntitiesMP/Player.es"
EWeaponsInit  eInitWeapons ;
#line 6560 "C:/MyMod/Sources/EntitiesMP/Player.es"
eInitWeapons  . penOwner  = this ;
#line 6561 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_penWeapons  -> Initialize  (eInitWeapons );
#line 6564 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_penAnimator  = CreateEntity  (GetPlacement  () , CLASS_PLAYER_ANIMATOR );
#line 6565 "C:/MyMod/Sources/EntitiesMP/Player.es"
EAnimatorInit  eInitAnimator ;
#line 6566 "C:/MyMod/Sources/EntitiesMP/Player.es"
eInitAnimator  . penPlayer  = this ;
#line 6567 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_penAnimator  -> Initialize  (eInitAnimator );
#line 6570 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_soMouth  . Set3DParameters  (50.0f , 10.0f , 1.0f , 1.0f);
#line 6571 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_soFootL  . Set3DParameters  (20.0f , 2.0f , 1.0f , 1.0f);
#line 6572 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_soFootR  . Set3DParameters  (20.0f , 2.0f , 1.0f , 1.0f);
#line 6573 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_soBody  . Set3DParameters  (25.0f , 5.0f , 1.0f , 1.0f);
#line 6574 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_soMessage  . Set3DParameters  (25.0f , 5.0f , 1.0f , 1.0f);
#line 6575 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_soSniperZoom  . Set3DParameters  (25.0f , 5.0f , 1.0f , 1.0f);
#line 6578 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetupLightSource  ();
#line 6581 "C:/MyMod/Sources/EntitiesMP/Player.es"
try {
#line 6582 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_aoLightAnimation  . SetData_t  (CTFILENAME  ("Animations\\BasicEffects.ani"));
#line 6583 "C:/MyMod/Sources/EntitiesMP/Player.es"
}catch  (char  * strError ){
#line 6584 "C:/MyMod/Sources/EntitiesMP/Player.es"
WarningMessage  (TRANS  ("Cannot load Animations\\BasicEffects.ani: %s") , strError );
#line 6585 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 6586 "C:/MyMod/Sources/EntitiesMP/Player.es"
PlayLightAnim  (LIGHT_ANIM_NONE  , 0);
#line 6588 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetTimerAt(THINKTIME_NEVER);
Jump(STATE_CURRENT, 0x019100a6, FALSE, EBegin());return TRUE;}BOOL CPlayer::H0x019100a6_Main_03(const CEntityEvent &__eeInput) {
#undef STATE_CURRENT
#define STATE_CURRENT 0x019100a6
switch(__eeInput.ee_slEvent){case(EVENTCODE_EBegin):{const EBegin&e= (EBegin&)__eeInput;
Call(STATE_CURRENT, STATE_CPlayer_FirstInit, TRUE, EVoid());return TRUE;}ASSERT(FALSE);break;case(EVENTCODE_ERebirth):{const ERebirth&e= (ERebirth&)__eeInput;
Call(STATE_CURRENT, STATE_CPlayer_Rebirth, TRUE, EVoid());return TRUE;}ASSERT(FALSE);break;case(EVENTCODE_EDeath):{const EDeath&eDeath= (EDeath&)__eeInput;
Call(STATE_CURRENT, STATE_CPlayer_Death, TRUE, eDeath );return TRUE;}ASSERT(FALSE);break;case(EVENTCODE_EDamage):{const EDamage&eDamage= (EDamage&)__eeInput;
Call(STATE_CURRENT, STATE_CPlayer_Wounded, TRUE, eDamage );return TRUE;}ASSERT(FALSE);break;case(EVENTCODE_EPreLevelChange):{const EPreLevelChange&e= (EPreLevelChange&)__eeInput;

#line 6594 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_ulFlags  &= ~ PLF_INITIALIZED ;
#line 6595 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_ulFlags  |= PLF_CHANGINGLEVEL ;
#line 6596 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_ulFlags  &= ~ PLF_LEVELSTARTED ;
#line 6597 "C:/MyMod/Sources/EntitiesMP/Player.es"
return TRUE;
#line 6598 "C:/MyMod/Sources/EntitiesMP/Player.es"
}ASSERT(FALSE);break;case(EVENTCODE_EPostLevelChange):{const EPostLevelChange&e= (EPostLevelChange&)__eeInput;

#line 6600 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(GetSP  () -> sp_bSinglePlayer  || (GetFlags  () & ENF_ALIVE )){
#line 6601 "C:/MyMod/Sources/EntitiesMP/Player.es"
Call(STATE_CURRENT, STATE_CPlayer_WorldChange, TRUE, EVoid());return TRUE;
#line 6602 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 6603 "C:/MyMod/Sources/EntitiesMP/Player.es"
Call(STATE_CURRENT, STATE_CPlayer_WorldChangeDead, TRUE, EVoid());return TRUE;
#line 6604 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 6605 "C:/MyMod/Sources/EntitiesMP/Player.es"
}ASSERT(FALSE);break;case(EVENTCODE_ETakingBreath):{const ETakingBreath&eTakingBreath= (ETakingBreath&)__eeInput;

#line 6607 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetDefaultMouthPitch  ();
#line 6608 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(eTakingBreath  . fBreathDelay  < 0.2f){
#line 6609 "C:/MyMod/Sources/EntitiesMP/Player.es"
PlaySound  (m_soMouth  , GenderSound  (SOUND_INHALE0 ) , SOF_3D );
#line 6610 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else if(eTakingBreath  . fBreathDelay  < 0.8f){
#line 6611 "C:/MyMod/Sources/EntitiesMP/Player.es"
PlaySound  (m_soMouth  , GenderSound  (SOUND_INHALE1 ) , SOF_3D );
#line 6612 "C:/MyMod/Sources/EntitiesMP/Player.es"
}else {
#line 6613 "C:/MyMod/Sources/EntitiesMP/Player.es"
PlaySound  (m_soMouth  , GenderSound  (SOUND_INHALE2 ) , SOF_3D );
#line 6614 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 6615 "C:/MyMod/Sources/EntitiesMP/Player.es"
return TRUE;
#line 6616 "C:/MyMod/Sources/EntitiesMP/Player.es"
}ASSERT(FALSE);break;case(EVENTCODE_ECameraStart):{const ECameraStart&eStart= (ECameraStart&)__eeInput;

#line 6618 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_penCamera  = eStart  . penCamera ;
#line 6620 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_penActionMarker  == NULL ){
#line 6621 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetDesiredTranslation  (FLOAT3D (0.0f , 0.0f , 0.0f));
#line 6622 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetDesiredRotation  (ANGLE3D (0.0f , 0.0f , 0.0f));
#line 6623 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 6625 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerWeapons  &) * m_penWeapons ) . SendEvent  (EReleaseWeapon  ());
#line 6626 "C:/MyMod/Sources/EntitiesMP/Player.es"
return TRUE;
#line 6627 "C:/MyMod/Sources/EntitiesMP/Player.es"
}ASSERT(FALSE);break;case(EVENTCODE_ECameraStop):{const ECameraStop&eCameraStop= (ECameraStop&)__eeInput;

#line 6629 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_penCamera  == eCameraStop  . penCamera ){
#line 6630 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_penCamera  = NULL ;
#line 6631 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 6632 "C:/MyMod/Sources/EntitiesMP/Player.es"
return TRUE;
#line 6633 "C:/MyMod/Sources/EntitiesMP/Player.es"
}ASSERT(FALSE);break;case(EVENTCODE_ECenterMessage):{const ECenterMessage&eMsg= (ECenterMessage&)__eeInput;

#line 6635 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_strCenterMessage  = eMsg  . strMessage ;
#line 6636 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_tmCenterMessageEnd  = _pTimer  -> CurrentTick  () + eMsg  . tmLength ;
#line 6637 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(eMsg  . mssSound  == MSS_INFO ){
#line 6638 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_soMessage  . Set3DParameters  (25.0f , 5.0f , 1.0f , 1.0f);
#line 6639 "C:/MyMod/Sources/EntitiesMP/Player.es"
PlaySound  (m_soMessage  , SOUND_INFO  , SOF_3D  | SOF_VOLUMETRIC  | SOF_LOCAL );
#line 6640 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 6641 "C:/MyMod/Sources/EntitiesMP/Player.es"
return TRUE;
#line 6642 "C:/MyMod/Sources/EntitiesMP/Player.es"
}ASSERT(FALSE);break;case(EVENTCODE_EComputerMessage):{const EComputerMessage&eMsg= (EComputerMessage&)__eeInput;

#line 6644 "C:/MyMod/Sources/EntitiesMP/Player.es"
ReceiveComputerMessage  (eMsg  . fnmMessage  , CMF_ANALYZE );
#line 6645 "C:/MyMod/Sources/EntitiesMP/Player.es"
return TRUE;
#line 6646 "C:/MyMod/Sources/EntitiesMP/Player.es"
}ASSERT(FALSE);break;case(EVENTCODE_EVoiceMessage):{const EVoiceMessage&eMsg= (EVoiceMessage&)__eeInput;

#line 6648 "C:/MyMod/Sources/EntitiesMP/Player.es"
SayVoiceMessage  (eMsg  . fnmMessage );
#line 6649 "C:/MyMod/Sources/EntitiesMP/Player.es"
return TRUE;
#line 6650 "C:/MyMod/Sources/EntitiesMP/Player.es"
}ASSERT(FALSE);break;case(EVENTCODE_EAutoAction):{const EAutoAction&eAutoAction= (EAutoAction&)__eeInput;

#line 6653 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_penActionMarker  = eAutoAction  . penFirstMarker ;
#line 6655 "C:/MyMod/Sources/EntitiesMP/Player.es"
Call(STATE_CURRENT, STATE_CPlayer_DoAutoActions, TRUE, EVoid());return TRUE;
#line 6656 "C:/MyMod/Sources/EntitiesMP/Player.es"
}ASSERT(FALSE);break;case(EVENTCODE_EReceiveScore):{const EReceiveScore&eScore= (EReceiveScore&)__eeInput;

#line 6658 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_psLevelStats  . ps_iScore  += eScore  . iPoints ;
#line 6659 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_psGameStats  . ps_iScore  += eScore  . iPoints ;
#line 6660 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_iMana  += eScore  . iPoints  * GetSP  () -> sp_fManaTransferFactor ;
#line 6661 "C:/MyMod/Sources/EntitiesMP/Player.es"
CheckHighScore  ();
#line 6662 "C:/MyMod/Sources/EntitiesMP/Player.es"
return TRUE;
#line 6663 "C:/MyMod/Sources/EntitiesMP/Player.es"
}ASSERT(FALSE);break;case(EVENTCODE_EKilledEnemy):{const EKilledEnemy&e= (EKilledEnemy&)__eeInput;

#line 6665 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_psLevelStats  . ps_iKills  += 1;
#line 6666 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_psGameStats  . ps_iKills  += 1;
#line 6667 "C:/MyMod/Sources/EntitiesMP/Player.es"
return TRUE;
#line 6668 "C:/MyMod/Sources/EntitiesMP/Player.es"
}ASSERT(FALSE);break;case(EVENTCODE_ESecretFound):{const ESecretFound&e= (ESecretFound&)__eeInput;

#line 6670 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_psLevelStats  . ps_iSecrets  += 1;
#line 6671 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_psGameStats  . ps_iSecrets  += 1;
#line 6672 "C:/MyMod/Sources/EntitiesMP/Player.es"
return TRUE;
#line 6673 "C:/MyMod/Sources/EntitiesMP/Player.es"
}ASSERT(FALSE);break;case(EVENTCODE_EWeaponChanged):{const EWeaponChanged&e= (EWeaponChanged&)__eeInput;

#line 6676 "C:/MyMod/Sources/EntitiesMP/Player.es"
((CPlayerWeapons  &) * m_penWeapons ) . m_bSniping  = FALSE ;
#line 6677 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_ulFlags  &= ~ PLF_ISZOOMING ;
#line 6678 "C:/MyMod/Sources/EntitiesMP/Player.es"
PlaySound  (m_soSniperZoom  , SOUND_SILENCE  , SOF_3D );
#line 6679 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(_pNetwork  -> IsPlayerLocal  (this )){IFeel_StopEffect  ("SniperZoom");}
#line 6680 "C:/MyMod/Sources/EntitiesMP/Player.es"
return TRUE;
#line 6681 "C:/MyMod/Sources/EntitiesMP/Player.es"
}ASSERT(FALSE);break;case(EVENTCODE_EEnd):{const EEnd&e= (EEnd&)__eeInput;

#line 6684 "C:/MyMod/Sources/EntitiesMP/Player.es"
ASSERT  (FALSE );
#line 6685 "C:/MyMod/Sources/EntitiesMP/Player.es"
return TRUE;
#line 6686 "C:/MyMod/Sources/EntitiesMP/Player.es"
}ASSERT(FALSE);break;case(EVENTCODE_EDisconnected):{const EDisconnected&e= (EDisconnected&)__eeInput;

#line 6690 "C:/MyMod/Sources/EntitiesMP/Player.es"
UnsetTimer();Jump(STATE_CURRENT,0x019100a7, FALSE, EInternal());return TRUE;
#line 6691 "C:/MyMod/Sources/EntitiesMP/Player.es"
}ASSERT(FALSE);break;case(EVENTCODE_ETouch):{const ETouch&eTouch= (ETouch&)__eeInput;

#line 6694 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(IsOfClass  (eTouch  . penOther  , "Bouncer")){
#line 6695 "C:/MyMod/Sources/EntitiesMP/Player.es"
JumpFromBouncer  (this  , eTouch  . penOther );
#line 6697 "C:/MyMod/Sources/EntitiesMP/Player.es"
SetDefaultMouthPitch  ();
#line 6698 "C:/MyMod/Sources/EntitiesMP/Player.es"
PlaySound  (m_soMouth  , GenderSound  (SOUND_JUMP ) , SOF_3D );
#line 6699 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(_pNetwork  -> IsPlayerLocal  (this )){IFeel_PlayEffect  ("Jump");}
#line 6700 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 6701 "C:/MyMod/Sources/EntitiesMP/Player.es"
return TRUE;
#line 6702 "C:/MyMod/Sources/EntitiesMP/Player.es"
}ASSERT(FALSE);break;default: return FALSE; break;
#line 6703 "C:/MyMod/Sources/EntitiesMP/Player.es"
}return TRUE;}BOOL CPlayer::H0x019100a7_Main_04(const CEntityEvent &__eeInput){
ASSERT(__eeInput.ee_slEvent==EVENTCODE_EInternal);
#undef STATE_CURRENT
#define STATE_CURRENT 0x019100a7

#line 6708 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(! IsPredictor  () && m_ulKeys  != 0){
#line 6710 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlayer  * penNextPlayer  = NULL ;
#line 6711 "C:/MyMod/Sources/EntitiesMP/Player.es"
for(INDEX iPlayer  = 0;iPlayer  < GetMaxPlayers  ();iPlayer  ++){
#line 6712 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPlayer  * pen  = (CPlayer  *) & * GetPlayerEntity  (iPlayer );
#line 6713 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(pen  != NULL  && pen  != this  && (pen  -> GetFlags  () & ENF_ALIVE ) && ! (pen  -> GetFlags  () & ENF_DELETED )){
#line 6714 "C:/MyMod/Sources/EntitiesMP/Player.es"
penNextPlayer  = pen ;
#line 6715 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 6716 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 6719 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(penNextPlayer  != NULL ){
#line 6721 "C:/MyMod/Sources/EntitiesMP/Player.es"
CPrintF  (TRANS  ("%s leaving, all keys transfered to %s\n") , 
#line 6722 "C:/MyMod/Sources/EntitiesMP/Player.es"
(const char  *) m_strName  , (const char  *) penNextPlayer  -> GetPlayerName  ());
#line 6723 "C:/MyMod/Sources/EntitiesMP/Player.es"
penNextPlayer  -> m_ulKeys  |= m_ulKeys ;
#line 6724 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 6725 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 6728 "C:/MyMod/Sources/EntitiesMP/Player.es"
SpawnTeleport  ();
#line 6731 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_penWeapons  -> Destroy  ();
#line 6732 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_penAnimator  -> Destroy  ();
#line 6733 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_penView  != NULL ){
#line 6734 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_penView  -> Destroy  ();
#line 6735 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 6736 "C:/MyMod/Sources/EntitiesMP/Player.es"
if(m_pen3rdPersonView  != NULL ){
#line 6737 "C:/MyMod/Sources/EntitiesMP/Player.es"
m_pen3rdPersonView  -> Destroy  ();
#line 6738 "C:/MyMod/Sources/EntitiesMP/Player.es"
}
#line 6739 "C:/MyMod/Sources/EntitiesMP/Player.es"
Destroy  ();
#line 6740 "C:/MyMod/Sources/EntitiesMP/Player.es"
Return(STATE_CURRENT,EVoid());
#line 6740 "C:/MyMod/Sources/EntitiesMP/Player.es"
return TRUE; ASSERT(FALSE); return TRUE;};